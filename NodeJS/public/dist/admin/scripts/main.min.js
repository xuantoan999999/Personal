"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},languageJs=function(){return{vi:{MESSAGE:"Thông báo!",MESSAGE_REQUIRE_LOGIN:"Bạn chưa đăng nhập.",MESSAGE_LOGIN_FACEBOOK:"Bạn chưa đăng nhập facebook.",MESSAGE_REQUIRE_ROLE:"Bạn không có quyền đề truy cập trang này.",EVENT_STOP:"Thời gian tham gia chương trình đã hết, cảm ơn bạn đã quan tâm.",MENU_HOME:"Trang chủ",MENU_ABOUT:"Giới thiệu",MENU_CONTACT:"Liên hệ",MENU_LANGUAGE:"Ngôn ngữ",DT_SUNDAY:"Cn",DT_MONDAY:"Hai",DT_TUESDAY:"Ba",DT_WEDNESDAY:"Tư",DT_THURSDAY:"Năm",DT_FRIDAY:"Sáu",DT_SATURDAY:"Bảy",DT_JANUARY:"Tháng 1",DT_FEBRUARY:"Tháng 2",DT_MARCH:"Tháng 3",DT_APRIL:"Tháng 4",DT_MAY:"Tháng 5",DT_JUNE:"Tháng 6",DT_JULY:"Tháng 7",DT_AUGUST:"Tháng 8",DT_SEPTEMBER:"Tháng 9",DT_OCTOBER:"Tháng 10",DT_NOVEMBER:"Tháng 11",DT_DECEMBER:"Tháng 12"},en:{MESSAGE:"Infomation!",MESSAGE_REQUIRE_LOGIN:"Bạn chưa đăng nhập.",MESSAGE_LOGIN_FACEBOOK:"Bạn chưa đăng nhập facebook.",MESSAGE_REQUIRE_ROLE:"Bạn không có quyền đề truy cập trang này.",EVENT_STOP:"Thời gian tham gia chương trình đã hết, cảm ơn bạn đã quan tâm EN.",MENU_HOME:"Home",MENU_ABOUT:"About",MENU_CONTACT:"Contact",MENU_LANGUAGE:"Languages",DT_SUNDAY:"Sun",DT_MONDAY:"Mon",DT_TUESDAY:"Tue",DT_WEDNESDAY:"Wed",DT_THURSDAY:"Thu",DT_FRIDAY:"Fri",DT_SATURDAY:"Sat",DT_JANUARY:"Jan",DT_FEBRUARY:"Feb",DT_MARCH:"Mar",DT_APRIL:"Apr",DT_MAY:"May",DT_JUNE:"Jun",DT_JULY:"Jul",DT_AUGUST:"Aug",DT_SEPTEMBER:"Sep",DT_OCTOBER:"Otc",DT_NOVEMBER:"Nov",DT_DECEMBER:"Dec"}}}(),settingJs=function(){var e=(new Date,window.location.host,{facebookAppId:settings.facebookId,appPrefix:"Muahangviet",webUrl:settings.services.webUrl,apiUrl:settings.services.apiUrl,socketUrl:settings.services.socketApi,adminUrl:settings.services.admin,userApiUrl:settings.services.apiUrl,logApiUrl:settings.services.logApi,uploadApiUrl:settings.services.uploadApi,uploadDirectory:{general:"/files/",category:"/files/category_image/",product:"/files/product_image/",certificate:"/files/certificate_image/",blog:"/files/blog_image/",banner:"/files/banner_image/",thumb:"/files/thumb_image/",thumb_product:"/files/thumb_image/product_image/",tmp:"/files/tmp/",media_old:"/files/media_old/",media_old_product:"/files/media_old/product/"}});return{configs:e,appPrefix:e.appPrefix,storageExpireTime:void 0}}(),DateTime=function(){function e(e,t){var n=864e5;return Math.round((t.getTime()-e.getTime())/n)}function t(e,t){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())+1}function n(e,t,n){return e>=t&&e<=n}function r(e,t){var n=t.filter(function(t){return new Date(t).toDateString()===e.toDateString()});return 0!==n.length}function o(e){return e.getTime()/1e3}function a(e){var t=e;t=t.replace(/\D/g," ");var n=t.split(" ");n[1]--;var r=new Date(Date.UTC(n[0],n[1],n[2],n[3],n[4],n[5]));return r}function i(e){var t=new Date;return new Date(t.getFullYear(),e,0).getDate()}function s(e){var t=new Date,n=0;t.getMonth()<e.getMonth()?n=1:t.getMonth()==e.getMonth()&&t.getDate()<e.getDate()&&(n=1);var r=t.getFullYear()-e.getFullYear()-n;return r}return{dayCount:e,monthCount:t,dateBetween:n,dateContain:r,dateToTimestamp:o,isoDateToDate:a,daysInMonth:i,getAge:s}}(),ExcelJs=function(){function e(){var e=[[1,2,3,.5,7],[!0,!1,null,"sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"),"0.3"],["baz",null,"qux"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"dl"};t(e,n)}function t(e,t){t={type:t.type||"xlsx",sheetName:t.sheetName||"SheetJS",fileName:t.fileName||"test"};var n=t.sheetName,i=new a,s=r(e);i.SheetNames.push(n),i.Sheets[n]=s;var u={bookType:t.type,bookSST:!1,type:"binary"},c=XLSX.write(i,u);saveAs(new Blob([o(c)],{type:""}),t.fileName+"."+t.type)}function n(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function r(e,t){for(var r={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},a=0;a!=e.length;++a)for(var i=0;i!=e[a].length;++i){o.s.r>a&&(o.s.r=a),o.s.c>i&&(o.s.c=i),o.e.r<a&&(o.e.r=a),o.e.c<i&&(o.e.c=i);var s={v:e[a][i]};if(null!=s.v){var u=XLSX.utils.encode_cell({c:i,r:a});"number"==typeof s.v?s.t="n":"boolean"==typeof s.v?s.t="b":s.v instanceof Date?(s.t="n",s.z=XLSX.SSF._table[14],s.v=n(s.v)):s.t="s",r[u]=s}}return o.s.c<1e7&&(r["!ref"]=XLSX.utils.encode_range(o)),r}function o(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function a(){return this instanceof a?(this.SheetNames=[],void(this.Sheets={})):new a}return{exportExcel:t,testExcel:e}}(),helperJs=function(){function e(e,t,n){function r(n){return n[e]===t}return n.find(r)}function t(){var e=0;$(window).on("scroll",function(t){var n=$(this).scrollTop();n>e?console.log("down"):console.log("up"),e=n})}function n(e){e.replaceWith(e.val("").clone(!0))}function r(e){var t=!0;if(isNaN(e))if(null===e||void 0===e)t=!0;else for(var n in e)e.hasOwnProperty(n)&&(t=!1);else t=!1;return t}function o(e,t){var n=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r="[\\?&]"+n+"=([^&#]*)",o=new RegExp(r),a=o.exec(e);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function a(e,t,n,r,o){e=e||0,t=isNaN(t=Math.abs(t))?0:t,n=void 0!==n?n:"",r=r||".",o=o||",";var a=e<0?"-":"",i=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",s=(s=i.length)>3?s%3:0;return n+a+(s?i.substr(0,s)+r:"")+i.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?o+Math.abs(e-i).toFixed(t).slice(2):"")}function i(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function s(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function u(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,o)},t)}}function c(e,t,n){t||(t=250);var r,o;return function(){var a=n||this,i=+new Date,s=arguments;r&&i<r+t?(clearTimeout(o),o=setTimeout(function(){r=i,e.apply(a,s)},t)):(r=i,e.apply(a,s))}}function l(e,t){var n=e.replace("#","");n=n.match(new RegExp("(.{"+n.length/3+"})","g"));for(var r=0;r<n.length;r++)n[r]=parseInt(1==n[r].length?n[r]+n[r]:n[r],16);return"undefined"!=typeof t&&n.push(t),"rgba("+n.join(",")+")"}function d(e,t){function n(e){o++,o===e&&r()}function r(){"function"==typeof t&&t()}var o=0,a=e.length;if(a)for(var i=0;i<a;i++){var s=new Image;s.src=e[i],s.onload=function(e){n(a),console.info("File loaded: ",e.target.currentSrc)},s.onerror=function(e){n(a),console.info("Cannot load file: ",e.target.currentSrc)}}else r()}function p(e,t,n){t="undefined"!=typeof t?t:1e3,n="undefined"!=typeof n?n:0;var r=$(e).offset(),o=r.top+n;$("html,body").animate({scrollTop:o},t)}function m(e){e="undefined"!=typeof e?e:1e3,$("html,body").animate({scrollTop:0},e)}function g(e,t){return Math.random()*(t-e+1)+e}function h(e,t){return Math.floor(Math.random()*(t-e+1))+e}function f(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}return{detectScrollDirection:t,clearFileInput:n,isUndefinedNullEmpty:r,getQueryString:o,formatMoney:a,enterFullScreen:i,exitFullScreen:s,debounce:u,throttle:c,hexToRgb:l,preloader:d,scrollToElement:p,scrollToTop:m,randomRangeFloat:g,randomRangeInt:h,extend:f,findObject:e}}();!function(){$.fn.bzAccordion=function(e,t){var n=this.find(".item");t&&(n.first().find(".question").addClass("expanded"),n.first().find(".answer").show()),n.find(".question").click(function(){$(this).hasClass("expanded")?($(this).removeClass("expanded"),$(this).parent().find(".answer").slideUp(200)):(e&&$.each(n.find(".question"),function(e,t){$(t).removeClass("expanded"),$(t).parent().find(".answer").slideUp(200)}),$(this).addClass("expanded"),$(this).parent().find(".answer").slideDown(200))})}}(),function(){Array.prototype.getIndexBy=function(e,t){for(var n=0;n<this.length;n++)if(this[n][e]==t)return n;return-1},Array.prototype.removeAt=function(e){var t=this.splice(e,1);return t},String.prototype.format=function(){var e=arguments;return this.replace(/\{\{|\}\}|\{(\d+)\}/g,function(t,n){return"{{"==t?"{":"}}"==t?"}":e[n]})},String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}();var sortJs=function(){function e(e){if(e.length<=1)return e;for(var t=e.length,n=0;n<t;n++)for(var r=0;r<t-1;r++)if(e[r]>e[r+1]){var o=e[r];e[r]=e[r+1],e[r+1]=o}return e}function t(e){if(e.length<=1)return e;var n=Math.floor((e.length-1)/2),r=e[n],o=[],a=[];e=e.slice(0,n).concat(e.slice(n+1));for(var i=0;i<e.length;i++)e[i]<r?o.push(e[i]):a.push(e[i]);return[].concat(t(o),[r],t(a))}function n(e){if(e.length<=1)return e;var t=Math.floor(e.length/2),r=e.slice(0,t),o=e.slice(t),a=function(e,t){for(var n=[];e.length&&t.length;)e[0]<t[0]?n.push(e.shift()):n.push(t.shift());return n.concat(e).concat(t)};return a(n(r),n(o))}function r(e){for(var t=0;t<e.length;t++){for(var n=t,r=t+1;r<e.length;r++)e[r]<e[n]&&(n=r);if(n!=t){var o=e[n];e[n]=e[t],e[t]=o}}return e}function o(e){for(var t=0;t<e.length;t++)for(var n=t-1,r=e[t];n>=0&&e[n]>r;)e[n+1]=e[n],e[n]=r,n--;return e}return{bubble:e,quick:t,merge:n,selection:r,insertion:o}}(),Storage=function(){function e(e){var t=new Date,r=Math.round(+t/1e3),o=JSON.parse(localStorage.getItem(settingJs.appPrefix+"."+e))||{},a=o.storageExpireTime||0;return a&&a<r?void n(settingJs.appPrefix+"."+e):o.store}function t(e,t,n){var r=new Date,o=Math.round(r.setSeconds(r.getSeconds()+n)/1e3),a=JSON.stringify({storageExpireTime:o,store:t});try{localStorage.setItem(settingJs.appPrefix+"."+e,a)}catch(i){i==QUOTA_EXCEEDED_ERR&&alert("Quota exceeded!")}return a}function n(e){localStorage.removeItem(settingJs.appPrefix+"."+e)}function r(){localStorage.clear()}return{get:e,set:t,remove:n,clear:r}}(),Application=function(){function e(e){angular.module(a).requires.push(e)}function t(e){s.push(e)}function n(e,t){function n(n){function r(n,r){n.forEach(function(t){t.config.params=t.config.params||{},e.state(t.state,t.config)}),r&&!a&&(a=!0,t.otherwise(r))}function o(){return n.get()}var a=!1;return{configureStates:r,getStates:o}}n.$inject=["$state"],this.$get=n}function r(e,t,n,r,o,a,i){e.errorOnUnhandledRejections(!1),r.setMessageTemplate("assets/global/message/view.html"),angular.extend(o,{extendedTimeOut:1e3,timeOut:1e3,newestOnTop:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,preventOpenDuplicates:!1,tapToDismiss:!0,allowHtml:!0,closeButton:!0,target:"body"}),a.startSymbol("[["),a.endSymbol("]]"),n.html5Mode(!1).hashPrefix("!"),t.defaults.withCredentials=!0,t.defaults.headers.post["Content-Type"]="application/json; charset=UTF-8"}function o(e,t,n,r,o,a,i,u){function c(e,t,n){o.go(e,t,n)}window.fbAsyncInit=function(){FB.init({appId:settingJs.configs.facebookAppId,status:!0,xfbml:!0,version:"v2.9"})},e.configureStates(s,"/"),angular.element("body").removeClass("hide"),t._=window._,t.pageData={},t.pageMethods={},t.pageMethods.authSvc=i,t.pageMethods.redirect=c,t.$on("$stateChangeStart",function(e,n,r,o,a){t.pageData.title=n.data.title,t.pageData.className=n.name,t.pageData.menuType=n.data.menuType}),t.$on("$stateChangeSuccess",function(e,o,a,i,s){n.scrollTop=r[0].body.scrollTop=r[0].documentElement.scrollTop=0,t.pageData.currentState=o,t.pageData.currentParams=a}),t.promotionForOrderDeleveryOnAffternoon={value:0,status:!1,type:"PC"},t.promotionForFirstOrder={value:0,status:!1,type:"PC"},t.freeShipUrban={value:999999999,status:!1,type:"MN"},t.freeShipSuburb={value:999999999,status:!1,type:"MN"}}n.$inject=["$stateProvider","$urlRouterProvider"],r.$inject=["$qProvider","$httpProvider","$locationProvider","$bzPopupProvider","toastrConfig","$interpolateProvider","$resourceProvider"],o.$inject=["routerHelper","$rootScope","$window","$document","$state","$timeout","authSvc","notiSvc"];var a="bzApp",i=["ui.bootstrap","ngSanitize","ngAnimate","ngMessages","ngResource","ui.router","toastr","ngPopup","daterangepicker","angularjs-datetime-picker","ngTable","ngFileUpload","ui.select2","ckeditor"],s=[];return angular.module(a,i).provider("routerHelper",n).config(r).run(o),angular.element(document).ready(function(){!function(e,t,n){var r,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(r=e.createElement(t),r.id=n,r.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(r,o))}(document,"script","facebook-jssdk"),angular.bootstrap(document,[a])}),{registerModule:e,registerRouter:t}}();!function(){function e(e,t,n,r){function o(t,n){var r=e.defer();return"add-product"===t?c(n.product,n.quantity):"set-quantity"===t?u(n.product,n.quantity):"delete-product"===t?s(n.product):"delete-cart"===t?i():(r.reject("Type mismach"),r.promise)}function a(){var o=e.defer();return r.api(t.settings.services.apiUrl+"/order/cart").get({},function(e){n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart),o.resolve(e)},function(e){o.reject(e)}),o.promise}function i(){var o=e.defer();return r.api(t.settings.services.apiUrl+"/order/delete-cart").get({},function(e){n.Cart={items:[],total:0},n.$broadcast("Cart:getCart",e.cart),o.resolve(e)},function(e){o.reject(e)}),o.promise}function s(o){var a=e.defer();return r.api(t.settings.services.apiUrl+"/order/delete-product/"+o).get({},function(e){n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart),a.resolve(e)},function(e){a.reject(e)}),a.promise}function u(o,a){var i=e.defer();return r.api(t.settings.services.apiUrl+"/order/set-quantity/"+o+"/"+a).get({},function(e){e.success&&(n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart)),i.resolve(e)},function(e){i.reject(e)}),i.promise}function c(t,o){var a=e.defer();return r.api(settingJs.configs.userApiUrl+"/order/"+t+"/"+o).get({},function(e){e.success&&(n.Cart=e.cart,n.$broadcast("Cart:getCart",e.cart)),a.resolve(e)},function(e){a.reject(e)}),a.promise}return{getCart:a,update:o}}function t(e,t){return t.api(settingJs.configs.userApiUrl+"/user/:method/:id",{method:"@method",id:"@id"})}function n(e,t){function n(n){var r=e.defer();return t.api(settingJs.configs.userApiUrl+"/upload/base64").save(n,function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise}return{uploadBase64:n}}function r(e,t){function n(){var n=e.defer();return t.api(settingJs.configs.adminUrl+"/noti-dup-contact").get({},{},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise}return{getDupContact:n}}function o(e,t,n,r,o){function a(){return 0!==_.intersection(n.user.scope,["super-admin"]).length}function i(){return 0!==_.intersection(n.user.scope,["admin"]).length}function s(e,t){var r="string"==typeof t,o=n.permissions,a=null;if(angular.forEach(o,function(t,n){n===e&&(a=t)}),a){if("*"===a[0])return!0;if(r&&1===_.intersection([t],a).length)return!0;if(_.intersection(t,a).length===t.length)return!0}return!1}function u(e){return _.intersection(n.user.scope,e).length>0}function c(e){var t=new r(e);return t.$save({method:"register"})}function l(){var e=n.user;return e}function d(e){return Storage.set(settingJs.appPrefix+"bzp",e,settingJs.storageExpireTime),Storage.set(settingJs.appPrefix+"bzl",!0,settingJs.storageExpireTime),e}function p(){var e=Storage.get(settingJs.appPrefix+"bzl");return!!e}function m(e,r,a){var i=t.defer();return o.api(n.settings.services.apiUrl+"/user/login").save({},e,function(e){d(e),i.resolve(e),angular.isFunction(r)&&r(e)},function(e){i.reject(e),angular.isFunction(a)&&a(e)}),i.promise}function g(e){l();o.api(n.settings.services.apiUrl+"/user/logout").save({},{},function(t){d(void 0),angular.isFunction(e)&&e(t),n.location.href=settings.services.webUrl})}function h(t){var r=e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/login/view.html",controller:"popLoginCtrl",controllerAs:"vmLogin"});r.result.then(function(e){return e||(t?n.location.href=t:n.location.reload()),e})}function f(){e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/register/view.html",controller:"popRegisterCtrl",controllerAs:"vmRegister"})}function v(){e.open({animation:!0,templateUrl:settings.services.webUrl+"/modules/web-auth/view/client/popup/forgot-pass/view.html",controller:"popForgotPassCtrl",controllerAs:"vmForgotPass"})}function y(){e.open({animation:!0,templateUrl:"modules/admin-user/view/client/popup/change-pass/view.html",controller:"popChangePassCtrl",controllerAs:"mvCPass"})}function b(e){var t=new r(e);return t.$save({method:"change-password"})}function P(e){var t=new r(e);return t.$save({method:"forgot-password"})}function T(e){var t=new r(e);return t.$save({method:"reset-password"})}function $(e,t){var n=new r(e);return n.$update({id:t})}function C(){var e=t.defer();return FB.getLoginStatus(function(t){if("connected"===t.status){t.authResponse.accessToken;FB.api("/me",{fields:"id,name,email,picture"},function(t){e.resolve(t)})}else FB.login(function(t){if("not_authorized"===t.status&&e.resolve({error:"Vui lòng đồng ý sử dụng ứng dụng để đăng nhập tài khoản"}),"connected"===t.status){t.authResponse.accessToken;FB.api("/me",{fields:"id,name,email,picture"},function(t){e.resolve(t)})}},{scope:"email"})}),e.promise}function w(e,r,a){var i=t.defer(),s={email:e.email,provider_id:e.id,name:e.name,profile_picture:e.profile_picture};return o.api(n.settings.services.userApi+"/user/facebook-login").save({},s,function(e){d(e),i.resolve(e),angular.isFunction(r)&&r(e)},function(e){i.reject(e),angular.isFunction(a)&&a(e)}),i.promise}return n.user=n.user||{},{isSuperAdmin:a,isAdmin:i,hasPermission:s,exist:u,register:c,getProfile:l,setProfile:d,isSignedIn:p,siteLogin:m,siteLogout:g,popLogin:h,popRegister:f,popForgotPass:v,popChangePass:y,postChangePass:b,forgotPassword:P,resetPassword:T,update:$,getFacebook:C,facebookLogin:w}}function a(e){function t(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-"),t="@"+t+"@",t=t.replace(/\@\-|\-\@|\@/gi,"")}return e}function n(e,t,n){function r(n){return n[e]===t}return n.find(r)}function r(e,t,n){var o,a=[];if(n=n||"",angular.isArray(e)){var i=e.filter(function(e){return e.parentId===t});if(i.length)for(var s=0;s<i.length;s++){i[s].name=n+i[s].name,a.push(i[s]);for(var u=r(e,i[s].id,n+"—"),c=0;c<u.length;c++)a.push(u[c])}o=a}else o=e;return o}function o(){e.open({templateUrl:"modules/popup/cropper/view.html",closeOnBg:!1,data:{ratio:1,width:320,height:320,type:"image/jpeg",event:"bz:CropperAvatarSuccess",image:"images/demo.jpg",props:{btnOk:"Lưu",btnCancel:"Huỷ bỏ",btnOkEvent:"bz:CropperAvatarOk",btnCancelEvent:"bz:CroppperAvatarCancel"}}})}function a(e,t){"undefined"!=typeof Storage?Storage.set(e,t,settingJs.storageExpireTime):console.error("Sorry! The browser does not support Storage.")}function i(e){if("undefined"!=typeof Storage){var t=Storage.get(e);return t}return console.error("Sorry! The browser does not support Storage."),null}function s(e){"undefined"!=typeof Storage?Storage.remove(e):console.error("Sorry! The browser does not support Storage.")}function u(e){a(settingJs.appPrefix+"_infoUser",e)}function c(){return i(settingJs.appPrefix+"_infoUser")}function l(){s(settingJs.appPrefix+"_infoUser")}return{recusive:r,cropAvatar:o,findObject:n,textToSlug:t,setLocalStorage:a,getLocalStorage:i,removeLocalStorage:s,setInfoUser:u,getInfoUser:c,removeInfoUser:l}}function i(e){function t(t,n,r){return r=r||{},r.get=angular.extend({},r.get),r.query=angular.extend({isArray:!0},r.query),r.update=angular.extend({method:"PUT"},r.update),r.upload=angular.extend({method:"POST",headers:{"Content-Type":void 0},transformRequest:angular.identity},r.upload),e(t,n,r)}return{api:t}}function s(e){return{load:function(t){var n=e.defer();return helperJs.preloader(t,function(){n.resolve()}),n.promise}}}a.$inject=["$bzPopup"],i.$inject=["$resource"],s.$inject=["$q"],o.$inject=["$uibModal","$q","$window","userApiFac","bzResourceSvc"],r.$inject=["$q","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],e.$inject=["$q","$window","$rootScope","bzResourceSvc"],n.$inject=["$q","bzResourceSvc"],angular.module("bzApp").service("bzUtilsSvc",a).service("bzResourceSvc",i).factory("bzPreloadSvc",s).service("authSvc",o).service("notiSvc",r).factory("userApiFac",t).service("orderApiSvc",e).service("bzUpload",n)}(),function(){function e(e){return function(t){return e.trustAsHtml(t)}}function t(e){return function(t){return e.trustAsResourceUrl(t)}}function n(){return function(e){return helperJs.formatMoney(e)}}function r(){return function(e,t){return helperJs.hexToRgb(e,t)}}function o(){return function(e){return String(e).replace(/<[^>]+>/gm,"")}}function a(){return function(e,t){var n=new Date(e),r=moment(n).format(t);return r}}function i(){return function(e,t){return t=+t,angular.isArray(e)?e.slice(t):e}}function s(){return function(e){return Object.keys(e).length}}e.$inject=["$sce"],t.$inject=["$sce"],angular.module("bzApp").filter("bzTrustHtml",e).filter("bzTrustResource",t).filter("bzCurrency",n).filter("bzHexToRgb",r).filter("bzTripHtml",o).filter("bzFormatDate",a).filter("bzFirstPage",i).filter("bzObjectKeysLength",s)}(),function(){function e(e,t){return{require:"ngModel",link:function(t,n,r,o){return e(function(){var e,a=r.checkboxClass;return e=r.value,t.$watch(r.ngModel,function(e){$(n).iCheck("update")}),$(n).iCheck({radioClass:"iradio_square-blue",checkboxClass:a||"icheckbox_square-blue",increaseArea:"20%"}).on("ifChanged",function(a){if("checkbox"===$(n).attr("type")&&r.ngModel&&t.$apply(function(){return o.$setViewValue(a.target.checked)}),"radio"===$(n).attr("type")&&r.ngModel)return t.$apply(function(){return o.$setViewValue(e)})})})}}}function t(){return{require:"ngModel",scope:{atrOptions:"=atrOptions"},link:function(e,t,n,r){var o={timePicker:!1,timePickerIncrement:30,singleDatePicker:!0,autoUpdateInput:!1,locale:{format:"DD/MM/YYYY"}};o=angular.extend({},o,e.atrOptions),t.daterangepicker(o),t.on("apply.daterangepicker",function(e,t){var n={startDate:t.startDate,endDate:t.endDate};return o.singleDatePicker?(t.element.val(t.startDate.format(t.locale.format)),r.$setViewValue(n.startDate)):(t.element.val(t.startDate.format(t.locale.format)+" - "+t.endDate.format(t.locale.format)),r.$setViewValue(n))}),r&&(r.$render=function(){if(r.$viewValue){var e=moment(r.$viewValue).format(o.locale.format);t.val(e||"")}})}}}function n(e){return{require:"ngModel",scope:{atrOptions:"=atrOptions"},link:function(t,n,r,o){var a={timePicker:!1,timePickerIncrement:30,singleDatePicker:!0,autoUpdateInput:!1,locale:{format:"DD/MM/YYYY"}};a=angular.extend({},a,t.atrOptions),e(function(){n.daterangepicker(a),n.on("apply.daterangepicker",function(e,t){var n={startDate:t.startDate,endDate:t.endDate};return t.element.val(t.startDate.format(t.locale.format)),o.$setViewValue(n.startDate)}),o&&(o.$render=function(){if(o.$viewValue){var e=moment(o.$viewValue).format(a.locale.format);n.val(e||"")}})},10)}}}function r(e){return{require:"ngModel",scope:{modelValue:"=ngModel"},link:function(t,n,r,o){e(function(){var e=n.colorpicker({color:t.modelValue});e.on("changeColor",function(e){t.$apply(function(){o.$setViewValue(e.color.toString())})})})}}}function o(e,t){return{link:function(t,n,r){function o(t){e(function(){autosize(n)},t)}o(0),t.$on("bz:redrawAutogrow",function(){o(100)})}}}function a(e){return{require:"?ngModel",transclude:!0,restrict:"A",link:function(t,n,r,o){var a;e(function(){function e(){return t.$apply(function(){return o.$setViewValue(a.getData())})}if(a=CKEDITOR.replace(n[0],{}),o)return a.on("instanceReady",function(){return a.setData(o.$viewValue)}),a.on("change",e),a.on("dataReady",e),a.on("key",e),a.on("paste",e),a.on("selectionChange",e),o.$render=function(){return a.setData(o.$viewValue)}})}}}function i(){return{link:function(e,t,n){var r=e.$eval(n.bzInputMask);Inputmask(r).mask(t[0])}}}function s(){return{restrict:"E",replace:!0,template:'<div id="bz-progressbar"><div></div></div>',link:function(e,t,n){e.$on("$stateChangeStart",function(e,n,r,o,a){function i(e){setTimeout(function(){if(e<90){var n=helperJs.randomRangeInt(e,e+10);t.find(">div").css("width",n+"%"),e+=n,i(e)}},helperJs.randomRangeInt(200,500))}setTimeout(function(){t.find(">div").css("width",0),t.fadeIn(200)},500),i(0)}),e.$on("$stateChangeSuccess",function(e,n,r,o,a){t.find(">div").css("width","100%"),setTimeout(function(){t.fadeOut(200)},500)})}}}function u(){return{replace:!0,transclude:!0,template:'<div><img ng-src="{{icon}}" /><span>{{caption}}</span></div>',link:function(e,t,n){var r=angular.element(n["for"]);e.caption=n.caption,e.icon=n.icon,t.on("click",function(e){t.hide(),r.focus()}),r.on("focus",function(e){t.hide()}),r.on("blur",function(e){var n=r.val();n.length||t.show()})}}}function c(e){return{link:function(t,n,r){var o=e(r.bzFileModel),a=o.assign;n.bind("change",function(){t.$apply(function(){a(t,n[0].files)})})}}}function l(e,t){return{restrict:"A",link:function(n,r,o){function a(r,o){n.allowInputControls&&(n.allowInputControls=!1,"up"===o?c++:c--,settingJs.pageTransitionLoop?(c>i&&(c=0),c<0&&(c=i)):(c>i&&(c=i),c<0&&(c=0),t(function(){n.allowInputControls=!0},settingJs.pageTransitionDelay)),e.go(settingJs.pageTransitionSequence[c].stateName))}var i=settingJs.pageTransitionSequence.length-1,s="",u="",c=0;n.allowInputControls=!0,n.$on("bz:allowInputControls",function(e,t){n.allowInputControls=t}),n.$on("$stateChangeSuccess",function(e,r,o,a,i){s=r.name,c=settingJs.pageTransitionSequence.getIndexBy("stateName",s),t(function(){n.allowInputControls=!0},settingJs.pageTransitionDelay)}),r.on("keydown",function(t){s=e.current.name,38!==t.keyCode&&39!==t.keyCode||(u="down",a(s,u)),37!==t.keyCode&&40!==t.keyCode||(u="up",a(s,u))}),r.mousewheel(function(e,t,n,r){u=t>0?"down":"up",a(s,u)})}}}function d(){return{require:"ngModel",link:function(e,t,n,r){var o=$(n.bzValidPasswordMatch);r.$parsers.push(function(e){return r.$setValidity("match",""!==e&&e===o[0].value),e})}}}function p(){return{require:"ngModel",link:function(e,t,n,r){var o=[/[^\w\s]+/,/[A-Z]+/,/\w+/,/\d+/],a=$(n.bzPasswordStrength);t.on("focus",function(e){a.show()}),t.on("blur",function(e){a.hide()}),r.$parsers.push(function(t){var n=0;t.length>=8&&(angular.forEach(o,function(e){e.test(t)&&n++}),e.passwordStrength=n)})}}}function m(){return{require:"ngModel",link:function(e,t,n,r){var o=parseInt(n.maxWords),a=parseInt(n.minWords)||0,i=0;r.$parsers.push(function(e){return i=e.trim().replace(/(\r\n|\n|\r)/gm," ").replace(/\.\s+/g," ").split(" ").length,r.$setValidity("mixwords",i>=a),r.$setValidity("maxwords",i<=o),e})}}}function g(e){return{require:"ngModel",scope:{bzValidExist:"="},link:function(t,n,r,o){var a=t.bzValidExist;n.on("focus",function(e){$(a.selector).hide()}),n.on("blur",function(n){a.value=o.$viewValue;var r=e(a.url),i=new r(a);i.$save(function(e){e.status&&$(a.selector).show()}),t.$apply()})}}}function h(){var e=[/[^\w\s]+/,/[A-Z]+/,/\w+/,/\d+/];return{require:"ngModel",link:function(t,n,r,o){o.$parsers.push(function(t){var n=!0;return angular.forEach(e,function(e){n=n&&e.test(t)}),o.$setValidity("passwordcharacters",n),t})}}}function f(e){return{require:"ngModel",link:function(t,n,r,o){function a(e){for(var t=[],n=[],r=0;r<i.length;r++)i[r].size>s&&t.push(i[r]),u.indexOf(i[r].type)===-1&&n.push(i[r]);return o.$setValidity("filesize",0===t.length),o.$setValidity("filetype",0===n.length),e}var i=[],s=r.fileSize,u=r.fileType.split(","),c=e(r.ngModel),l=c.assign;t.$on("bz:clearFileInput",function(){o.$setViewValue(null),o.$render(),n.val("")}),n.on("change",function(){t.$apply(function(){i=n[0].files,l(t,n[0].files),a(n.val())})})}}}function v(){return{replace:!0,transclude:!0,template:'<button><ng-transclude></ng-transclude><div class="circle animFade" ng-if="type===\'circle\'"></div><div class="bar animFade" ng-if="type===\'bar\'"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div></div></button>',link:function(e,t,n){e.type=n.loadingIcon||"circle"}}}function y(e,t){return{link:function(n,r,o){function a(e){switch(e){case 0:s="pt-page-fadeOut",i="pt-page-fadeIn";break;case 1:s="pt-page-moveToLeft",i="pt-page-moveFromRight";break;case 2:s="pt-page-moveToRight",i="pt-page-moveFromLeft";break;case 3:s="pt-page-moveToTop",i="pt-page-moveFromBottom";break;case 4:s="pt-page-moveToBottom",i="pt-page-moveFromTop";break;case 5:s="pt-page-fade",i="pt-page-moveFromRight pt-page-ontop";break;case 6:s="pt-page-fade",i="pt-page-moveFromLeft pt-page-ontop";break;case 7:s="pt-page-fade",i="pt-page-moveFromBottom pt-page-ontop";break;case 8:s="pt-page-fade",i="pt-page-moveFromTop pt-page-ontop";break;case 9:s="pt-page-moveToLeftFade",i="pt-page-moveFromRightFade";break;case 10:s="pt-page-moveToRightFade",i="pt-page-moveFromLeftFade";break;case 11:s="pt-page-moveToTopFade",i="pt-page-moveFromBottomFade";break;case 12:s="pt-page-moveToBottomFade",i="pt-page-moveFromTopFade";break;case 13:s="pt-page-moveToLeftEasing pt-page-ontop",i="pt-page-moveFromRight";break;case 14:s="pt-page-moveToRightEasing pt-page-ontop",i="pt-page-moveFromLeft";break;case 15:s="pt-page-moveToTopEasing pt-page-ontop",i="pt-page-moveFromBottom";break;case 16:s="pt-page-moveToBottomEasing pt-page-ontop",i="pt-page-moveFromTop";break;case 17:s="pt-page-scaleDown",i="pt-page-moveFromRight pt-page-ontop";break;case 18:s="pt-page-scaleDown",i="pt-page-moveFromLeft pt-page-ontop";break;case 19:s="pt-page-scaleDown",i="pt-page-moveFromBottom pt-page-ontop";break;case 20:s="pt-page-scaleDown",i="pt-page-moveFromTop pt-page-ontop";break;case 21:s="pt-page-scaleDown",i="pt-page-scaleUpDown pt-page-delay300";break;case 22:s="pt-page-scaleDownUp",i="pt-page-scaleUp pt-page-delay300";break;case 23:s="pt-page-moveToLeft pt-page-ontop",i="pt-page-scaleUp";break;case 24:s="pt-page-moveToRight pt-page-ontop",i="pt-page-scaleUp";break;case 25:s="pt-page-moveToTop pt-page-ontop",i="pt-page-scaleUp";break;case 26:s="pt-page-moveToBottom pt-page-ontop",i="pt-page-scaleUp";break;case 27:s="pt-page-scaleDownCenter",i="pt-page-scaleUpCenter pt-page-delay400";break;case 28:s="pt-page-rotateRightSideFirst",i="pt-page-moveFromRight pt-page-delay200 pt-page-ontop";break;case 29:s="pt-page-rotateLeftSideFirst",i="pt-page-moveFromLeft pt-page-delay200 pt-page-ontop";break;case 30:s="pt-page-rotateTopSideFirst",i="pt-page-moveFromTop pt-page-delay200 pt-page-ontop";break;case 31:s="pt-page-rotateBottomSideFirst",i="pt-page-moveFromBottom pt-page-delay200 pt-page-ontop";break;case 32:s="pt-page-flipOutRight",i="pt-page-flipInLeft pt-page-delay500";break;case 33:s="pt-page-flipOutLeft",i="pt-page-flipInRight pt-page-delay500";break;case 34:s="pt-page-flipOutTop",i="pt-page-flipInBottom pt-page-delay500";break;case 35:s="pt-page-flipOutBottom",i="pt-page-flipInTop pt-page-delay500";break;case 36:s="pt-page-rotateFall pt-page-ontop",i="pt-page-scaleUp";break;case 37:s="pt-page-rotateOutNewspaper",i="pt-page-rotateInNewspaper pt-page-delay500";break;case 38:s="pt-page-rotatePushLeft",i="pt-page-moveFromRight";break;case 39:s="pt-page-rotatePushRight",i="pt-page-moveFromLeft";break;case 40:s="pt-page-rotatePushTop",i="pt-page-moveFromBottom";break;case 41:s="pt-page-rotatePushBottom",i="pt-page-moveFromTop";break;case 42:s="pt-page-rotatePushLeft",i="pt-page-rotatePullRight pt-page-delay180";break;case 43:s="pt-page-rotatePushRight",i="pt-page-rotatePullLeft pt-page-delay180";break;case 44:s="pt-page-rotatePushTop",i="pt-page-rotatePullBottom pt-page-delay180";break;case 45:s="pt-page-rotatePushBottom",i="pt-page-rotatePullTop pt-page-delay180";
break;case 46:s="pt-page-rotateFoldLeft",i="pt-page-moveFromRightFade";break;case 47:s="pt-page-rotateFoldRight",i="pt-page-moveFromLeftFade";break;case 48:s="pt-page-rotateFoldTop",i="pt-page-moveFromBottomFade";break;case 49:s="pt-page-rotateFoldBottom",i="pt-page-moveFromTopFade";break;case 50:s="pt-page-moveToRightFade",i="pt-page-rotateUnfoldLeft";break;case 51:s="pt-page-moveToLeftFade",i="pt-page-rotateUnfoldRight";break;case 52:s="pt-page-moveToBottomFade",i="pt-page-rotateUnfoldTop";break;case 53:s="pt-page-moveToTopFade",i="pt-page-rotateUnfoldBottom";break;case 54:s="pt-page-rotateRoomLeftOut pt-page-ontop",i="pt-page-rotateRoomLeftIn";break;case 55:s="pt-page-rotateRoomRightOut pt-page-ontop",i="pt-page-rotateRoomRightIn";break;case 56:s="pt-page-rotateRoomTopOut pt-page-ontop",i="pt-page-rotateRoomTopIn";break;case 57:s="pt-page-rotateRoomBottomOut pt-page-ontop",i="pt-page-rotateRoomBottomIn";break;case 58:s="pt-page-rotateCubeLeftOut pt-page-ontop",i="pt-page-rotateCubeLeftIn";break;case 59:s="pt-page-rotateCubeRightOut pt-page-ontop",i="pt-page-rotateCubeRightIn";break;case 60:s="pt-page-rotateCubeTopOut pt-page-ontop",i="pt-page-rotateCubeTopIn";break;case 61:s="pt-page-rotateCubeBottomOut pt-page-ontop",i="pt-page-rotateCubeBottomIn";break;case 62:s="pt-page-rotateCarouselLeftOut pt-page-ontop",i="pt-page-rotateCarouselLeftIn";break;case 63:s="pt-page-rotateCarouselRightOut pt-page-ontop",i="pt-page-rotateCarouselRightIn";break;case 64:s="pt-page-rotateCarouselTopOut pt-page-ontop",i="pt-page-rotateCarouselTopIn";break;case 65:s="pt-page-rotateCarouselBottomOut pt-page-ontop",i="pt-page-rotateCarouselBottomIn";break;case 66:s="pt-page-rotateSidesOut",i="pt-page-rotateSidesIn pt-page-delay200";break;case 67:s="pt-page-rotateSlideOut",i="pt-page-rotateSlideIn"}}var i="",s="",u=o.bzPageTransition.split(",");n.$on("$stateChangeSuccess",function(r,o,c,l,d){var p=$(".mainView");if(t.loadCounter>1){if(is.desktop()){var m=0,g=0;if(o.name===l.name)a(0),p.eq(0).addClass(i),p.eq(1).addClass(s);else{for(var h=0;h<settingJs.pageTransitionSequence.length;h++)settingJs.pageTransitionSequence[h].stateName===l.name&&(m=h),settingJs.pageTransitionSequence[h].stateName===o.name&&(g=h);p.removeClass(i+" "+s),m<g&&(a(parseInt(u[0])),p.eq(0).addClass(i),p.eq(1).addClass(s)),m>g&&(a(parseInt(u[1])),p.eq(0).addClass(i),p.eq(1).addClass(s))}}e.on("enter",p.eq(0),function(e,t){"close"===t&&n.$broadcast("bz:pageTransitionCompleted","")})}else a(0),p.eq(0).addClass(i),p.eq(1).addClass(s)})}}}function b(e){return{restrict:"A",link:function(e,t,n,r){t.timepicker()}}}function P(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){function o(){var e=t.val(),n=moment(e,"DD/MM/YYYY").toDate();r.$setViewValue(n)}r&&(r.$render=function(){if(r.$viewValue){var e=moment(r.$viewValue).format("DD/MM/YYYY");t.val(e||"")}},t.on("blur keyup change",function(){e.$evalAsync(o)}),o(),t.datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onSelect:function(t,n){e.$evalAsync(o)}}))}}}function T(e){return{restrict:"A",link:function(e,t,n,r){t.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,showTime:!1,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)}})}}}function C(e){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){var o=t.find("#dpFrom"),a=t.find("#dpTo");console.log(o),o.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onClose:function(e,t){},onSelect:function(e){a.datetimepicker("option","minDate",o.datetimepicker("getDate")),o.datepicker("hide")}}),a.datetimepicker({dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss",changeMonth:!0,changeYear:!0,beforeShow:function(){setTimeout(function(){$(".ui-datepicker").css("z-index",1050)},0)},onClose:function(e,t){},onSelect:function(e){o.datetimepicker("option","maxDate",a.datetimepicker("getDate")),a.datepicker("hide")}})}}}function w(e){return{restrict:"A",link:function(t,n,r){function o(){document.addEventListener("fullscreenchange",d,!1),document.addEventListener("webkitfullscreenchange",d,!1),document.addEventListener("mozfullscreenchange",d,!1),document.addEventListener("MSFullscreenChange",d,!1),p.addEventListener("webkitendfullscreen",d,!1),n.on("ended",function(e){l()})}function a(){p.play()}function i(){p.pause()}function s(){p.pause(),p.currentTime=0}function u(e){p.currentTime=e}function c(e){p.volume=e}function l(){t.$emit(e.media.ENDED)}function d(){var n=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;n?t.$emit(e.media.ENTER_FULLSCREEN):t.$emit(e.media.EXIT_FULLSCREEN)}var p=n[0];o(),t.$on(e.media.PLAY,function(){a()}),t.$on(e.media.PAUSE,function(){i()}),t.$on(e.media.STOP,function(){s()}),t.$on(e.media.SEEK,function(e,t){u(t)}),t.$on(e.media.VOLUME,function(e,t){c(t)}),t.$on(e.media.FULLSCREEN,function(e,t){console.log("request Fullscreen"),t?helperJs.enterFullScreen(p):helperJs.exitFullScreen()}),t.$on(e.media.ENTER_FULLSCREEN,function(e){console.log("enter Fullscreen")}),t.$on(e.media.EXIT_FULLSCREEN,function(e){console.log("exit Fullscreen")})}}}function S(){var e='<div class="loading-mask"><div id="bar-wave" class="bar-wave loading-style"><div class="bar"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div><div id="circle-spread" class="circle-spread loading-style"><div></div><div></div><div></div></div><div id="circle-line-spread" class="circle-line-spread loading-style"><div></div><div></div><div></div></div><div id="hoz-load-bar" class="hoz-load-bar loading-style"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div><div class="bar4"></div><div class="bar5"></div><div class="bar6"></div><div class="bar7"></div><div class="bar8"></div></div></div>';return{restrict:"E",templateUrl:e,replace:!0,link:function(e,t,n){t.find(n.loadingType).show()}}}function _(e){return{restrict:"A",link:function(t,n,r){function o(){$(a.selector).mCustomScrollbar(a)}var a={selector:n[0],theme:r.scrollbarTheme||"light",scrollbarPosition:r.scrollbarPosition||"inside",mouseWheel:{scrollAmount:20},scrollButtons:{enable:"true"===r.scrollbarArrow}};t.$on("bz:CustomScrollbarRender",function(){o()}),e(function(){o()},500)}}}function H(){return{restrict:"A",link:function(e,t,n){var r=n.bzRepeatCompleted.split(",");if(e.$last)for(var o=0;o<r.length;o++)e.$emit(r[o])}}}function A(e){return{restrict:"EA",replace:!0,scope:{pageParams:"=",pageState:"@"},template:'<div class="bz-pager"><a class="prev" ng-if="pageParams.page > 1" ui-sref="{{pageState}}({page: pageParams.page - 1 < 1 ? 1 : pageParams.page - 1})"><i class="fa fa-chevron-left"></i></a><a class="first" ng-if="pageParams.page > 3" ui-sref="{{pageState}}({page: 1})">1</a><a class="dot" ng-if="pageParams.page > 3">...</a><a class="num" ng-class="{active: page === pageParams.page}" ng-href="{{toHref(page)}}" ng-repeat="page in pageVisible">{{page}}</a><a class="dot" ng-if="pageParams.page < pageParams.pageCount - 2">...</a><a class="last" ng-if="pageParams.page < pageParams.pageCount - 2" ui-sref="{{pageState}}({page: pageParams.pageCount})">{{pageParams.pageCount}}</a><a class="next" ng-if="pageParams.page < pageParams.pageCount" ui-sref="{{pageState}}({page: (pageParams.page > pageParams.pageCount) ? pageParams.pageCount : (pageParams.page + 1)})"><i class="fa fa-chevron-right"></i></a></div>',link:function(t,n,r){function o(n){return e.href(t.pageState,{page:n})}function a(){t.pageVisible=[];for(var e=Math.ceil(Math.min(Math.max(1,t.pageParams.page-settingJs.pageVisibleCount/2),Math.max(1,t.pageParams.pageCount-settingJs.pageVisibleCount+1))),n=Math.ceil(Math.min(t.pageParams.pageCount,e+settingJs.pageVisibleCount-1)),r=e;r<=n;r++)t.pageVisible.push(r)}t.pageParams.page=parseInt(t.pageParams.page),t.toHref=o,a(),t.$on("bz:pageRefresh",function(e,n){t.pageParams.pageCount=n,a()})}}}function D(e){return{restrict:"A",link:function(t,n,r){is.desktop()&&(t.$on("$stateChangeSuccess",function(t,o,a,i,s){e(function(){n.find(r.bzParallax).parallax()},1e3)}),t.$on("$destroy",function(){n.find(r.bzParallax).parallax("disable")}))}}}function k(e){return{restrict:"A",link:function(t,n,r){function o(){n.find("a.fancybox").fancybox({beforeLoad:function(){e.$broadcast("bz:allowInputControls",!1)},beforeClose:function(){e.$broadcast("bz:allowInputControls",!0)}})}helperJs.isUndefinedNullEmpty(r.bzFancybox)?t.$on("bz:fancyBox",function(){o()}):"static"===r.bzFancybox&&o()}}}function z(){return{restrict:"A",scope:{bzInfinityScroll:"&",bzInfinityBottom:"@"},link:function(e,t,n){var r=$(window);e.$on("$stateChangeStart",function(e,t,n,o,a){o.name!==t.name&&r.off("scroll.infinity")}),r.on("scroll.infinity",helperJs.debounce(function(t){var n=isNaN(e.bzInfinityBottom)?$(e.bzInfinityBottom).position().top:parseInt(e.bzInfinityBottom);r.scrollTop()+r.height()>=$(document).height()-n&&e.bzInfinityScroll()},500))}}}function L(){return{restrict:"A",link:function(e,t,n){var r=jRespond([{label:"handheld",enter:0,exit:1023},{label:"desktop",enter:1024,exit:1e4}]);r.addFunc({breakpoint:"handheld",enter:function(){$("html").removeClass(n.bzFullframe)}}),r.addFunc({breakpoint:"desktop",enter:function(){$("html").addClass(n.bzFullframe)}})}}}function q(){return{require:"?ngModel",replace:!0,template:'<div class="bz-tag form-control"><ul><li ng-repeat="key in keys track by $index">{{key}}<i class="glyphicon glyphicon-remove" ng-click="remove($index)"></i></li></ul><input type="text" placeholder="Enter để thêm từ khoá" /><div class="clearfix"></div></div>',link:function(e,t,n,r){function o(t){e.keys.splice(t,1),r.$setViewValue(e.keys)}e.keys=[],e.remove=o,t.find("input").on("keypress",function(t){if(13===t.keyCode){var n=$.trim($(this).val());return e.keys.indexOf(n)===-1&&n.length>0&&(e.keys.push(n),console.log(e.keys),$(this).val(""),r.$setViewValue(e.keys)),e.$apply(),t.stopPropagation(),t.preventDefault(),!1}})}}}function E(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.push(function(e){return r.$setValidity("isdate",1==moment(e,["DD/MM/YYYY"],!0).isValid()||""==e),e})}}}function R(){return{restrict:"A",link:function(e,t,n){t.on("keypress",function(e){if("1"==n.allowDot){if(8!=e.which&&0!=e.which&&46!=e.which&&(e.which<48||e.which>57))return!1}else if(8!=e.which&&0!=e.which&&(e.which<48||e.which>57))return!1})}}}function F(e,t){return{replace:!0,templateUrl:"/assets/global/cropper/crop.html",link:function(e,n,r){function o(){console.log(123),n.find("#cropper-input-file").click()}function a(e){d.cropper("zoom",e)}function i(e){e?d.cropper("rotate",e):d.cropper("rotate",90)}function s(e){if(e)d.cropper("scale",e);else switch(p++,p){case 1:d.cropper("scale",-1,1);break;case 2:d.cropper("scale",1,-1);break;case 3:d.cropper("scale",-1,-1);break;case 4:d.cropper("scale",1,1),p=0}}function u(){d=m.cropper({aspectRatio:r.cropRatio,guides:!1}),e.loading=!1}function c(t){var n,r=window.URL||window.webkitURL;r&&(n=r.createObjectURL(t.files[0]),m.one("built.cropper",function(){r.revokeObjectURL(n)}).cropper("reset").cropper("replace",n),setTimeout(function(){e.$apply(function(){e.showButtonCrop=!0})}))}function l(){var t=d.cropper("getCroppedCanvas",{width:r.cropWidth,height:r.cropHeight}),n=t.toDataURL(r.cropMime);e.$root.$broadcast(r.cropEvent,{image:n})}var d=null,p=0,m=(n.find("#cropper-input-file"),n.find("#cropper-img"));e.showButtonCrop=!1,e.loading=!1,e.getImage=l,e.setImage=c,e.fileTrigger=o,e.zoom=a,e.rotate=i,e.scale=s,e.$on("$destroy",function(){d.cropper("destroy")}),r.cropImage?(e.loading=!0,m[0].crossOrigin="anonymous",m[0].src=r.cropImage,t(function(){e.showButtonCrop=!0,u()},1e3)):u()}}}function x(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){r.$parsers.push(function(e){if(void 0==e)return"";var t=e.replace(/[^0-9]/g,"");return t!==e&&(r.$setViewValue(t),r.$render()),t})}}}r.$inject=["$timeout"],o.$inject=["$timeout","$window"],a.$inject=["$timeout"],c.$inject=["$parse"],l.$inject=["$state","$timeout"],g.$inject=["$resource"],f.$inject=["$parse"],y.$inject=["$animate","bzValueSvc"],b.$inject=["$timeout"],T.$inject=["$timeout"],C.$inject=["$timeout"],w.$inject=["bzEvents"],_.$inject=["$timeout"],A.$inject=["$state"],D.$inject=["$timeout"],k.$inject=["$rootScope"],e.$inject=["$timeout","$parse"],n.$inject=["$timeout"],F.$inject=["$state","$timeout"],angular.module("bzApp").directive("bzColorPicker",r).directive("autogrow",o).directive("ckEditor",a).directive("bzInputMask",i).directive("bzLoadingProgress",s).directive("bzPlaceholder",u).directive("bzFileModel",c).directive("bzInputControls",l).directive("bzValidPasswordMatch",d).directive("bzValidPassword",h).directive("bzPasswordStrength",p).directive("bzWordCount",m).directive("bzValidExist",g).directive("bzValidFileInput",f).directive("bzSubmit",v).directive("bzPageTransition",y).directive("bzTimePicker",b).directive("bzDatePicker",P).directive("bzDateTimePicker",T).directive("bzDateRangePicker",C).directive("bzMedia",w).directive("bzLoading",S).directive("bzCustomScrollbar",_).directive("bzRepeatCompleted",H).directive("bzPager",A).directive("bzParallax",D).directive("bzFancybox",k).directive("bzInfinityScroll",z).directive("bzFullframe",L).directive("bzTag",q).directive("bzInputNumber",R).directive("bzCheckDate",E).directive("iCheck",e).directive("atrDateTimePicker",t).directive("singleDateTimePicker",n).directive("bzCropper",F).directive("bzInputOnlyDigits",x)}(),function(){angular.module("bzApp").constant("VIETNAM_MAP",[{1:{name:"Thành phố Cần Thơ",districts:{66:"Huyện Cờ Đỏ",67:"Huyện Phong Điền",68:"Huyện Thới Lai",69:"Huyện Vĩnh Thạnh",70:"Quận Bình Thủy",71:"Quận Cái Răng",72:"Quận Ninh Kiều",73:"Quận Ô Môn",74:"Quận Thốt Nốt"}},2:{name:"Thành phố Đà Nẵng",districts:{76:"Huyện Hòa Vang",77:"Huyện Hoàng Sa",78:"Quận Cẩm Lệ",79:"Quận Hải Châu",80:"Quận Liên Chiểu",81:"Quận Ngũ Hành Sơn",82:"Quận Sơn Trà",83:"Quận Thanh Khê"}},3:{name:"Thành phố Hà Nội",districts:{85:"Huyện Ba Vì",86:"Huyện Chương Mỹ",87:"Huyện Đan Phượng",88:"Huyện Đông Anh",89:"Huyện Gia Lâm",90:"Huyện Hoài Đức",91:"Huyện Mê Linh",92:"Huyện Mỹ Đức",93:"Huyện Phú Xuyên",94:"Huyện Phúc Thọ",95:"Huyện Quốc Oai",96:"Huyện Sóc Sơn",97:"Huyện Thạch Thất",98:"Huyện Thanh Oai",99:"Huyện Thanh Trì",100:"Huyện Thường Tín",101:"Huyện Từ Liêm",102:"Huyện ứng Hòa",103:"Quận Ba Đình",104:"Quận Cầu Giấy",105:"Quận Đống Đa",106:"Quận Hà Đông",107:"Quận Hai Bà Trưng",108:"Quận Hoàn Kiếm",109:"Quận Hoàng Mai",110:"Quận Long Biên",111:"Quận Tây Hồ",112:"Quận Thanh Xuân",113:"Thị xã Sơn Tây"}},4:{name:"Thành phố Hải Phòng",districts:{115:"Huyện An Dương",116:"Huyện An Lão",117:"Huyện Bạch Long Vĩ",118:"Huyện Cát Hải",119:"Huyện Kiến Thụy",120:"Huyện Thủy Nguyên",121:"Huyện Tiên Lãng",122:"Huyện Vĩnh Bảo",123:"Quận Đồ Sơn",124:"Quận Dương Kinh",125:"Quận Hải An",126:"Quận Hồng Bàng",127:"Quận Kiến An",128:"Quận Lê Chân",129:"Quận Ngô Quyền"}},5:{name:"Thành phố Hồ Chí Minh",districts:{131:"Huyện Bình Chánh",132:"Huyện Cần Giờ",133:"Huyện Củ Chi",134:"Huyện Hóc Môn",135:"Huyện Nhà Bè",136:"Quận 1",137:"Quận 10",138:"Quận 11",139:"Quận 12",140:"Quận 2",141:"Quận 3",142:"Quận 4",143:"Quận 5",144:"Quận 6",145:"Quận 7",146:"Quận 8",147:"Quận 9",148:"Quận Bình Tân",149:"Quận Bình Thạnh",150:"Quận Gò Vấp",151:"Quận Phú Nhuận",152:"Quận Tân Bình",153:"Quận Tân Phú",154:"Quận Thủ Đức"}},6:{name:"Tỉnh An Giang",districts:{155:"Huyện An Phú",156:"Huyện Châu Phú",157:"Huyện Châu Thành",158:"Huyện Chợ Mới",159:"Huyện Phú Tân",160:"Huyện Thoại Sơn",161:"Huyện Tịnh Biên",162:"Huyện Tri Tôn",163:"Thành phố Long Xuyên",164:"Thị xã Châu Đốc",165:"Thị xã Tân Châu"}},7:{name:"Tỉnh Bà Rịa-Vũng Tàu",districts:{166:"Huyện Châu Đức",167:"Huyện Côn Đảo",168:"Huyện Đất Đỏ",169:"Huyện Long Điền",170:"Huyện Tân Thành",171:"Huyện Xuyên Mộc",172:"Thành phố Vũng Tàu",173:"Thị xã Bà Rịa"}},8:{name:"Tỉnh Bắc Giang",districts:{174:"Huyện Hiệp Hòa",175:"Huyện Lạng Giang",176:"Huyện Lục Nam",177:"Huyện Lục Ngạn",178:"Huyện Sơn Động",179:"Huyện Tân Yên",180:"Huyện Việt Yên",181:"Huyện Yên Dũng",182:"Huyện Yên Thế",183:"Thành phố Bắc Giang"}},9:{name:"Tỉnh Bắc Kạn",districts:{184:"Huyện Ba Bể",185:"Huyện Bạch Thông",186:"Huyện Chợ Đồn",187:"Huyện Chợ Mới",188:"Huyện Na Rì",189:"Huyện Ngân Sơn",190:"Huyện Pác Nặm",191:"Thị xã Bắc Kạn"}},10:{name:"Tỉnh Bạc Liêu",districts:{192:"Huyện Đông Hải",193:"Huyện Giá Rai",194:"Huyện Hòa Bình",195:"Huyện Hồng Dân",196:"Huyện Phước Long",197:"Huyện Vĩnh Lợi",198:"Thành Phố Bạc Liêu"}},11:{name:"Tỉnh Bắc Ninh",districts:{199:"Huyện Gia Bình",200:"Huyện Lương Tài",201:"Huyện Quế Võ",202:"Huyện Thuận Thành",203:"Huyện Tiên Du",204:"Huyện Yên Phong",205:"Thành phố Bắc Ninh",206:"Thị xã Từ Sơn"}},12:{name:"Tỉnh Bến Tre",districts:{207:"Huyện Ba Tri",208:"Huyện Bình Đại",209:"Huyện Châu Thành",210:"Huyện Chợ Lách",211:"Huyện Giồng Trôm",212:"Huyện Mỏ Cày Bắc",213:"Huyện Mỏ Cày Nam",214:"Huyện Thạnh Phú",215:"Thành phố Bến Tre"}},13:{name:"Tỉnh Bình Định",districts:{216:"Huyện An Lão",217:"Huyện An Nhơn",218:"Huyện Hoài  Ân",219:"Huyện Hoài Nhơn",220:"Huyện Phù Mỹ",221:"Huyện Phù cát",222:"Huyện Tây Sơn",223:"Huyện Tuy Phước",224:"Huyện Vân Canh",225:"Huyện Vĩnh Thạnh",226:"Thành phố Quy Nhơn"}},14:{name:"Tỉnh Bình Dương",districts:{227:"Huyện Bến Cát",228:"Huyện Dầu Tiếng",229:"Huyện Dĩ An",230:"Huyện Phú Giáo",231:"Huyện Tân Uyên",232:"Huyện Thuận An",233:"Thị xã Thủ Dầu Một"}},15:{name:"Tỉnh Bình Phước",districts:{234:"Huyện Bù Đăng",235:"Huyện Bù Đốp",236:"Huyện Bù Gia Mập",237:"Huyện Chơn Thành",238:"Huyện Đồng Phú",239:"Huyện Hớn Quản",240:"Huyện Lộc Ninh",241:"Thị xã Bình Long",242:"Thị xã Đồng Xoài",243:"Thị xã Phước Long"}},16:{name:"Tỉnh Bình Thuận",districts:{244:"Huyện  Đức Linh",245:"Huyện Bắc Bình",246:"Huyện Hàm Tân",247:"Huyện Hàm Thuận Bắc",248:"Huyện Hàm Thuận Nam",249:"Huyện Phú Qúi",250:"Huyện Tánh Linh",251:"Huyện Tuy Phong",252:"Thành phố Phan Thiết",253:"Thị xã La Gi"}},17:{name:"Tỉnh Cà Mau",districts:{254:"Huyện Cái Nước",255:"Huyện Đầm Dơi",256:"Huyện Năm Căn",257:"Huyện Ngọc Hiển",258:"Huyện Phú Tân",259:"Huyện Thới Bình",260:"Huyện Trần Văn Thời",261:"Huyện U Minh",262:"Thành phố Cà Mau"}},18:{name:"Tỉnh Cao Bằng",districts:{263:"Huyện Bảo Lạc",264:"Huyện Bảo Lâm",265:"Huyện Hạ Lang",266:"Huyện Hà Quảng",267:"Huyện Hòa An",268:"Huyện Nguyên Bình",269:"Huyện Phục Hòa",270:"Huyện Quảng Uyên",271:"Huyện Thạch An",272:"Huyện Thông Nông",273:"Huyện Trà Lĩnh",274:"Huyện Trùng Khánh",275:"Thị xã Cao Bằng"}},19:{name:"Tỉnh Đắk Lắk",districts:{276:"Huyện Buôn Đôn",277:"Huyện Cư Kuin",278:"Huyện Cư MGar",279:"Huyện Ea Kar",280:"Huyện Ea Súp",281:"Huyện EaHLeo",282:"Huyện Krông Ana",283:"Huyện Krông Bông",284:"Huyện Krông Búk",285:"Huyện Krông Năng",286:"Huyện Krông Pắc",287:"Huyện Lắk",288:"Huyện MDrắk",289:"Thành phố Buôn Ma Thuột",290:"Thị xã Buôn Hồ"}},20:{name:"Tỉnh Đắk Nông",districts:{291:"Huyện Cư Jút",292:"Huyện Đắk GLong",293:"Huyện Đắk Mil",294:"Huyện Đắk RLấp",295:"Huyện Đắk Song",296:"Huyện KRông Nô",297:"Huyện Tuy Đức",298:"Thị xã Gia Nghĩa"}},21:{name:"Tỉnh Điện Biên",districts:{299:"Huyện Điện Biên",300:"Huyện Điện Biên Đông",301:"Huyện Mường Chà",302:"Huyện Mương Nhé",303:"Huyện Mường ảng",304:"Huyện Tủa Chùa",305:"Huyện Tuần Giáo",306:"Thành phố Điện Biên phủ",307:"Thị xã Mường Lay"}},22:{name:"Tỉnh Đồng Nai",districts:{308:"Huyện Cẩm Mỹ",309:"Huyện Định Quán",310:"Huyện Long Thành",311:"Huyện Nhơn Trạch",312:"Huyện Tân Phú",313:"Huyện Thống Nhất",314:"Huyện Trảng Bom",315:"Huyện Vĩnh Cửu",316:"Huyện Xuân Lộc",317:"Thành phố Biên Hòa",318:"Thị xã Long Khánh"}},23:{name:"Tỉnh Đồng Tháp",districts:{319:"Huyện Cao Lãnh",320:"Huyện Châu Thành",321:"Huyện Hồng Ngự",322:"Huyện Lai Vung",323:"Huyện Lấp Vò",324:"Huyện Tam Nông",325:"Huyện Tân Hồng",326:"Huyện Thanh Bình",327:"Huyện Tháp Mười",328:"Thành phố Cao Lãnh",329:"Thị xã Hồng Ngự",330:"Thị xã Sa Đéc"}},24:{name:"Tỉnh Gia Lai",districts:{331:"Huyện Chư Păh",332:"Huyện Chư Pưh",333:"Huyện Chư Sê",334:"Huyện ChưPRông",335:"Huyện Đăk Đoa",336:"Huyện Đăk Pơ",337:"Huyện Đức Cơ",338:"Huyện Ia Grai",339:"Huyện Ia Pa",340:"Huyện KBang",341:"Huyện KBang",342:"Huyện Kông Chro",343:"Huyện Krông Pa",344:"Huyện Mang Yang",345:"Huyện Phú Thiện",346:"Thành phố Plei Ku",347:"Thị xã AYun Pa",348:"Thị xã An Khê"}},25:{name:"Tỉnh Hà Giang",districts:{349:"Huyện Bắc Mê",350:"Huyện Bắc Quang",351:"Huyện Đồng Văn",352:"Huyện Hoàng Su Phì",353:"Huyện Mèo Vạc",354:"Huyện Quản Bạ",355:"Huyện Quang Bình",356:"Huyện Vị Xuyên",357:"Huyện Xín Mần",358:"Huyện Yên Minh",359:"Thành Phố Hà Giang"}},26:{name:"Tỉnh Hà Nam",districts:{360:"Huyện Bình Lục",361:"Huyện Duy Tiên",362:"Huyện Kim Bảng",363:"Huyện Lý Nhân",364:"Huyện Thanh Liêm",365:"Thành phố Phủ Lý"}},27:{name:"Tỉnh Hà Tĩnh",districts:{366:"Huyện Cẩm Xuyên",367:"Huyện Can Lộc",368:"Huyện Đức Thọ",369:"Huyện Hương Khê",370:"Huyện Hương Sơn",371:"Huyện Kỳ Anh",372:"Huyện Lộc Hà",373:"Huyện Nghi Xuân",374:"Huyện Thạch Hà",375:"Huyện Vũ Quang",376:"Thành phố Hà Tĩnh",377:"Thị xã Hồng Lĩnh"}},28:{name:"Tỉnh Hải Dương",districts:{378:"Huyện Bình Giang",379:"Huyện Cẩm Giàng",380:"Huyện Gia Lộc",381:"Huyện Kim Thành",382:"Huyện Kinh Môn",383:"Huyện Nam Sách",384:"Huyện Ninh Giang",385:"Huyện Thanh Hà",386:"Huyện Thanh Miện",387:"Huyện Tứ Kỳ",388:"Thành phố Hải Dương",389:"Thị xã Chí Linh"}},29:{name:"Tỉnh Hậu Giang",districts:{390:"Huyện Châu Thành",391:"Huyện Châu Thành A",392:"Huyện Long Mỹ",393:"Huyện Phụng Hiệp",394:"Huyện Vị Thủy",395:"Thành Phố Vị Thanh",396:"Thị xã Ngã Bảy"}},30:{name:"Tỉnh Hòa Bình",districts:{397:"Huyện Cao Phong",398:"Huyện Đà Bắc",399:"Huyện Kim Bôi",400:"Huyện Kỳ Sơn",401:"Huyện Lạc Sơn",402:"Huyện Lạc Thủy",403:"Huyện Lương Sơn",404:"Huyện Mai Châu",405:"Huyện Tân Lạc",406:"Huyện Yên Thủy",407:"Thành phố Hòa Bình"}},31:{name:"Tỉnh Hưng Yên",districts:{408:"Huyện Ân Thi",409:"Huyện Khoái Châu",410:"Huyện Kim Động",411:"Huyện Mỹ Hào",412:"Huyện Phù Cừ",413:"Huyện Tiên Lữ",414:"Huyện Văn Giang",415:"Huyện Văn Lâm",416:"Huyện Yên Mỹ",417:"Thành phố Hưng Yên"}},32:{name:"Tỉnh Khánh Hòa",districts:{418:"Huyện Cam Lâm",419:"Huyện Diên Khánh",420:"Huyện Khánh Sơn",421:"Huyện Khánh Vĩnh",422:"Huyện Ninh Hòa",423:"Huyện Trường Sa",424:"Huyện Vạn Ninh",425:"Thành phố Nha Trang",426:"Thị xã Cam Ranh"}},33:{name:"Tỉnh Kiên Giang",districts:{427:"Huyện An Biên",428:"Huyện An Minh",429:"Huyện Châu Thành",430:"Huyện Giang Thành",431:"Huyện Giồng Riềng",432:"Huyện Gò Quao",433:"Huyện Hòn Đất",434:"Huyện Kiên Hải",435:"Huyện Kiên Lương",436:"Huyện Phú Quốc",437:"Huyện Tân Hiệp",438:"Huyện U Minh Thượng",439:"Huyện Vĩnh Thuận",440:"Thành phố Rạch Giá",441:"Thị xã Hà Tiên"}},34:{name:"Tỉnh Kon Tum",districts:{442:"Huyện Đắk Glei",443:"Huyện Đắk Hà",444:"Huyện Đắk Tô",445:"Huyện Kon Plông",446:"Huyện Kon Rẫy",447:"Huyện Ngọc Hồi",448:"Huyện Sa Thầy",449:"Huyện Tu Mơ Rông",450:"Thành phố Kon Tum"}},35:{name:"Tỉnh Lai Châu",districts:{451:"Huyện Mường Tè",452:"Huyện Phong Thổ",453:"Huyện Sìn Hồ",454:"Huyện Tam Đường",455:"Huyện Tân Uyên",456:"Huyện Than Uyên",457:"Thị xã Lai Châu"}},36:{name:"Tỉnh Lâm Đồng",districts:{458:"Huyện Bảo Lâm",459:"Huyện Cát Tiên",460:"Huyện Đạ Huoai",461:"Huyện Đạ Tẻh",462:"Huyện Đam Rông",463:"Huyện Di Linh",464:"Huyện Đơn Dương",465:"Huyện Đức Trọng",466:"Huyện Lạc Dương",467:"Huyện Lâm Hà",468:"Thành phố Bảo Lộc",469:"Thành phố Đà Lạt"}},37:{name:"Tỉnh Lạng Sơn",districts:{470:"Huyện Bắc Sơn",471:"Huyện Bình Gia",472:"Huyện Cao Lộc",473:"Huyện Chi Lăng",474:"Huyện Đình Lập",475:"Huyện Hữu Lũng",476:"Huyện Lộc Bình",477:"Huyện Tràng Định",478:"Huyện Văn Lãng",479:"Huyện Văn Quan",480:"Thành phố Lạng Sơn"}},38:{name:"Tỉnh Lào Cai",districts:{481:"Huyện Bắc Hà",482:"Huyện Bảo Thắng",483:"Huyện Bảo Yên",484:"Huyện Bát Xát",485:"Huyện Mường Khương",486:"Huyện Sa Pa",487:"Huyện Si Ma Cai",488:"Huyện Văn Bàn",489:"Thành phố Lào Cai"}},39:{name:"Tỉnh Long An",districts:{490:"Huyện Bến Lức",491:"Huyện Cần Đước",492:"Huyện Cần Giuộc",493:"Huyện Châu Thành",494:"Huyện Đức Hòa",495:"Huyện Đức Huệ",496:"Huyện Mộc Hóa",497:"Huyện Tân Hưng",498:"Huyện Tân Thạnh",499:"Huyện Tân Trụ",500:"Huyện Thạnh Hóa",501:"Huyện Thủ Thừa",502:"Huyện Vĩnh Hưng",503:"Thành phố Tân An"}},40:{name:"Tỉnh Nam Định",districts:{504:"Huyện Giao Thủy",505:"Huyện Hải Hậu",506:"Huyện Mỹ Lộc",507:"Huyện Nam Trực",508:"Huyện Nghĩa Hưng",509:"Huyện Trực Ninh",510:"Huyện Vụ Bản",511:"Huyện Xuân Trường",512:"Huyện ý Yên",513:"Thành phố Nam Định"}},41:{name:"Tỉnh Nghệ An",districts:{514:"Huyện Anh Sơn",515:"Huyện Con Cuông",516:"Huyện Diễn Châu",517:"Huyện Đô Lương",518:"Huyện Hưng Nguyên",519:"Huyện Kỳ Sơn",520:"Huyện Nam Đàn",521:"Huyện Nghi Lộc",522:"Huyện Nghĩa Đàn",523:"Huyện Quế Phong",524:"Huyện Quỳ Châu",525:"Huyện Quỳ Hợp",526:"Huyện Quỳnh Lưu",527:"Huyện Tân Kỳ",528:"Huyện Thanh Chương",529:"Huyện Tương Dương",530:"Huyện Yên Thành",531:"Thành phố Vinh",532:"Thị xã Cửa Lò",533:"Thị xã Thái Hòa"}},42:{name:"Tỉnh Ninh Bình",districts:{534:"Huyện Gia Viễn",535:"Huyện Hoa Lư",536:"Huyện Kim Sơn",537:"Huyện Nho Quan",538:"Huyện Yên Khánh",539:"Huyện Yên Mô",540:"Thành phố Ninh Bình",541:"Thị xã Tam Điệp"}},43:{name:"Tỉnh Ninh Thuận",districts:{542:"Huyên Bác ái",543:"Huyện Ninh Hải",544:"Huyện Ninh Phước",545:"Huyện Ninh Sơn",546:"Huyện Thuận Bắc",547:"Huyện Thuận Nam",548:"Thành phố Phan Rang-Tháp Chàm"}},44:{name:"Tỉnh Phú Thọ",districts:{549:"Huyện Cẩm Khê",550:"Huyện Đoan Hùng",551:"Huyện Hạ Hòa",552:"Huyện Lâm Thao",553:"Huyện Phù Ninh",554:"Huyện Tam Nông",555:"Huyện Tân Sơn",556:"Huyện Thanh Ba",557:"Huyện Thanh Sơn",558:"Huyện Thanh Thủy",559:"Huyện Yên Lập",560:"Thành phố Việt Trì",561:"Thị xã Phú Thọ"}},45:{name:"Tỉnh Phú Yên",districts:{562:"Huyện Đông Hòa",563:"Huyện Đồng Xuân",564:"Huyện Phú Hòa",565:"Huyện Sơn Hòa",566:"Huyện Sông Hinh",567:"Huyện Tây Hòa",568:"Huyện Tuy An",569:"Thành phố Tuy Hòa",570:"Thị xã Sông Cầu"}},46:{name:"Tỉnh Quảng Bình",districts:{571:"Huyện Bố Trạch",572:"Huyện Lệ Thủy",573:"Huyện MinhHoá",574:"Huyện Quảng Ninh",575:"Huyện Quảng Trạch",576:"Huyện Tuyên Hoá",577:"Thành phố Đồng Hới"}},47:{name:"Tỉnh Quảng Nam",districts:{578:"Huyện Bắc Trà My",579:"Huyện Đại Lộc",580:"Huyện Điện Bàn",581:"Huyện Đông Giang",582:"Huyện Duy Xuyên",583:"Huyện Hiệp Đức",584:"Huyện Nam Giang",585:"Huyện Nam Trà My",586:"Huyện Nông Sơn",587:"Huyện Núi Thành",588:"Huyện Phú Ninh",589:"Huyện Phước Sơn",590:"Huyện Quế Sơn",591:"Huyện Tây Giang",592:"Huyện Thăng Bình",593:"Huyện Tiên Phước",594:"Thành phố Hội An",595:"Thành phố Tam Kỳ"}},48:{name:"Tỉnh Quảng Ngãi",districts:{596:"Huyện Ba Tơ",597:"Huyện Bình Sơn",598:"Huyện Đức Phổ",599:"Huyện Lý sơn",600:"Huyện Minh Long",601:"Huyện Mộ Đức",602:"Huyện Nghĩa Hành",603:"Huyện Sơn Hà",604:"Huyện Sơn Tây",605:"Huyện Sơn Tịnh",606:"Huyện Tây Trà",607:"Huyện Trà Bồng",608:"Huyện Tư Nghĩa",609:"Thành phố Quảng Ngãi"}},49:{name:"Tỉnh Quảng Ninh",districts:{610:"Huyện Ba Chẽ",611:"Huyện Bình Liêu",612:"Huyện Cô Tô",613:"Huyện Đầm Hà",614:"Huyện Đông Triều",615:"Huyện Hải Hà",616:"Huyện Hoành Bồ",617:"Huyện Tiên Yên",618:"Huyện Vân Đồn",619:"Huyện Yên Hưng",620:"Thành phố Hạ Long",621:"Thành phố Móng Cái",622:"Thị xã Cẩm Phả",623:"Thị xã Uông Bí"}},50:{name:"Tỉnh Quảng Trị",districts:{624:"Huyện Cam Lộ",625:"Huyện Cồn Cỏ",626:"Huyện Đa Krông",627:"Huyện Gio Linh",628:"Huyện Hải Lăng",629:"Huyện Hướng Hóa",630:"Huyện Triệu Phong",631:"Huyện Vính Linh",632:"Thành phố Đông Hà",633:"Thị xã Quảng Trị"}},51:{name:"Tỉnh Sóc Trăng",districts:{634:"Huyện Châu Thành",635:"Huyện Cù Lao Dung",636:"Huyện Kế Sách",637:"Huyện Long Phú",638:"Huyện Mỹ Tú",639:"Huyện Mỹ Xuyên",640:"Huyện Ngã Năm",641:"Huyện Thạnh Trị",642:"Huyện Trần Đề",643:"Huyện Vĩnh Châu",644:"Thành phố Sóc Trăng"}},52:{name:"Tỉnh Sơn La",districts:{645:"Huyện Bắc Yên",646:"Huyện Mai Sơn",647:"Huyện Mộc Châu",648:"Huyện Mường La",649:"Huyện Phù Yên",650:"Huyện Quỳnh Nhai",651:"Huyện Sông Mã",652:"Huyện Sốp Cộp",653:"Huyện Thuận Châu",654:"Huyện Yên Châu",655:"Thành phố Sơn La"}},53:{name:"Tỉnh Tây Ninh",districts:{656:"Huyện Bến Cầu",657:"Huyện Châu Thành",658:"Huyện Dương Minh Châu",659:"Huyện Gò Dầu",660:"Huyện Hòa Thành",661:"Huyện Tân Biên",662:"Huyện Tân Châu",663:"Huyện Trảng Bàng",664:"Thị xã Tây Ninh"}},54:{name:"Tỉnh Thái Bình",districts:{665:"Huyện Đông Hưng",666:"Huyện Hưng Hà",667:"Huyện Kiến Xương",668:"Huyện Quỳnh Phụ",669:"Huyện Thái Thụy",670:"Huyện Tiền Hải",671:"Huyện Vũ Thư",672:"Thành phố Thái Bình"}},55:{name:"Tỉnh Thái Nguyên",districts:{673:"Huyện Đại Từ",674:"Huyện Định Hóa",675:"Huyện Đồng Hỷ",676:"Huyện Phổ Yên",677:"Huyện Phú Bình",678:"Huyện Phú Lương",679:"Huyện Võ Nhai",680:"Thành phố Thái Nguyên",681:"Thị xã Sông Công"}},56:{name:"Tỉnh Thanh Hóa",districts:{682:"Huyện Bá Thước",683:"Huyện Cẩm Thủy",684:"Huyện Đông Sơn",685:"Huyện Hà Trung",686:"Huyện Hậu Lộc",687:"Huyện Hoằng Hóa",688:"Huyện Lang Chánh",689:"Huyện Mường Lát",690:"Huyện Nga Sơn",691:"Huyện Ngọc Lặc",692:"Huyện Như Thanh",693:"Huyện Như Xuân",694:"Huyện Nông Cống",695:"Huyện Quan Hóa",696:"Huyện Quan Sơn",697:"Huyện Quảng Xương",698:"Huyện Thạch Thành",699:"Huyện Thiệu Hóa",700:"Huyện Thọ Xuân",701:"Huyện Thường Xuân",702:"Huyện Tĩnh Gia",703:"Huyện Triệu Sơn",704:"Huyện Vĩnh Lộc",705:"Huyện Yên Định",706:"Thành phố Thanh Hóa",707:"Thị xã Bỉm Sơn",708:"Thị xã Sầm Sơn"}},57:{name:"Tỉnh Thừa Thiên Huế",districts:{709:"Huyện A Lưới",710:"Huyện Hương Trà",711:"Huyện Nam Dông",712:"Huyện Phong Điền",713:"Huyện Phú Lộc",714:"Huyện Phú Vang",715:"Huyện Quảng Điền",716:"Thành phố Huế",717:"thị xã Hương Thủy"}},58:{name:"Tỉnh Tiền Giang",districts:{718:"Huyện Cái Bè",719:"Huyện Cai Lậy",720:"Huyện Châu Thành",721:"Huyện Chợ Gạo",722:"Huyện Gò Công Đông",723:"Huyện Gò Công Tây",724:"Huyện Tân Phú Đông",725:"Huyện Tân Phước",726:"Thành phố Mỹ Tho",727:"Thị xã Gò Công"}},59:{name:"Tỉnh Trà Vinh",districts:{728:"Huyện Càng Long",729:"Huyện Cầu Kè",730:"Huyện Cầu Ngang",731:"Huyện Châu Thành",732:"Huyện Duyên Hải",733:"Huyện Tiểu Cần",734:"Huyện Trà Cú",735:"Thành phố Trà Vinh"}},60:{name:"Tỉnh Tuyên Quang",districts:{736:"Huyện Chiêm Hóa",737:"Huyện Hàm Yên",738:"Huyện Na hang",739:"Huyện Sơn Dương",740:"Huyện Yên Sơn",741:"Thành phố Tuyên Quang"}},61:{name:"Tỉnh Vĩnh Long",districts:{742:"Huyện Bình Minh",743:"Huyện Bình Tân",744:"Huyện Long Hồ",745:"Huyện Mang Thít",746:"Huyện Tam Bình",747:"Huyện Trà Ôn",748:"Huyện Vũng Liêm",749:"Thành phố Vĩnh Long"}},62:{name:"Tỉnh Vĩnh Phúc",districts:{750:"Huyện Bình Xuyên",751:"Huyện Lập Thạch",752:"Huyện Sông Lô",753:"Huyện Tam Đảo",754:"Huyện Tam Dương",755:"Huyện Vĩnh Tường",756:"Huyện Yên Lạc",757:"Thành phố Vĩnh Yên",758:"Thị xã Phúc Yên"}},63:{name:"Tỉnh Yên Bái",districts:{759:"Huyện Lục Yên",760:"Huyện Mù Cang Chải",761:"Huyện Trạm Tấu",762:"Huyện Trấn Yên",763:"Huyện Văn Chấn",764:"Huyện Văn Yên",765:"Huyện Yên Bình",766:"Thành phố Yên Bái",767:"Thị xã Nghĩa Lộ"}}}])}(),function(){function e(e,t){t.theme="bs3"}e.$inject=["authSvc","editableOptions"],Application.registerModule("bzUser"),angular.module("bzUser",["xeditable"]).run(e)}(),function(){function e(){}Application.registerModule("bzUnit"),angular.module("bzUnit",[]).run(e)}(),function(){function e(){}Application.registerModule("bzTest"),angular.module("bzTest",[]).run(e)}(),function(){function e(){}Application.registerModule("bzSupplier"),angular.module("bzSupplier",[]).run(e)}(),function(){function e(e){e.theme="bs3"}e.$inject=["editableOptions"],Application.registerModule("bzTag"),angular.module("bzTag",["xeditable"]).run(e)}(),function(){function e(){}Application.registerModule("bzShippingFee"),angular.module("bzShippingFee",[]).run(e)}(),function(){function e(){}Application.registerModule("bzSearch"),angular.module("bzSearch",[]).run(e)}(),function(){function e(){}Application.registerModule("bzReport"),angular.module("bzReport",[]).run(e)}(),function(){function e(){}
Application.registerModule("bzPromotion"),angular.module("bzPromotion",[]).run(e)}(),function(){function e(){}Application.registerModule("bzProduct"),angular.module("bzProduct",[]).run(e)}(),function(){function e(){}Application.registerModule("bzOrder"),angular.module("bzOrder",[]).run(e)}(),function(){function e(){}Application.registerModule("bzAuditLog"),angular.module("bzAuditLog",[]).run(e)}(),function(){function e(){}Application.registerModule("bzImportProduct"),angular.module("bzImportProduct",[]).run(e)}(),function(){function e(e){}e.$inject=["authSvc"],Application.registerModule("bzDashboard"),angular.module("bzDashboard",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCoupon"),angular.module("bzCoupon",[]).run(e)}(),function(){function e(){}Application.registerModule("bzConfig"),angular.module("bzConfig",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCertificate"),angular.module("bzCertificate",[]).run(e)}(),function(){function e(){}Application.registerModule("bzCategory"),angular.module("bzCategory",["angular-speakingurl"]).run(e)}(),function(){function e(){}Application.registerModule("bzBlog"),angular.module("bzBlog",[]).constant("CKEditorOptBlog",{imageUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/image-upload?type=blog_image&prefix=blog_image",filebrowserUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/file-browser-upload?type=blog_image&prefix=blog_image",removePlugins:"about,bidi,flash,horizontalrule,language,save,specialchar"}).run(e)}(),function(){function e(){}Application.registerModule("bzBanner"),angular.module("bzBanner",[]).run(e)}(),function(){function e(){}Application.registerModule("bzPermission"),angular.module("bzPermission",["angular-speakingurl"]).run(e)}(),function(){function e(e){}e.$inject=["authSvc"],Application.registerModule("bzAuth"),angular.module("bzAuth",[]).run(e)}(),function(){angular.module("bzUser").constant("userRoles",[{name:"Super Admin",value:"super-admin"},{name:"Admin",value:"admin"},{name:"User",value:"user"},{name:"Customer",value:"customer"}])}(),function(){Application.registerModule("bzTag"),angular.module("bzTag",[]).constant("listTagTypeBlog",[{name:"Góc bếp",value:"GB"},{name:"Mẹo vặt",value:"MV"},{name:"Tin tức",value:"TT"}])}(),function(){Application.registerModule("bzProduct"),angular.module("bzProduct",[]).constant("CKEditorOptPro",{imageUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/image-upload?type=product_image&prefix=product_image",filebrowserUploadUrl:settings.services.uploadApi+"/upload/for-ckeditor/file-browser-upload?type=product_image&prefix=product_image",removePlugins:"about,bidi,blockquote,div,flash,horizontalrule,language,pagebreak,save,smiley,sourcearea,specialchar"}).constant("statusProduct",[{value:"HH",name:"Hết hàng"},{value:"HSV",name:"Hàng sắp về"},{value:"CH",name:"Còn hàng"}])}(),function(){Application.registerModule("bzOrder"),angular.module("bzOrder",[]).constant("statusOrderList",[{value:"PROCCESS",name:"Đang xử lý",group:"",bgColor:"#6d90f5"},{value:"FINISH",name:"Hoàn thành",group:"",bgColor:"#0dd077"},{value:"CANCEL",name:"Đã hủy",group:"",bgColor:"#ed7a7c",showPopup:!0}]).constant("shipperList",[{value:"MHV",name:"Mua Hàng Việt",group:""},{value:"SPT",name:"SPT",group:""},{value:"AHM",name:"Ahamove",group:""},{value:"GHN",name:"GHN",group:""}]).constant("listVocative",[{name:"Anh",value:"Anh"},{name:"Chị",value:"Chị"},{name:"Cô",value:"Cô"},{name:"Chú",value:"Chú"},{name:"Bác",value:"Bác"},{name:"Ông",value:"Ông"},{name:"Bà",value:"Bà"}])}(),function(){Application.registerModule("bzPermisstion"),angular.module("bzPermisstion",[]).constant("listResource",["dashboard","blog","product","user","promotion","order","unit","supplier","category","shipping","tag","coupon","config","certificate","import_product","search","banner","acl","log"]).constant("listAction",[{name:"Xem",value:"view"},{name:"Thêm",value:"add"},{name:"Sửa",value:"edit"},{name:"Xoá",value:"delete"},{name:"Trích xuất",value:"export"}])}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"user"})}function a(e,t){var n=new r(e);return n.$update({method:"user",id:t})}function i(){var e=new r;return e.$get({method:"roles"})}return{create:o,update:a,getRoles:i}}t.$inject=["$q","$window","bzResourceSvc","userFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzUser").service("userSvc",t).factory("userFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"unit"})}function a(e,t){var n=new r(e);return n.$update({method:"unit",id:t})}function i(e){var t=new r(e);return t.$get({method:"unit"})}function s(e){var t=new r;return t.$get({method:"unit",id:e})}return{create:o,update:a,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","unitFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzUnit").service("unitSvc",t).factory("unitFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){return t.api(e.settings.services.apiUrl+"/:method/:id",{method:"@method",id:"@id"})}function n(e,t,n,r,o){function a(e){var t=new r(e);return t.$save({method:"resize-img"})}function i(e){var t=new o(e);return t.$save({method:"upload",id:"base64"})}return{resize:a,uploadBase64:i}}n.$inject=["$q","$window","bzResourceSvc","testFac","testApiFac"],e.$inject=["$window","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],angular.module("bzTest").service("testSvc",n).factory("testFac",e).factory("testApiFac",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"supplier"})}function a(e,t){var n=new r(e);return n.$update({method:"supplier",id:t})}function i(e){var t=new r(e);return t.$get({method:"supplier"})}function s(e){var t=new r;return t.$get({method:"supplier",id:e})}return{create:o,update:a,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","supplierFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSupplier").service("supplierSvc",t).factory("supplierFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id/:type/:expire",{method:"@method",id:"@id",type:"@type",expire:"@expire"})}function t(e,t){function n(){var e=new t;return e.$get({method:"tag"})}function r(e){var n=new t;return n.$get({method:"tag",id:e,type:""})}function o(e){var n=new t(e);return n.$save({method:"tag",type:""})}function a(e,n){var r=new t(e);return r.$update({method:"tag",id:n,type:""})}function i(e){var n=new t;return n.$get({method:"product",id:e})}function s(e,n){var r=new t;return r.$get({method:"listProduct",id:e,type:n})}function u(e,n,r){var o=new t;return o.$get({method:"tagProduct",id:e,type:n,expire:r})}return{getAll:n,get:r,create:o,update:a,getProductById:i,getListProduct:s,getProductByTag:u}}e.$inject=["bzResourceSvc"],t.$inject=["$q","tagFac"],angular.module("bzTag").factory("tagFac",e).service("tagSvc",t)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(){var e=new t;return e.$get({method:"shippingfee"})}function r(){var e=new t;return e.$get({method:"all-shippingfee"})}function o(){var e=new t;return e.$get({method:"all-shippingfee-config"})}function r(){var e=new t;return e.$get({method:"all-shippingfee"})}function a(e){var n=new t;return n.$get({method:"shippingfee",id:e})}function i(e){var n=new t(e);return n.$save({method:"shippingfee"})}function s(e,n){var r=new t(e);return r.$update({method:"shippingfee",id:n})}return{getAll:n,getShippingFeeDefault:o,getAllNoPaging:r,get:a,create:i,update:s}}e.$inject=["bzResourceSvc"],t.$inject=["$q","shippingfeeFac"],angular.module("bzShippingFee").factory("shippingfeeFac",e).service("shippingfeeSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){e.method="search";var t=new r;return t.$get(e)}function a(e){var t=new r(e);return t.$save({method:"search"})}function i(e){var t=new r;return t.$get({method:"search",id:e})}function s(e,t){var n=new r(e);return n.$save({method:"search",id:t})}function u(e){var t=new r;return t.$delete({method:"search",id:e})}function c(e){var t=new r;return t.$get({method:"search-active",id:e})}return{getAll:o,create:a,active:c,edit:i,update:s,del:u}}t.$inject=["$q","$window","bzResourceSvc","searchFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSearch").service("searchSvc",t).service("searchFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r,o){function a(e){e.method="report-product-order";var t=new r;return t.$get(e)}function i(e){e.method="report-product-a-day";var t=new r;return t.$get(e)}return{reportProductOrder:a,reportProductADay:i}}t.$inject=["$q","$window","bzResourceSvc","reportFac","apiFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzProduct").service("reportSvc",t).service("reportFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(e){e.method="promotion";var n=new t;return n.$get(e)}function r(e){var n=new t(e);return n.$get({method:"promotion-add"})}function o(e){var n=new t(e);return n.$save({method:"promotion"})}function a(e){var n=new t;return n.$get({method:"promotion",id:e})}function i(e,n){var r=new t(e);return r.$save({method:"promotion",id:n})}function s(e){var n=new t;return n.$delete({method:"promotion",id:e})}return{getAll:n,add:r,create:o,edit:a,update:i,"delete":s}}e.$inject=["bzResourceSvc"],t.$inject=["$q","promotionFac"],angular.module("bzPromotion").factory("promotionFac",e).service("promotionSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){return t.api(e.settings.services.apiUrl+"/:method/:id",{method:"@method",id:"@id"})}function n(e,t,n,r,o){function a(e){e.method="product";var t=new r;return t.$get(e)}function i(e){var t=new r;return t.$get({method:"product",id:e})}function s(e){var t=new r(e);return t.$get({method:"product-add"})}function u(e){var t=new r(e);return t.$save({method:"product"})}function c(e,t){var n=new r(e);return n.$save({method:"product",id:t})}function l(e){var t=new r;return t.$delete({method:"product",id:e})}function d(e){var t=new r;return t.$save({method:"product-active",id:e})}function p(e){var t=new r;return t.$get({method:"product-edit",id:e})}function m(e){var t=new r;return t.$get({method:"product-edit",id:e})}function g(e){var t=new r(e);return t.$save({method:"product-tag"})}function h(e){var t=new o(e);return t.$save({method:"upload",id:"base64"})}function f(e){return e.indexOf("watch?v=")!=-1&&(e=e.replace("watch?v=","embed/")),e.indexOf("&")!=-1&&(e=e.split("&")[0]),e}function v(e){var t=e.split("."),n=t[0].split("_");n.pop();var r=n.join("_")+"."+t[1];return r}function y(e){var t=e.split(".");return t[0]+"_248x248."+t[1]}function b(e){var t=new r(e);return t.$save({method:"test-resize"})}function P(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;|_/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-"),t="@"+t+"@",t=t.replace(/\@\-|\-\@|\@/gi,"")}return e}function T(e,t){if(t){var n=t.split("/");if(n.length>1){var r=settingJs.configs.uploadDirectory.media_old_product.slice(0,-1);return r+t}}return e+t}function $(e){var t=new RegExp('{{media url="',"g"),n=new RegExp('"}}',"g"),r=new RegExp("//mhv-live.bizzon.com.vn","g");return e.replace(t,settings.services.webUrl+settingJs.configs.uploadDirectory.media_old).replace(n,"").replace(r,settings.services.webUrl)}function C(e){return e.parent_category?C(e.parent_category):e}return{getAll:a,get:i,add:s,create:u,updateProduct:c,deleteProduct:l,activeProduct:d,getProductBySlug:p,updateTag:g,getProductByID:m,formatYoutube:f,uploadBase64:h,thumbToImage:v,imageToThumb:y,testResize:b,changeToSlug:P,checkImgOld:T,fixImgProductDetail:$,getCategoryParent:C}}n.$inject=["$q","$window","bzResourceSvc","productFac","apiFac"],e.$inject=["$window","bzResourceSvc"],t.$inject=["$window","bzResourceSvc"],angular.module("bzProduct").service("productSvc",n).service("productFac",e).service("apiFac",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){e.method="order";var t=new r;return t.$get(e)}function a(){var e=new r;return e.$get({method:"order-add"})}function i(e){var e=new r(e);return e.$save({method:"order"})}function s(e){var t=new r;return t.$get({method:"order",id:e})}function u(e,t){var n=new r(e);return n.$save({method:"order",id:t})}function c(e){var t=new r;return t.$delete({method:"order",id:e})}function l(e){return e.toFixed().replace(/./g,function(e,t,n){return t>0&&"."!==e&&(n.length-t)%3===0?"."+e:e})}function d(e,t){var n=new r(e);return n.$save({method:"check-coupon",id:t})}function p(e){var t=new r;return t.$get({method:"is-first-order",id:e})}return{getAll:o,add:a,create:i,edit:s,update:u,"delete":c,checkCoupon:d,formatCurrency:l,isFirstOrder:p}}t.$inject=["$q","$window","bzResourceSvc","orderFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzOrder").service("orderSvc",t).service("orderFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){e.method="log";var t=new r;return t.$get(e)}function a(e){e||(e={}),e.method="log-users";var t=new r;return t.$get(e)}return{getLog:o,getUsers:a}}t.$inject=["$q","$window","bzResourceSvc","auditLogFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzAuditLog").service("auditLogSvc",t).factory("auditLogFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){e.method="import-product";var t=new r(e);return t.$get(e)}function a(){var e=new r;return e.$get({method:"import-product-add"})}function i(e){var t=new r(e);return t.$save({method:"import-product"})}function s(e){var t=new r;return t.$get({method:"import-product",id:e})}function u(e,t){var n=new r(e);return n.$save({method:"import-product",id:t})}function c(e){var t=new r;return t.$delete({method:"import-product",id:e})}return{getAll:o,getDataImport:a,importProduct:i,edit:s,update:u,del:c}}t.$inject=["$q","$window","bzResourceSvc","importProductFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzImportProduct").service("importProductSvc",t).service("importProductFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(e,n){e.method="coupon",e.type=n;var r=new t;return r.$get(e)}function r(e){var n=new t;return n.$get({method:"coupon",id:e})}function o(e){var n=new t(e);return n.$save({method:"coupon"})}function a(e,n){var r=new t(e);return r.$update({method:"coupon",id:n})}function i(e){var n=new t;return n.$get({method:"coupon-code",id:e})}function s(e,n){var r={method:"coupon",id:"check-coupon"};n&&(r.coupon_id=n);var o=new t(e);return o.$save(r)}return{getAll:n,get:r,create:o,update:a,getByCode:i,checkIsset:s}}e.$inject=["bzResourceSvc"],t.$inject=["$q","couponFac"],angular.module("bzCoupon").factory("couponFac",e).service("couponSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"config"})}function a(e,t){var n=new r(e);return n.$update({method:"config",id:t})}function i(e){var t=new r(e);return t.$get({method:"config"})}function s(e){var t=new r;return t.$get({method:"config",id:e})}return{create:o,update:a,getAll:i,get:s}}t.$inject=["$q","$window","bzResourceSvc","configFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzSupplier").service("configSvc",t).factory("configFac",e)}(),function(){function e(e){return e.api(settingJs.configs.adminUrl+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t){function n(){var e=new t;return e.$get({method:"certificate"})}function r(e){var n=new t;return n.$get({method:"certificate",id:e})}function o(e){var n=new t(e);return n.$save({method:"certificate"})}function a(e,n){var r=new t(e);return r.$update({method:"certificate",id:n})}function i(e,n){var r=new t(e);return r.$get({method:"certificate-product",id:n})}return{getAll:n,get:r,create:o,update:a,getProductsByCerID:i}}e.$inject=["bzResourceSvc"],t.$inject=["$q","certificateFac"],angular.module("bzCertificate").factory("certificateFac",e).service("certificateSvc",t)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"category"})}function a(){var e=new r;return e.$get({method:"category-add"})}function i(e,t){var n=new r(e);return n.$update({method:"category",id:t})}function s(e){var t=new r(e);return t.$get({method:"category"})}function u(e){var t=new r;return t.$get({method:"category",id:e})}function c(e){var t=new r;return t.$get({method:"category_id",id:e})}function l(e,t){var n=new r(e);return n.$get({method:"category_child",id:t})}return{create:o,update:i,getAll:s,get:u,add:a,getChild:l,getById:c}}t.$inject=["$q","$window","bzResourceSvc","categoryFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzCategory").service("categorySvc",t).factory("categoryFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){var t=new r(e);return t.$save({method:"blog"})}function a(e,t){var n=new r(e);return n.$update({method:"blog",id:t})}function i(e){var t=new r(e);return t.$get({method:"blog"})}function s(e){var t=new r;return t.$get({method:"blog",id:e})}function u(e){var t=new r;return t.$get({method:"blog-tag",id:e})}return{create:o,update:a,getAll:i,get:s,getTagsBlog:u}}t.$inject=["$q","$window","bzResourceSvc","blogFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzBlog").service("blogSvc",t).factory("blogFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:id",{method:"@method",id:"@id"})}function t(e,t,n,r){function o(e){e.method="banner";var t=new r;return t.$get(e)}function a(){var e=new r;return e.$get({method:"banner"})}function i(){var e=new r;return e.$get({method:"banner"})}function s(){var e=new r;return e.$get({method:"banner"})}function u(e,t){var n=new r(e);return n.$save({method:"banner",id:t})}function c(e){var t=new r(e);return t.$save({method:"banner"})}function l(e){var t=new r;return t.$delete({method:"banner",id:e})}return{getAll:o,getHomeTop:a,getHomeBanner:i,getCategoryTop:s,create:c,update:u,del:l}}t.$inject=["$q","$window","bzResourceSvc","bannerFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzBanner").service("bannerSvc",t).service("bannerFac",e)}(),function(){function e(e,t){return t.api(e.settings.services.admin+"/:method/:param1/:param2",{method:"@method",param1:"@param1",param2:"@param2"})}function t(e,t,n,r){function o(e,t){var n=new r(e);return n.$save({method:"permission"})}function a(){var e=new r;return e.$get({method:"permission"})}function i(e){var t=new r;return t.$remove({method:"delete-role",param1:e})}function s(e,t){var n=new r;return n.$remove({method:"delete-resource",param1:e,param2:t})}function u(e,t,n){var o=new r(e);return o.$update({method:"permission",param1:t,param2:n})}function c(e){var t=new r;return t.$get({method:"resources",param1:e})}function l(e,t){var n=new r(e);return n.$update({method:"add-resource",param1:t})}return{create:o,get:a,update:u,getResoureRole:c,addResource:l,removeRole:i,removeResource:s}}t.$inject=["$q","$window","bzResourceSvc","permissionFac"],e.$inject=["$window","bzResourceSvc"],angular.module("bzPermisstion").service("permissionSvc",t).service("permissionFac",e)}(),function(){function e(e,t,n,r,o,a){function i(){u.submitted=!1,u.lockForm=!1,u.formData={currentPassword:"",newPassword:"",confirmNewPassword:""}}function s(e){u.submitted=!0,!u.lockForm&&e&&(u.lockForm=!0,a.postChangePass(u.formData).then(function(e){r.toastr({type:"success",data:{title:"Thành công",message:"Đổi mật khẩu thành công"}}),n.reload(),o.close(),u.lockForm=!1,a.siteLogout()})["catch"](function(e){r.toastr({type:"error",data:{title:"Lỗi",message:e.data.message}}),n.reload(),o.close(),u.lockForm=!1}))}var u=this;u.queryParams={},u.userCurent=a.getProfile(),u.submit=s,i()}e.$inject=["$scope","$rootScope","$state","$bzPopup","$uibModalInstance","authSvc"],angular.module("bzUser").controller("popChangePassCtrl",e)}();var updatetagProduct=function(){function e(e,t,n,r,o,a){function i(){r.close(e.formData)}o.isSuperAdmin()||o.isAdmin()&&o.hasPermission("tag",["edit"])||t.go("error403"),e.update=i,e.submitted=!1,e.data=a,e.formData={id_tag:a.id_tag,expire_date:a.product.tag_product.expire_date,order:a.product.tag_product.order}}e.$inject=["$scope","$state","$uibModal","$uibModalInstance","authSvc","data"],angular.module("bzCoupon").controller("updatetagProduct",e)}(),popupOrderCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g,h,f,v,y,b){function P(n){e.orderDetail.total_pay=e.orderDetail.total+e.orderDetail.payment_info.info.shipping_fee-e.orderDetail.coupon.value-("CHIEU"==e.orderDetail.delivery_time?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*e.caculatingOnSaleAffternoon():t.promotionForOrderDeleveryOnAffternoon.value:0)-(e.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*e.totalNotOnSale():0),m.update({order:e.orderDetail},e.orderDetail._id).then(function(t){a.toastr({type:"success",data:{title:"Thành công!",message:"Cập nhật đơn hàng thành công!"}}),s.close(e.orderDetail)})["catch"](function(e){n.$submitted=!1,a.toastr({type:"error",data:{title:"Lỗi!",message:resp.err.message}})})}function T(e,t){var n;return t.length>e.length&&(n=t,t=e,e=n),e.filter(function(e){return t.indexOf(e)>-1})}function $(){var t=0;return e.orderDetail.order_detail.forEach(function(n,r){var o=n.product.category.map(function(e){return""+e});T(o,e.listIdCateOnsaleAffternoon).length>0&&null==n.id_promote.id&&0==T(o,e.listCateException).length&&(t+=n.total)}),t}function C(){var t=0;return e.orderDetail.order_detail.forEach(function(e,n){null==e.id_promote.id&&(t+=e.total)}),t}function w(){"CT"==e.orderDetail.delivery_type?e.orderDetail.payment_info.info.shipping_fee=0:e.orderDetail.payment_info.info.shipping_fee=g.shipping_fee.fee}function S(){e.orderDetail.payment_info.info.user_id&&(p.api(n.settings.services.admin+"/order/"+e.orderDetail.payment_info.info.user_id._id+"-"+e.orderDetail._id).get({},function(t){!e.orderDetail.old_id&&t.success&&(e.isFirstOder=t.success)}),function(e){console.log("checkFirstOrder",e)})}c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order",["add","edit"])||r.go("error403"),e.statusOrder=h,e.shipperList=f,e.urlImg=settingJs.configs.uploadDirectory.thumb_product,e.listIdCateOnsaleAffternoon=t.promotionForOrderDeleveryOnAffternoon.listCateApply,e.listCateException=t.promotionForOrderDeleveryOnAffternoon.listCateException,e.orderDetail=g,e.isFirstOder=!1,S(),e.updateOrderDetail=P,e.checkImgOld=y.checkImgOld,e.onChangeDeliveryType=w,e.caculatingOnSaleAffternoon=$,e.totalNotOnSale=C,e.editUserShipping=function(){r.go("user-shipping",{id:e.orderDetail.payment_info.info.user_id._id}),s.close(e.orderDetail.payment_info.info.id_shipping_address)}}e.$inject=["$scope","$rootScope","$window","$state","$stateParams","$bzPopup","$uibModal","$uibModalInstance","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","orderSvc","order","statusOrderList","shipperList","permission","productSvc","shippingfeeSvc"],angular.module("bzOrder").controller("popupOrderCtrl",e)}(),popupLogCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){e.log=p,e.log.object=JSON.parse(e.log.object)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","$uibModalInstance","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","detailLog"],angular.module("bzAuditLog").controller("popupLogCtrl",e)}(),popupGenaratorCodeCtrl=function(){function e(e,t,n,r,o){function a(t){if(e.submitted=!0,t.$valid&&e.data.code.split("*").length-1>=3&&e.data.code.indexOf("*")!=-1&&c.length>0){var n=e.data.code.split("*"),o="",a=function i(){if(o.split(",").length>e.data.qty)return o=o.substring(0,o.length-1);var t="",r=0;for(r=0;r<=n.length-1;r++)t=t+n[r]+c[Math.round(Math.random()*(c.length-1))];t=t.substring(0,t.length-1),o.indexOf(t)==-1&&(o+=t,o+=","),i()};a(),r.close({code_group:o,code:n[0]})}}function i(){c="",e.data.maxCode=0,e.data.charecter&&(c+=l,e.data.maxCode=900),e.data.number&&(c+=d,e.data.maxCode+=100),!e.data.charecter&&!e.data.number}function s(){var t=e.data.code.split("*");t.forEach(function(e,n){t[n]=u(e).toUpperCase()}),e.data.code=t.join("*")}function u(e){if(e){var t=e.toLowerCase();return t=t.replace(/á|à|ả|ạ|ã|ă|ắ|ằ|ẳ|ẵ|ặ|â|ấ|ầ|ẩ|ẫ|ậ/gi,"a"),t=t.replace(/é|è|ẻ|ẽ|ẹ|ê|ế|ề|ể|ễ|ệ/gi,"e"),t=t.replace(/i|í|ì|ỉ|ĩ|ị/gi,"i"),t=t.replace(/ó|ò|ỏ|õ|ọ|ô|ố|ồ|ổ|ỗ|ộ|ơ|ớ|ờ|ở|ỡ|ợ/gi,"o"),t=t.replace(/ú|ù|ủ|ũ|ụ|ư|ứ|ừ|ử|ữ|ự/gi,"u"),t=t.replace(/ý|ỳ|ỷ|ỹ|ỵ/gi,"y"),t=t.replace(/đ/gi,"d"),t=t.replace(/\`|\~|\!|\@|\#|\||\$|\%|\^|\&|\*|\(|\)|\+|\=|\,|\.|\/|\?|\>|\<|\'|\"|\:|\;/gi,""),t=t.replace(/ /gi,"-"),t=t.replace(/\-\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-\-/gi,"-"),t=t.replace(/\-\-\-/gi,"-"),t=t.replace(/\-\-/gi,"-")}return e}o.isSuperAdmin()||o.isAdmin()&&o.hasPermission("coupon",["add","edit"])||t.go("error403"),e.genaratorCode=a,e.onTypeCode=s,e.onChangeRangeRamdom=i,e.data={code:"",qty:2,charecter:!0,number:!0,maxCode:100};var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",d="0123456789";e.submitted=!1}e.$inject=["$scope","$state","$uibModal","$uibModalInstance","authSvc"],angular.module("bzCoupon").controller("popupGenaratorCodeCtrl",e)}(),userShippingCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){l.api(t.settings.services.admin+"/all-shippingfee").get(function(e){P.districts=e.items})}function g(){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:P.userId},function(e){P.user=e})}function h(e){delete P.user.__v,delete P.user.password_token,delete P.user.created,delete P.user.provider,delete P.user.activeToken,P.user.cfpassword=P.user.password,P.user.dob||(P.user.dob=""),d.update(P.user,P.userId).then(function(e){o.toastr({type:"success",data:{title:"Địa chỉ giao hàng",message:"Cập nhật thành công"}}),n.reload()})["catch"](function(e){o.toastr({type:"error",data:{title:"Địa chỉ giao hàng",message:e.data.message}}),userEdit.lockForm=!1})}function f(e){if(""==e||null==e)return"Dữ liệu không được để trống"}function v(e){if(P.user.dob||(P.user.dob=""),P.submitted=!0,P.lockForm=!0,e){var r={name:P.formData.txtName,phone:P.formData.phone,address_detail:P.formData.address,id_shipping_fee:P.formData.district};l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:P.userId},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken;var t=e;t.dob||(t.dob=""),t.cfpassword=t.password,t.customer.shipping_address.push(r),d.update(t,P.userId).then(function(e){o.toastr({type:"success",data:{title:"Địa chỉ",message:"Thêm thành công"}}),n.reload()})["catch"](function(e){o.toastr({type:"error",data:{title:"Địa chỉ",message:e.data.message}}),userEdit.lockForm=!1})})}}function y(e){P.user.dob||(P.user.dob="");a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,r){t.popTitle="Xóa",t.message="Bạn chắc chắn sẽ xóa dữ liệu này?",t.ok=function(){var t=P.user;delete t.__v,delete t.password_token,delete t.created,delete t.provider,delete t.activeToken,t.cfpassword=t.password;var a=t.customer.shipping_address.find(function(t){return t._id==e}),i=t.customer.shipping_address.indexOf(a);t.customer.shipping_address.splice(i,1),d.update(t,P.userId).then(function(e){o.toastr({type:"success",data:{title:"Địa chỉ",message:"Xóa thành công"}}),r.close(),n.reload()})["catch"](function(e){o.toastr({type:"error",data:{title:"Địa chỉ",message:e.data.message}}),userEdit.lockForm=!1,r.close()})}}]})}function b(){P.showForm=!P.showForm}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("user",["view"])||n.go("error403"),P.lockFOrm=!1,P.submitted=!1,P.userId=r.id,P.showForm=!1,P.addUserShipping=v,P.deleteUserShipping=y,P.show=b,P.updateAddressShipping=h,P.checkEmpty=f,m(),g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","userSvc","editableOptions"],angular.module("bzUser").controller("userShippingCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),usersCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){l.api(t.settings.services.apiUrl+"/user").get(P.queryParams,function(e){P.totalItems=e.totalItems,P.queryParams.pageCount=e.totalPage,P.users=e.items,P.table=new u({count:parseInt(P.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),P.users}}),P.table.page(P.queryParams.page),P.loading=!1},function(e){console.log(e),o.toastr({type:"error",data:{title:"User",message:e.data.message}})})}function p(e){n.go(".",{role:""!=P.role?P.role:null,keyword:e,status:""!=P.status?P.status:null,page:1}).then(function(){n.reload()})}function m(){n.go(".",{role:null,keyword:null,page:P.queryParams.page,status:null},{notify:!1}).then(function(){n.reload()})}function g(e,r){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).update({_id:e},{status:r},function(e){o.toastr({type:"success",data:{title:"User",message:1===r?"Kích hoạt tài khoản thành công!":"Vô hiệu hóa tài khoản thành công!"}}),n.reload()})}function h(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự bài viết thành công!"}})}function f(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa tài khoản thành công!"}}),n.reload(),a.close()})}}]})}function v(e,r){var i={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa vĩnh viễn",e.message="Bạn chắc chắn xoá tài khoản "+r+"?",e.ok=function(){l.api(t.settings.services.admin+"/user/:id",{id:"@id"})["delete"]({id:i.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa tài khoản thành công!"}}),n.reload(),a.close()})}}]})}function y(e,r){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(a,i){
a.popTitle="Khôi phục xoá",a.message="Khôi phục tài khoản "+r+"?",a.ok=function(){l.api(t.settings.services.admin+"/restore-user/:id",{id:"@id"}).update({id:e},{},function(e){o.toastr({type:"success",data:{title:"Khôi phục",message:"Khôi phục tài khoản thành công!"}}),n.reload(),i.close()})}}]})}function b(e){P.processingExport=!0;var n=[["STT","Danh xưng","Tên tài khoản","Điện thoại","Email","Ngày đăng ký","Trạng thái","Facebook","Ngày sinh"]],r={type:"xlsx",sheetName:"UserMHV",fileName:"User_"+moment(new Date).format("DD/MM/YYYY")},a=JSON.parse(JSON.stringify(P.queryParams));a.limit=P.totalItems,a.page=1,l.api(t.settings.services.apiUrl+"/user").get(a,function(e){var t=function(e,t,n){return e&&"undefined"!==e?n.push(""+e):n.push(t),n};e.items.forEach(function(e,r){var o=[r+1];o=t(e.vocative,"",o),o=t(e.name,"",o),o=t(e.phone,"",o),o=t(e.email,"",o);var a=moment(e.createdAt).format("DD/MM/YYYY");if(o.push(a),e.status?o.push("Acitve"):o.push("Inactive"),e.provider_id?o.push("https://www.fb.com/"+e.provider_id):o.push(""),e.dob){var i=moment(e.dob).format("DD/MM/YYYY");o.push(i)}else o.push("");n.push(o)}),ExcelJs.exportExcel(n,r),P.processingExport=!1},function(e){console.log(e),P.btnExport=!1,o.toastr({type:"error",data:{title:"Thất bại",message:"Không thể xuất. Hãy thử lại"}})})}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("user",["view"])||n.go("error403"),P.loading=!0,P.selectedItems=[],P.queryParams=r,P.keyword=r.keyword,P.role=r.role,P.status=r.status,P.deletedAt=r.deletedAt,P.userRoles=i,P.users=[],P.filter=p,P.filterReset=m,P.active=g,P.sort=h,P.remove=f,P.restore=y,P.deleteUser=v,P.exportExcel=b,d(),c.onPagesChanged(function(){e.vmUsers.queryParams.page=P.table.page(),n.go(".",e.vmUsers.queryParams)},e,P.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc"],angular.module("bzUser").controller("usersCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),userEditProfileCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c){function l(e){p.lockForm=!1,p.submitted=!1,p.formData={name:p.isEditMode?e.name:"",email:p.isEditMode?e.email:"",password:"",cfpassword:"",roles:p.isEditMode?e.roles:["user"],status:!!p.isEditMode&&e.status,saleman:{active:!!p.isEditMode&&e.saleman.active,manager:!!p.isEditMode&&e.saleman.manager,types:p.isEditMode?e.saleman.types:[]}},"sale"==p.queryParams.module&&(p.formData.roles=["admin","user","sale"],p.formData.status=!p.isEditMode||e.status)}function d(){p.isEditMode?u.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:p.queryParams.id},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken,l(e)}):l()}var p=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("user",["edit"])||n.go("error403"),p.queryParams=r,p.userRoles=a,p.salemanScopes=c,p.isEditMode=void 0!==p.queryParams.id,p.save=save,d()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","userRoles","authSvc","userSvc","bzResourceSvc","salemanScopes"],angular.module("bzUser").controller("userEditProfileCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),userEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u){function c(){g.isEditMode=void 0!==g.queryParams.id}function l(){s.getRoles().then(function(e){e.success&&(g.userRoles=e.data)})}function d(e){g.lockForm=!1,g.submitted=!1;g.isEditMode?e.name:"";g.tmppassword="",g.formData={name:1==g.isEditMode?e.name:"",phone:g.isEditMode?e.phone:"",email:g.isEditMode?e.email:"",password:g.isEditMode?e.password:"",roles:g.isEditMode?e.roles:["user"],vocative:g.isEditMode?e.vocative:"Anh",dob:g.isEditMode?e.dob:"",status:!g.isEditMode||e.status},g.loading=!1}function p(){g.isEditMode?u.api(t.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:g.queryParams.id},function(e){delete e.__v,delete e.password_token,delete e.created,delete e.provider,delete e.activeToken,d(e)}):d()}function m(e){g.submitted=!0,g.formData.dob||(g.formData.dob=""),!g.lockForm&&e&&(g.lockForm=!0,1==g.formData.status?g.formData.status=!0:0==g.formData.status&&(g.formData.status=!1),g.isEditMode?g.isEditMode&&(1==g.formData.status?g.formData.status=!0:0==g.formData.status&&(g.formData.status=!1),delete g.formData.password,delete g.formData.cfpassword,s.update(g.formData,g.queryParams.id).then(function(e){o.toastr({type:"success",data:{title:"Thành viên",message:"Sửa thành công"}}),n.go("users",{id:null})},function(e){o.toastr({type:"error",data:{title:"Thành viên",message:e.data.message}}),g.lockForm=!1})):(g.formData.cfpassword=g.formData.password,s.create(g.formData).then(function(e){o.toastr({type:"success",data:{title:"Thành viên",message:e.message}}),n.go("users",{id:null})},function(e){o.toastr({type:"error",data:{title:"Thành viên",message:e.data.message}}),g.lockForm=!1})))}var g=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("user",["edit"])||n.go("error403"),g.formData={},g.queryParams=r,g.userRoles=[],g.loading=!0,g.isEdit=c,g.save=m,g.initFormData=d,g.getData=p,g.listVocative=[{name:"Anh",value:"Anh"},{name:"Chị",value:"Chị"},{name:"Cô",value:"Cô"},{name:"Chú",value:"Chú"},{name:"Bác",value:"Bác"},{name:"Ông",value:"Ông"},{name:"Bà",value:"Bà"}],c(),l()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","userRoles","authSvc","userSvc","bzResourceSvc"],angular.module("bzUser").controller("userEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/unit").get(f.queryParams,function(e){f.queryParams.pageCount=e.totalPage,f.listUnit=e.items,f.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),f.listUnit}}),f.table.page(f.queryParams.page),f.loading=!1})}function m(e){n.go(".",angular.extend(e,saleContact.queryParams),{notify:!1}).then(function(){n.reload()})}function g(){n.go(".",{publish:null,cateid:null,keyword:null,limit:settingJs.admin.itemPerPage},{notify:!1}).then(function(){n.reload()})}function h(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/unit/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa đơn vị thành công!"}}),n.reload(),a.close()})}}]})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["view"])||n.go("error403"),f.loading=!0,f.selectedItems=[],f.queryParams=r,f.userRoles=i,f.units=[],f.filter=m,f.filterReset=g,f.remove=h,p(),c.onPagesChanged(function(){e.vmUnits.queryParams.page=f.table.page(),n.go(".",e.vmUnits.queryParams)},e,f.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc"],angular.module("bzUnit").controller("unitsCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){var e=r.id;d.get(e).then(function(e){g.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data}})})}function m(e){g.submitted=!0,g.lockForm=!0,e?d.update(g.formData,g.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Đơn vị",message:e.message}}),n.go("units")})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật đơn vị",message:e.data.message}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["edit"])||n.go("error403"),g.lockFOrm=!1,g.save=m,g.vmEditUnits=p,g.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc"],angular.module("bzUnit").controller("unitEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(e){m.submitted=!0,m.lockForm=!0,e?d.create(m.formData).then(function(e){o.toastr({type:"success",data:{title:"Đơn vị",message:"Thêm thành công"}}),n.go("units")})["catch"](function(e){o.toastr({type:"error",data:{title:"Thêm đơn vị",message:e.data}})}):m.submitted=!0}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("unit",["add"])||n.go("error403"),m.formData={},m.lockFOrm=!1,m.save=p,m.submitted=!1}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","unitSvc"],angular.module("bzUnit").controller("unitAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),testResizeCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){o.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(e,t){e.popupScope={event:"crop:image",ratio:.75,width:300,height:400},e.$on("crop:image",function(e,t){console.log("image",t),p.uploadBase64({directory:"avatar",image:t.image}).then(function(e){console.log("success uplaod",e)})["catch"](function(e){console.log("Error upload: ",e)})})}]})}function g(){p.resize(f.formData).then(function(e){f.image["new"]=e})["catch"](function(e){console.log("err",e)})}function h(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type&&"image/gif"!=t[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");d.upload({url:a.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"tmp",prefix:"test_img"}}).then(function(e){console.log(e),f.image.old=e.data,f.formData.name=f.image.old.filename},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var f=this;f.thumbImgPath=settingJs.configs.uploadDirectory.thumb,f.tempImgPath=settingJs.configs.uploadDirectory.tmp,f.image={old:null,"new":null},f.formData={height:300,width:300,name:null},f.uploadImage=h,f.resize=g,f.crop=m}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$filter","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","Upload","testSvc"],angular.module("bzTest").controller("testResizeCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),supplierListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/supplier").get(f.queryParams,function(e){f.queryParams.pageCount=e.totalPage,f.listSupplier=e.items,f.table=new u({count:parseInt(f.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),f.listSupplier}}),f.table.page(f.queryParams.page),f.loading=!1})}function m(e){n.go(".",{keyword:e,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/supplier/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa nhà cung cấp thành công!"}}),n.reload(),a.close()})}}]})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["view"])||n.go("error403"),f.loading=!0,f.selectedItems=[],f.keyword=r.keyword,f.queryParams=r,f.userRoles=i,f.listSupplier=[],f.filter=m,f.filterReset=g,f.remove=h,p(),c.onPagesChanged(function(){e.vmListSupplier.queryParams.page=f.table.page(),n.go(".",e.vmListSupplier.queryParams)},e,f.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),supplierImportProductHistoryCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){var e=n.id;l.get(e).then(function(e){m.supplier=e})["catch"](function(e){r.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}})})}function p(){c.api(a.settings.services.admin+"/supplier/import-product/"+n.id).get(m.queryParams,function(e){m.filter={},m.queryParams.pageCount=e.totalPage,m.list=e.items,m.params=e.params,m.table=new i({count:m.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),m.list}}),m.table.page(m.queryParams.page),m.loading=!1})}var m=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("supplier",["edit","export"])||t.go("error403"),m.loading=!0,m.queryParams=n,m.supplier={},d(),p(),s.onPagesChanged(function(){e.vmSupplierImportProductHistory.queryParams.page=m.table.page(),t.go(".",e.vmSupplierImportProductHistory.queryParams)},e,m.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierImportProductHistoryCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){var e=r.id;d.get(e).then(function(e){g.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function m(e){g.submitted=!0,g.lockForm=!0,e?d.update(g.formData,g.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Nhà cung cấp",message:e.message}}),n.go("suppliers")})["catch"](function(e){o.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["edit"])||n.go("error403"),g.formData={name:"",phone:"",fax:"",email:"",website:"",status:!0,address:"",deputy:{name:"",phone:"",email:""}},g.lockFOrm=!1,g.save=m,g.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),unitsCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(e){m.submitted=!0,m.lockForm=!0,e?d.create(m.formData).then(function(e){o.toastr({type:"success",data:{title:"Nhà cung cấp",message:e.message}}),n.go("suppliers")})["catch"](function(e){o.toastr({type:"error",data:{title:"Nhà cung cấp",message:e.data.message}}),m.submitted=!0,m.lockForm=!1}):(m.submitted=!0,m.lockForm=!1)}var m=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("supplier",["add"])||n.go("error403"),m.formData={name:"",phone:"",tax_code:"",bank_info:{name:"",account_number:"",bank_name:""},email:"",website:"",status:!0,address:"",deputy:{name:"",phone:"",email:""}},m.lockFOrm=!1,m.save=p,m.submitted=!1}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","supplierSvc"],angular.module("bzSupplier").controller("supplierAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagProductCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m){function g(){l.api(t.settings.services.admin+"/tag").get(w.queryParams,function(e){w.tagProduct=e.items})}function h(e){if(w.expire_date){var t=moment(e.endDate),n=moment(w.expire_date).subtract(1,"days").endOf("day");return!t.isAfter(n)}return!0}function f(e){w.tags=[],e?d.get(e).then(function(e){w.tags.push(e),w.tags.forEach(function(e,t){var n=e._id,r=e.type;d.getListProduct(n,r).then(function(t){e.products=t.data}),d.getProductByTag(n,r,w.expire_date).then(function(t){t.data&&(t.data.forEach(function(e,t){var r={};e.tag_product.forEach(function(e){n==e.id_tag&&(r=e)}),e.tag_product=r}),e.table=t.data)})})}):l.api(t.settings.services.admin+"/tag").get(w.queryParams,function(e){w.tags=e.items,w.tags.forEach(function(e,t){var n=e._id,r=e.type;d.getListProduct(n,r).then(function(t){e.products=t.data}),d.getProductByTag(n,r,w.expire_date).then(function(t){t.data&&(t.data.forEach(function(e,t){var r={};e.tag_product.forEach(function(e){n==e.id_tag&&(r=e)}),e.tag_product=r}),e.table=t.data)})})})}function v(e){var t=w.expire_date?w.expire_date:null;t&&(t=moment(t).format("MM-DD-YYYY"),"Invalid Date"==t.format()&&(t=null)),n.go(".",{tag:e,expire:t}).then(function(){n.reload()})}function y(){n.go(".",{tag:null,expire:null},{notify:!1}).then(function(){n.reload()})}function b(e,t){if(w.submitted=!0,w.lockForm=!0,e)for(var r={id_tag:t._id,expire_date:t.formData.expire_date},a=t.formData.idProducts,i=0;i<a.length;i++){var s=a[i];d.getProductById(s).then(function(e){var t=e;t.tag_product.push(r),p.updateTag({data:t}).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:"Thêm sản phẩm "+t.name+" thành công"}}),n.reload()})["catch"](function(e){o.toastr({type:"error",data:{title:"Thất bại",message:e.data.message}})})})}else w.submitted=!0,w.lockForm=!1}function P(e,t,r,o){d.getProductById(t._id).then(function(e){var t=0;e.tag_product.find(function(e,n){return t=n,e.id_tag==r});e.tag_product[t].order=o,p.updateTag({data:e}).then(function(e){n.reload()})})}function T(e,t){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(r,a){r.popTitle="Xóa",r.message="Bạn chắc chắn sẽ xóa dữ liệu này?",r.ok=function(){d.getProductById(e._id).then(function(e){var r=0;e.tag_product.find(function(e,n){return r=n,e.id_tag==t});e.tag_product.splice(r,1),p.updateTag({data:e}).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:"Xóa nhãn thành công."}}),n.reload(),a.close()})["catch"](function(e){o.toastr({type:"error",data:{title:"aaa",message:e.data.message}}),a.close()})})}}]})}function $(e){"undefined"==typeof e.showForm?e.showForm=!0:e.showForm=!e.showForm}function C(e,t){var r=a.open({animation:!0,templateUrl:"modules/admin-tag/view/client/popup/edit-tag-product/view.html",controller:"updatetagProduct",resolve:{data:function(){return angular.copy({product:e,id_tag:t,optionTimePicker:w.optionTimePicker})}}});r.result.then(function(r){d.getProductById(e._id).then(function(e){var a=0;e.tag_product.find(function(e,n){return a=n,e.id_tag==t});e.tag_product[a]=r,p.updateTag({data:e}).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:"Cập nhật nhãn thành công."}}),n.reload(),$uibModalInstance.close()})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật nhãn",message:e.data.message}}),$uibModalInstance.close()})})},function(){})}var w=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","view")||n.go("error403"),w.loading=!0,w.selectedItems=[],w.queryParams=r,w.keyword=r.tag||"",w.userRoles=i,w.formData={},w.lockFOrm=!1,w.submitted=!1,w.optionTimePicker={timePicker:!0,timePickerIncrement:30,singleDatePicker:!1,locale:{format:"h:ss DD/MM/YYYY"}},w.expire_date=r.expire?r.expire:null,w.filter=v,w.filterReset=y,w.saveProduct=b,w.deleteProduct=T,w.showForm=$,w.getListTag=f,w.updateOrder=P,w.editExpire=C,w.filterExpireDate=h,g(),f(w.keyword)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","productSvc","$filter"],angular.module("bzTag").controller("tagProductCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagProcesssingCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){y.productByTag=[],l.api(t.settings.services.admin+"/tag").get(y.queryParams,function(e){y.tags=e.items,y.tags.forEach(function(e,t){var n=e._id,r=e.type;d.getListProduct(n,r).then(function(t){e.products=t.data}),d.getProductByTag(n,r).then(function(t){e.table=t.data})})})}function g(e,t){if(y.submitted=!0,y.lockForm=!0,e)for(var r={id_tag:t._id},a=t.formData.idProducts,i=0;i<a.length;i++){var s=a[i];d.getProductById(s).then(function(e){var t=e;t.tag_processing.push(r),p.updateTag({data:t}).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:"Thêm nhãn thành công"}}),n.reload()})["catch"](function(e){console.log("error",e),o.toastr({type:"error",data:{title:"aaa",message:e.data.message}})})})}else y.submitted=!0}function h(e,t){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(r,a){r.popTitle="Xóa",r.message="Bạn chắc chắn sẽ xóa dữ liệu này?",r.ok=function(){var r=0;e.tag_processing.find(function(e,n){return r=n,e.id_tag==t});e.tag_processing.splice(r,1),p.updateTag({data:e}).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:"Thêm nhãn thành công"}}),n.reload(),a.close()})["catch"](function(e){console.log("error",e),o.toastr({type:"error",data:{title:"aaa",message:e.data.message}}),a.close()})}}]})}function f(e){"undefined"==typeof e.showForm?e.showForm=!0:e.showForm=!e.showForm}function v(e,t){return t.tag_processing.find(function(t){return t.id_tag==e})}var y=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","view")||n.go("error403"),y.loading=!0,y.selectedItems=[],y.queryParams=r,y.userRoles=i,y.tags=[],y.formData={},y.lockFOrm=!1,y.submitted=!1,y.optionTimePicker={timePicker:!0,timePickerIncrement:30,singleDatePicker:!1,locale:{format:"h:mm DD/MM/YYYY"}},y.saveProduct=g,y.deleteProduct=h,y.showForm=f,y.findTag=v,m()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","productSvc"],angular.module("bzTag").controller("tagProcesssingCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagCtrl=function(){function e(e,n,r,o,a,i,s,u,c,l,d,p){function m(){d.api(n.settings.services.admin+"/tag").get(y.queryParams,function(e){y.queryParams.pageCount=e.totalPage,y.tags=e.items,y.table=new c({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),y.tags}}),y.table.page(y.queryParams.page),y.loading=!1})}function g(e){r.go(".",{keyword:e?e:null,type:y.type?y.type:null,page:1}).then(function(){r.reload()})}function h(){r.go(".",{keyword:null,type:null,page:1},{notify:!1}).then(function(){r.reload()})}function f(e,t){a.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự nhãn thành công!"}})}function v(e){var t={ids:[e]};i.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,o){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){d.api(n.settings.services.admin+"/tag/:id",{id:"@id"})["delete"]({id:t.ids},function(e){a.toastr({type:"success",data:{title:"Xóa",message:"Xóa nhãn thành công!"}}),r.reload(),o.close()})}}]})}var y=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("tag","view")||r.go("error403"),y.showBtnAdd=u.hasPermission("tag","add"),y.showBtnEdit=u.hasPermission("tag",["add","edit"]),y.showBtnDelete=u.hasPermission("tag","delete"),y.loading=!0,y.selectedItems=[],y.queryParams=o,y.keyword=o.keyword,y.type=o.type,y.userRoles=s,y.tags=[],y.filter=g,y.filterReset=h,y.sort=f,y.remove=v,y.setNameDisplayType=t,m(),l.onPagesChanged(function(){e.vmTags.queryParams.page=y.table.page(),r.go(".",e.vmTags.queryParams)},e,y.table)}function t(e){return"SP"===e?"Sản phẩm":"CN"===e?"Cách nấu":"BL"===e?"Bài viết":void 0}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc"],angular.module("bzTag").controller("tagCtrl",e);var n={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:n}}(),tagEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){var e=r.id;d.get(e).then(function(e){h.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function g(e){h.submitted=!0,h.lockForm=!0,e?d.update(h.formData,h.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Phí vận chuyển",message:e.message}}),n.go("tag-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật phí vận chuyển",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag",["add","edit"])||n.go("error403"),h.lockFOrm=!1,h.save=g,h.vmEditTags=m,h.submitted=!1,h.listTagTypeBlog=p,m()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","listTagTypeBlog"],angular.module("bzTag").controller("tagEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),tagAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(e){g.submitted=!0,g.lockForm=!0,e?d.create(g.formData).then(function(e){o.toastr({type:"success",data:{title:"Nhãn sản phẩm",message:"Thêm thành công"}}),n.go("tag-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Thêm nhãn sản phẩm ",message:e.data.message}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("tag","add")||n.go("error403"),g.formData={},g.lockFOrm=!1,g.save=m,g.submitted=!1,g.listTagTypeBlog=p,g.formData.type="SP"}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","tagSvc","listTagTypeBlog"],angular.module("bzTag").controller("tagAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/shippingfee").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.shippingfees=e.items,v.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),v.shippingfees}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự bài viết thành công!"}})}function f(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/shippingfee/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa phí vận chuyển thành công!"}}),n.reload(),a.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("shipping","add"),v.showBtnEdit=s.hasPermission("shipping",["add","edit"]),v.showBtnDelete=s.hasPermission("shipping","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=r,v.keyword=r.keyword,v.userRoles=i,v.shippingfees=[],v.filter=m,v.filterReset=g,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmShippingFees.queryParams.page=v.table.page(),n.go(".",e.vmShippingFees.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){var e=r.id;d.get(e).then(function(e){g.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function m(e){g.submitted=!0,g.lockForm=!0,e?d.update(g.formData,g.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Phí vận chuyển",message:e.message}}),n.go("shippingfee-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật phí vận chuyển",message:e.data.message}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping",["add","edit"])||n.go("error403"),g.lockFOrm=!1,g.save=m,g.getShippingFee=p,g.submitted=!1,p()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),shippingfeeAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){h.formData.district&&h.listShippingFeeNoExitsInMongoDB.forEach(function(e){e.district==h.formData.district&&(h.formData.fee=e.fee,h.formData.type=e.type+"")})}function m(e){"mongodb"==e?d.getAllNoPaging().then(function(e){h.listShippingFeeInMongoDB=e.items,m("default")})["catch"](function(t){console.log(e,t)}):d.getShippingFeeDefault().then(function(e){h.listShippingFeeDefault=e.items,h.listShippingFeeDefault.map(function(e){var t=!1;h.listShippingFeeInMongoDB.forEach(function(n){n.district==e.district&&(t=!0)}),t||h.listShippingFeeNoExitsInMongoDB.push(e)})})["catch"](function(e){console.log("get default shipping fee",e)})}function g(e){h.submitted=!0,h.lockForm=!0,e?d.create(h.formData).then(function(e){o.toastr({type:"success",data:{title:"Giá vận chuyển",message:"Thêm thành công"}}),n.go("shippingfee-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Thêm giá vận chuyển",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("shipping","add")||n.go("error403"),h.formData={},h.lockFOrm=!1,h.save=g,h.submitted=!1,h.formData.type="1",h.listShippingFeeInMongoDB=[],h.listShippingFeeDefault=[],h.listShippingFeeNoExitsInMongoDB=[],h.onChangeDistrict=p,m("mongodb")}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","shippingfeeSvc"],angular.module("bzShippingFee").controller("shippingfeeAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){e.vmSeL.queryParams.page=h.table.page(),t.go(".",e.vmSeL.queryParams)}function p(){l.getAll(h.queryParams).then(function(e){h.queryParams.pageCount=e.totalPage,h.list=e.items,h.table=new s({count:h.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),h.list}}),h.table.page(h.queryParams.page),h.loading=!1})}function m(e){e.status=!e.status;var t=e.status?"bỏ công khai":"công khai";o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="",n.message="Bạn muốn "+t+" từ khóa này?",n.ok=function(){l.active(e._id).then(function(t){e.status=!e.status,r.close()})}}]})}function g(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="Xóa ",n.message="Bạn muốn xóa từ khóa này?",n.ok=function(){l.del(e).then(function(e){e.success&&(h.queryParams.page=1,t.go(".",h.queryParams).then(function(){t.reload(),o.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa từ khóa thành công!"}})}))},function(e){r.toastr({type:"error",data:{
title:"Lỗi!",message:"Xóa từ khóa thất bại!"}})})}}]})}var h=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("search","view")||t.go("error403"),h.showBtnAdd=c.hasPermission("search","add"),h.showBtnEdit=c.hasPermission("search",["add","edit"]),h.showBtnDelete=c.hasPermission("search","delete"),h.loading=!0,h.queryParams=n,h.urlImg=settingJs.configs.uploadDirectory.product,h.activeSearch=m,h.deleteSearch=g,p(),u.onPagesChanged(d,e,h.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","searchSvc"],angular.module("bzSearch").controller("searchListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchEditCtrl=function(){function e(e,t,n,r,o,a,i){function s(){i.edit(l.queryParams.id).then(function(e){l.search=e.data,l.loading=!0})}function u(e){return e.$valid?void i.update({data:l.search},l.queryParams.id).then(function(e){t.go("search-list"),r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa từ khóa thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa từ khóa thất bại!"}})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin"}})}function c(e){e&&(e.$submitted=!1)}var l=this;a.isSuperAdmin()||a.isAdmin()&&a.hasPermission("search",["add","edit"])||t.go("error403"),l.queryParams=n,l.removeDisabledSubmit=c,l.update=u,l.getData=s}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","authSvc","searchSvc"],angular.module("bzSearch").controller("searchEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),searchAddCtrl=function(){function e(e,t,n,r,o,a,i){function s(){l.search={status:!0}}function u(e){return e.$valid?void i.create({data:l.search}).then(function(e){t.go("search-list"),r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm từ khóa thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm từ khóa thất bại!"}})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function c(e){e&&(e.$submitted=!1)}var l=this;a.isSuperAdmin()||a.isAdmin()&&a.hasPermission("search","add")||t.go("error403"),l.loading=!0,l.queryParams=n,l.removeDisabledSubmit=c,l.add=u,l.getData=s}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","authSvc","searchSvc"],angular.module("bzSearch").controller("searchAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),reportProductOrderCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){e.vmRPO.queryParams.page=y.table.page(),t.go(".",e.vmRPO.queryParams)}function m(){var e={singleDatePicker:!1};if(y.queryParams.date){var t=y.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(y.queryParams.date)}y.dateTimePickerOpt=e,l.reportProductOrder(y.queryParams).then(function(e){y.queryParams.pageCount=e.totalPage,y.list=e.items,y.categoryList=e.categories,y.optionsCate=v(e.categoryWithSub),y.table=new s({count:y.queryParams.limit,sorting:{qty_in_stock:y.queryParams.qty_in_stock,total_order:y.queryParams.total_order}},{counts:[],getData:function(t){return t.total(e.totalItems),y.list}}),y.table.page(y.queryParams.page),y.loading=!1})["catch"](function(e){console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Lấy dữ liệu thất bại!"}})})}function g(){y.queryParams.page=1,y.filter.date&&(y.queryParams.date=f(y.filter.date.startDate)+" - "+f(y.filter.date.endDate)),t.go(".",y.queryParams).then(function(){t.reload()})}function h(){y.queryParams.name=null,y.queryParams.category=null,y.queryParams.date=null,y.queryParams.total_order=null,y.queryParams.qty_in_stock=null,t.go(".",y.queryParams).then(function(){t.reload()})}function f(e){return e.format("DD/MM/YYYY")}function v(e){var t=[],n=function r(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return r(e,t)}),t};return e.forEach(function(e){var r=n(e,[]);e.sub_cate=r.splice(1),t.push(e)}),t}var y=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("product","view")||t.go("error403"),y.showBtnAdd=c.hasPermission("order","add"),y.showBtnEdit=c.hasPermission("order",["add","edit"]),y.showBtnDelete=c.hasPermission("order","delete"),y.loading=!0,y.queryParams=n,y.setting=settingJs,y.urlImg=settingJs.configs.uploadDirectory.thumb_product,y.filter={},y.filterForm=g,y.clearFilter=h,y.checkImgOld=d.checkImgOld,m(),u.onAfterReloadData(function(){var t=y.table.sorting();angular.equals(t,{})||(e.vmRPO.queryParams.qty_in_stock=t.qty_in_stock,e.vmRPO.queryParams.total_order=t.total_order),p()},e,y.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","reportSvc","productSvc"],angular.module("bzReport").controller("reportProductOrderCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),reportProductADayCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){l.reportProductADay(b.queryParams).then(function(e){b.queryParams.pageCount=e.totalPage,b.totalItems=e.totalItems,b.list=e.items,b.categoryList=e.categoryList,b.optionsCate=y(e.categoryWithSub),b.tagList=e.tagList,b.filterTmp={status:b.queryParams.status},b.table=new s({count:b.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),b.list}}),b.table.page(b.queryParams.page),b.loading=!1})}function g(){e.vmRPA.queryParams.page=b.table.page(),t.go(".",e.vmRPA.queryParams)}function h(){b.queryParams.page=1,b.queryParams.status=b.filterTmp.status,t.go(".",b.queryParams).then(function(){t.reload()})}function f(){b.queryParams.name=null,b.queryParams.category=null,b.queryParams.status=null,b.queryParams.tag=null,b.queryParams.dueDate=null,t.go(".",b.queryParams).then(function(){t.reload()})}function v(e){return e.product.tag_processing.concat(e.product.tag_product)}function y(e){var t=[],n=function r(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return r(e,t)}),t};return e.forEach(function(e){var r=n(e,[]);e.sub_cate=r.splice(1),t.push(e)}),t}var b=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("product","view")||t.go("error403"),b.showBtnAdd=c.hasPermission("order","add"),b.showBtnEdit=c.hasPermission("order",["add","edit"]),b.showBtnDelete=c.hasPermission("order","delete"),b.loading=!0,b.queryParams=n,b.setting=settingJs,b.urlImg=settingJs.configs.uploadDirectory.thumb_product,b.statusProduct=p,b.filterForm=h,b.clearFilter=f,b.checkImgOld=d.checkImgOld,b.formatTag=v,b.formatCategory=y,m(),u.onPagesChanged(g,e,b.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","reportSvc","productSvc","statusProduct"],angular.module("bzReport").controller("reportProductADayCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){e.vmPoL.queryParams.page=g.table.page(),t.go(".",e.vmPoL.queryParams)}function p(){l.getAll(g.queryParams).then(function(e){g.queryParams.pageCount=e.totalPage,g.list=e.items,g.table=new s({count:g.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),g.list}}),g.table.page(g.queryParams.page),g.loading=!1})}function m(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="Xóa ",n.message="Bạn muốn xóa promotion này?",n.ok=function(){l["delete"](e).then(function(e){e.success&&(g.queryParams.page=1,t.go(".",g.queryParams).then(function(){t.reload(),o.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa promotion thành công!"}})}))},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa promotion thất bại!"}})})}}]})}var g=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("promotion","view")||t.go("error403"),g.showBtnAdd=c.hasPermission("promotion","add"),g.showBtnEdit=c.hasPermission("promotion",["add","edit"]),g.showBtnDelete=c.hasPermission("promotion","delete"),g.loading=!0,g.queryParams=n,g.urlImg=settingJs.configs.uploadDirectory.product,g.remove=m,p(),u.onPagesChanged(d,e,g.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","promotionSvc"],angular.module("bzProduct").controller("promotionListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionEditCtrl=function(){function e(e,t,n,r,o,a,i,s){function u(){s.edit(d.queryParams.id).then(function(e){d.prom=e.prom;var t="";if(d.prom.expire_date){var n=moment(d.prom.expire_date.startDate).format("DD/MM/YYYY"),r=moment(d.prom.expire_date.endDate).format("DD/MM/YYYY");angular.extend(p,{startDate:n,endDate:r}),t=n+" - "+r}d.dateTimePickerOpt=p,a(function(){angular.element("#datetime-picker").val(t)},10),d.listProm=e.listProm,d.listProduct=e.products,d.product_apply=d.prom.product.map(function(e){return e._id}),d.loading=!1})["catch"](function(e){console.error(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function c(e){return e.$valid?(d.promExist=d.listProm.find(function(e){return e.name==d.prom.name}),void(d.promExist||(d.date&&(d.prom.expire_date=d.date),s.update({data:d.prom,product_apply:d.product_apply},d.queryParams.id).then(function(e){t.go("promotion-list"),r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa giảm giá sản phẩm thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa giảm giá sản phẩm thất bại!"}})})))):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function l(e){e.$submitted=!1}var d=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("promotion",["add","edit"])||t.go("error403"),d.loading=!0,d.queryParams=n;var p={singleDatePicker:!1};d.submit=c,d.removeDisabled=l,u()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","authSvc","promotionSvc"],angular.module("bzPromotion").controller("promotionEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),promotionAddCtrl=function(){function e(e,t,n,r,o,a,i,s){function u(){s.add().then(function(e){d.prom={type:"PC",status:!0},d.loading=!1,d.listProm=e.list,d.listProduct=e.products})["catch"](function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function c(e){return e.$valid?(d.promExist=d.listProm.find(function(e){return e.name==d.prom.name}),void(d.promExist||(d.prom.expire_date=d.date,s.create({data:d.prom,product_apply:d.product_apply}).then(function(e){t.go("promotion-list"),r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm giảm giá sản phẩm thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm giảm giá sản phẩm thất bại!"}})})))):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function l(e){e.$submitted=!1}var d=this;i.isSuperAdmin()||i.isAdmin()&&i.hasPermission("promotion","add")||t.go("error403"),d.loading=!0,d.queryParams=n,d.dateTimePickerOpt={singleDatePicker:!1},d.addPromotion=c,d.removeDisabled=l,u()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","authSvc","promotionSvc"],angular.module("bzPromotion").controller("promotionAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){e.vmPrL.queryParams.page=w.table.page(),t.go(".",e.vmPrL.queryParams)}function m(){l.getAll(w.queryParams).then(function(e){w.queryParams.pageCount=e.totalPage,w.totalItems=e.totalItems,w.list=e.items,w.categoryList=e.categoryList,w.optionsCate=P(e.categoryWithSub),w.tagList=e.tagList,w.productBalance=e.productBalance,w.filterTmp={status:w.queryParams.status},w.table=new s({count:w.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),w.list}}),w.table.page(w.queryParams.page),w.loading=!1})}function g(e){e.active=!e.active;var t=e.active?"bỏ công khai":"công khai";o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popTitle="",n.message="Bạn muốn "+t+" sản phẩm này?",n.ok=function(){l.activeProduct(e._id).then(function(t){e.active=!e.active,r.close()})}}]})}function h(e,n){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="Xóa ",n.message="Bạn muốn xóa sản phẩm này?",n.ok=function(){l.deleteProduct(e).then(function(e){e.success&&(w.queryParams.page=1,t.go(".",w.queryParams).then(function(){t.reload(),o.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa sản phẩm thành công!"}})}))},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa sản phẩm thất bại!"}})})}}]})}function f(e){w.queryParams.page=1,w.queryParams.status=w.filterTmp.status,t.go(".",w.queryParams).then(function(){t.reload()})}function v(){w.queryParams.name=null,w.queryParams.active=null,w.queryParams.category=null,w.queryParams.status=null,w.queryParams.tag=null,w.queryParams.dueDate=null,t.go(".",w.queryParams).then(function(){t.reload()})}function y(e){if(e){var t=moment();return e=moment(e),moment(t).isBefore(e)}}function b(e){return e.tag_processing.concat(e.tag_product)}function P(e){var t=[],n=function r(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return r(e,t)}),t};return e.forEach(function(e){var r=n(e,[]);e.sub_cate=r.splice(1),t.push(e)}),t}function T(e){return $("<div />").html(e.replace(/(<([^>]+)>)/g,"")).text()}function C(e){if(w.btnExport=!0,e)var t=[["Tên sản phẩm","Danh mục","Danh mục con","Đơn vị","Publish","Trạng thái","Mô tả ngắn","Thông tin chi tiết"]];else var t=[["STT","Tên sản phẩm","Đơn giá","Giá khuyến mãi","Danh mục","Danh mục con","Đơn vị","Đơn vị hiển thị","Publish"]];var n={type:"xlsx",sheetName:"SheetJS1",fileName:"Product"},o=JSON.parse(JSON.stringify(w.queryParams));o.limit=w.totalItems,o.page=1,l.getAll(o).then(function(r){r.items.forEach(function(n,r){var o="",a="",i=[];n.category_list.forEach(function(e,t){var n="";if(0!=t&&(n+=", "),e.parrent_id){var r=l.getCategoryParent(e);i.indexOf(r.name)==-1&&(i.push(r.name),o+=n+r.name),a+=n+e.name}else o+=n+e.name});var s="";if(n.promotion)switch(n.promotion.type){case"PC":s=n.price*(100-n.promotion.value)/100;break;case"MN":s=n.price-n.promotion.value}var u="";0==n.qty_in_stock&&(u="Hết hàng"),0<n.qty_in_stock&&n.qty_in_stock<=w.productBalance.value&&(u="Sắp hết hàng"),n.qty_in_stock>w.productBalance.value&&(u="Còn hàng"),e?t.push([n.name,o,a,n.unit.name,n.active?"Có":"Không",u,T(n.short_description),T(n.detail_infor)]):t.push([r+1,n.name,n.price,s,o,a,n.unit.name,n.view_unit,n.active?"Có":"Không"])}),ExcelJs.exportExcel(t,n),w.btnExport=!1})["catch"](function(e){console.log(e),w.btnExport=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất Excel thất bại!"}})})}var w=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("product","view")||t.go("error403"),w.showBtnAdd=c.hasPermission("product","add"),w.showBtnEdit=c.hasPermission("product",["add","edit"]),w.showBtnDelete=c.hasPermission("product","delete"),w.loading=!0,w.queryParams=n,w.setting=settingJs,w.urlImg=settingJs.configs.uploadDirectory.thumb_product,w.statusProduct=d,w.btnExport=!1,w.activeProduct=g,w.deleteProduct=h,w.filterForm=f,w.clearFilter=v,w.dueDate=y,w.formatTag=b,w.checkImgOld=l.checkImgOld,w.exportExcel=C,m(),u.onPagesChanged(p,e,w.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","productSvc","statusProduct"],angular.module("bzProduct").controller("productListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){u.getProductByID(H.queryParams.id).then(function(e){H.productTmp={},H.optionsCate=m(e.categoryWithSub),H.unitList=e.unit,H.product=e.product,H.product.videos=e.product.videos?e.product.videos:[],H.product.video=e.product.videos.length>0?e.product.videos[0].url:"",H.product.thumb&&(H.productTmp.thumb=u.thumbToImage(H.product.thumb)),H.categoryList=e.categoryList,H.promotionList=e.promotionList,H.certificateList=e.certificateList,H.tags_proccess=e.tags_proccess,H.tmp_tag_proccessing=H.product.tag_processing.map(function(e){return e.id_tag});var t={singleDatePicker:!1},n="";if(H.product.due_date){var r=moment(H.product.due_date.start_date).format("DD/MM/YYYY"),o=moment(H.product.due_date.end_date).format("DD/MM/YYYY");angular.extend(t,{startDate:r,endDate:o}),n=r+" - "+o}H.dateTimePickerOpt=t,H.showDateTime=!0,a(function(){angular.element("#datetime-picker").val(n)},10),H.active_tmp=H.product.active?"1":"0",H.vat_tmp=H.product.vat?"1":"0",H.productList=e.productList,H.productBalance=e.productBalance?e.productBalance.value:3,H.imgDelete=[],H.product.detail_infor=u.fixImgProductDetail(H.product.detail_infor),h(),H.loading=!1})["catch"](function(e){console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function m(e){var t=[],n=function r(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return r(e,t)}),t};return e.forEach(function(e){var r=n(e,[]);e.sub_cate=r.splice(1),t.push(e)}),t}function g(){return H.product.qty_in_stock<H.productBalance?void(H.product.status="SHH"):H.product.qty_in_stock>=H.productBalance?void(H.product.status="CH"):void 0}function h(){H.units_name=H.unitList.find(function(e){return H.product.id_unit===e._id})}function f(e){var t=H.product.relative_product.indexOf(e._id);t>-1&&(H.product.relative_product.splice(t,1),a(function(){var t=$('#mod-product-edit .content .select2-search-choice:contains("'+e.name+'")');t.find(".select2-search-choice-close").trigger("click")},10))}function v(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type)return void r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});c.imageDimensions(t[0]).then(function(n){n.width>448&&n.height>448?c.upload({url:o.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"product_image",prefix:"product_image"}}).then(function(t){H.product.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh lỗi!"}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)}):r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có kích thước lớn hơn 448px x 448px!"}})})}}function y(e){H.product.slug=u.changeToSlug(e)}function b(e){return e.$valid?(H.product.active="1"==H.active_tmp,H.product.vat="1"==H.vat_tmp,H.productTmp.due_date&&(H.product.due_date={start_date:H.productTmp.due_date.startDate,end_date:H.productTmp.due_date.endDate}),H.product.video&&(H.product.video=u.formatYoutube(H.product.video),H.product.videos=[{url:H.product.video}],delete H.product.video),H.productTmp.thumb&&u.imageToThumb(H.productTmp.thumb)!=H.product.thumb&&(H.product.thumb=H.productTmp.thumb),void u.updateProduct({data:H.product,imgDelete:H.imgDelete},H.product._id).then(function(e){1==e.success&&(t.go("product"),r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa sản phẩm thành công!"}}))})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa sản phẩm thất bại. Hãy thử lại"}})})):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng nhập đầy đủ thông tin."}})}function P(e,t,n){H.imgDelete.push({url:t,fileName:n}),H.product.images.splice(e,1)}function T(e){e&&(e.$submitted=!1)}function C(e){e&&(H.product.tag_processing=e.map(function(e){return{id_tag:e}}))}function w(e,t){i.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popupScope={image:H.urlImg+t.url,event:"crop:image",ratio:1,width:500,height:500},n.$on("crop:image",function(n,o){u.uploadBase64({directory:"product_image",image:o.image}).then(function(n){var o=t.url;H.imgDelete.push({url:H.urlImg,fileName:t.url}),H.product.images[e].url=n.name,H.productTmp.thumb==o&&S(e),r.close()})})}]})}function S(e){H.productTmp.thumb=H.product.images[e].url}function _(e){var t=e.name;return e.status||(t+=" (Unactive)"),t}var H=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("product",["add","edit"])||t.go("error403"),H.queryParams=n,H.loading=!0,H.urlImg=settingJs.configs.uploadDirectory.product,H.ckeOpt=l,H.statusProduct=d,H.submitForm=b,H.getNameTag=h,H.uploadImage=v,H.removeRelated=f,H.changeStatus=g,H.removeDisabled=T,H.removeImage=P,H.addTagProccess=C,H.checkSlug=y,H.cropImage=w,H.selectThumb=S,H.checkImgOld=u.checkImgOld,H.checkActiveOnsale=_,H.fixImgProductDetail=u.fixImgProductDetail,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","$uibModal","authSvc","productSvc","Upload","CKEditorOptPro","statusProduct"],angular.module("bzProduct").controller("productEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),productAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){u.add().then(function(e){H.optionsCate=g(e.categoryWithSub),H.relatedProduct=[],H.unitList=e.unit,H.productList=e.productList,H.categoryList=e.categoryList,H.promotionList=e.promotionList,H.certificateList=e.certificateList,H.tags_proccess=e.tags_proccess,H.active_tmp="1",H.vat_tmp="1",H.productTmp={},angular.element("#datetime-picker").val(""),H.productBalance=e.productBalance?e.productBalance.value:3,H.product={active:!0,slug:"",videos:[],status:"HSV",images:[],relative_product:[],other_is:!1,id_unit:null,qty_in_stock:0},H.loading=!1,H.imgDelete=[],a(function(){var e=$("#mod-product-add .content .select2-search-choice");e.find(".select2-search-choice-close").trigger("click")},10),f()})["catch"](function(e){console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Có vấn đề! Hãy thử tải lại trang."}})})}function m(e){H.product.slug=u.changeToSlug(e)}function g(e){var t=[],n=function r(e,t){return t.push(e),e.sub_category&&e.sub_category.length>0&&e.sub_category.forEach(function(e){return r(e,t)}),t};return e.forEach(function(e){var r=n(e,[]);e.sub_cate=r.splice(1),t.push(e)}),t}function h(){return H.product.qty_in_stock<H.productBalance?void(H.product.status="SHH"):H.product.qty_in_stock>=H.productBalance?void(H.product.status="CH"):void 0}function f(){H.units_name=H.unitList.find(function(e){return H.product.id_unit===e._id})}function v(e){var t=H.product.relative_product.indexOf(e._id);t>-1&&(H.product.relative_product.splice(t,1),a(function(){var t=$('#mod-product-add .content .select2-search-choice:contains("'+e.name+'")');t.find(".select2-search-choice-close").trigger("click")},10))}function y(t){if(t.length>0){if("image/png"!=t[0].type&&"image/jpeg"!=t[0].type)return void r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});c.imageDimensions(t[0]).then(function(n){n.width>448&&n.height>448?c.upload({url:o.settings.services.uploadApi+"/upload/file",data:{file:t[0],type:"product_image",prefix:"product_image"}}).then(function(t){H.product.images.push({url:t.data.filename}),e.progressPercentage=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(t){e.progressPercentage=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh Lỗi!"}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)}):r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có kích thước lớn hơn 448px x 448px!"}})})}}function b(e){return e.$valid?(H.product.active="1"==H.active_tmp,H.productTmp.due_date&&(H.product.due_date={start_date:H.productTmp.due_date.startDate,end_date:H.productTmp.due_date.endDate}),H.product.video&&(H.product.video=u.formatYoutube(H.product.video),H.product.videos.push({url:H.product.video}),delete H.product.video),H.productTmp.thumb&&(H.product.thumb=H.productTmp.thumb),void u.create({data:H.product,imageDelete:H.imgDelete}).then(function(e){t.go("product"),r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm sản phẩm thành công!"}})})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm sản phẩm thất bại. Hãy thử lại!"}})})):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin."}})}function P(e,t,n){H.product.images.splice(e,1),H.imgDelete.push({url:t,fileName:fileName})}function T(e){e&&(e.$submitted=!1)}function C(e){e&&(H.product.tag_processing=e.map(function(e){return{id_tag:e}}))}function w(e,t){i.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popupScope={image:H.urlUploadImg+t.url,event:"crop:image",ratio:1,width:500,height:500},n.$on("crop:image",function(n,o){u.uploadBase64({directory:"product_image",image:o.image}).then(function(n){var o=t.url;H.imgDelete.push({url:H.urlUploadImg,fileName:t.url}),H.product.images[e].url=n.name,H.productTmp.thumb==o&&S(e),r.close()})})}]})}function S(e){H.productTmp.thumb=H.product.images[e].url}function _(e){var t=e.name;return e.status||(t+=" (Unactive)"),t}var H=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("product","add")||t.go("error403"),H.loading=!0,H.queryParams=n,H.urlUploadImg=settingJs.configs.uploadDirectory.product,H.ckeOpt=l,H.statusProduct=d,H.dateTimePickerOpt={singleDatePicker:!1},H.addProduct=b,H.getNameTag=f,H.uploadImage=y,H.removeProductRelated=v,H.changeStatusProduct=h,H.removeDisabledSubmit=T,H.removeImage=P,H.addTagProccess=C,H.checkSlug=m,H.cropImage=w,H.selectThumb=S,H.checkImgOld=u.checkImgOld,H.checkActiveOnsale=_,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$window","$timeout","$uibModal","authSvc","productSvc","Upload","CKEditorOptPro","statusProduct"],angular.module("bzProduct").controller("productAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderReportCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){var e={singleDatePicker:!1};if(y.queryParams.date){var t=y.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(y.queryParams.date)}y.dateTimePickerOpt=e,c.api(a.settings.services.admin+"/order").get(y.queryParams,function(e){y.queryParams.pageCount=e.totalPage,y.list=e.items,y.params=e.params,y.statusOrderList=l,y.listCoupon=e.listCoupon,y.filter={},y.queryParams.min_order&&(y.filter.min_order=y.queryParams.min_order?parseInt(y.queryParams.min_order):void 0),y.queryParams.max_order&&(y.filter.max_order=y.queryParams.max_order?parseInt(y.queryParams.max_order):void 0),y.table=new i({count:y.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),y.list}}),y.table.page(y.queryParams.page),y.loading=!1})}function m(e){return y.statusOrderList.find(function(t){return e.status==t.value})}function g(e){y.queryParams.page=1,y.filter.date&&(y.queryParams.date=f(y.filter.date.startDate)+" - "+f(y.filter.date.endDate)),y.queryParams.min_order=y.filter.min_order,y.queryParams.max_order=y.filter.max_order,t.go(".",y.queryParams).then(function(){t.reload()})}function h(){y.queryParams.customer_name=null,y.queryParams.coupon=null,y.queryParams.date=null,y.queryParams.status=null,y.queryParams.type=null,y.queryParams.min_order=null,y.queryParams.max_order=null,t.go(".",y.queryParams).then(function(){t.reload()})}function f(e){return e.format("DD/MM/YYYY")}function v(e){var t=[["Mã đơn hàng","Ngày đặt hàng","Tên khách hàng","SĐT","Quận","Địa chỉ","Sản phẩm","Số lượng","Số lượng thực giao","Đơn giá","Giảm giá","Tổng tiền khách đặt","Phí ship","Ngày Giao Hàng","Đợt giao hàng","Đơn vị giao hàng","Ghi chú đơn hàng","Trạng thái đơn hàng"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"};e.forEach(function(e){e.order_detail.forEach(function(n){var r="";if(n.id_promote&&n.id_promote.id)switch(n.id_promote.type){case"MN":r+=n.id_promote.value+" Đ";break;case"PC":r+=n.id_promote.value+" %";break;default:r+=n.id_promote.value+" %"}t.push([e.id_order,moment(e.createdAt).format("D/M/YYYY"),e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.district,e.payment_info.info.address,n.product.name,n.order_quantity,"",d.formatCurrency(n.price),r,d.formatCurrency(n.total),d.formatCurrency(e.payment_info.info.shipping_fee),moment(e.ship_date).format("D/M/YYYY"),"Đợt 1",e.shiper,e.note,m(e).name])})}),ExcelJs.exportExcel(t,n)}var y=this;u.isSuperAdmin()||u.isAdmin()&&u.hasPermission("order","export")||t.go("error403"),y.loading=!0,y.queryParams=n,y.statusOrderList=l,y.getStatusOrder=m,y.filterForm=g,y.clearFilter=h,y.exportExcel=v,p(),s.onPagesChanged(function(){e.vmOrR.queryParams.page=y.table.page(),t.go(".",e.vmOrR.queryParams)},e,y.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","statusOrderList","orderSvc"],angular.module("bzOrder").controller("orderReportCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){w.list.forEach(function(e){e.value_checkbox=w.checkbox.selectAll})}function g(){var e=new Image,t=angular.element("#image")[0],n=t.getContext("2d");e.src="/assets/admin/images/mhv.jpg",e.onload=function(){t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),w.dataURLImage=t.toDataURL()};var r={singleDatePicker:!1};if(w.queryParams.date){var o=w.queryParams.date.split(" - ");angular.extend(r,{startDate:o[0],endDate:o[1]}),angular.element("#datetime-picker").val(w.queryParams.date)}w.dateTimePickerOpt=r,p.getAll(w.queryParams).then(function(e){w.queryParams.pageCount=e.totalPage,w.list=e.items,w.params=e.params,w.statusOrderList=d,w.listCoupon=e.listCoupon,w.coupon_order=e.coupon_order,w.filter={},w.checkbox={selectAll:!1},w.list.forEach(function(e){e.value_checkbox=!1}),w.queryParams.min_order&&(w.filter.min_order=w.queryParams.min_order?parseInt(w.queryParams.min_order):void 0),w.queryParams.max_order&&(w.filter.max_order=w.queryParams.max_order?parseInt(w.queryParams.max_order):void 0),w.queryParams.coupon&&(w.couponDetail=w.listCoupon.find(function(e){return e._id==w.queryParams.coupon})),w.table=new s({count:w.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),w.list}}),w.table.page(w.queryParams.page),w.loading=!1})}function h(e){var t=a.open({animation:!0,templateUrl:"modules/admin-order/view/client/popup-order/detail-order/view.html",controller:"popupOrderCtrl",resolve:{order:function(){return angular.copy(e)},permission:function(){return angular.copy(w.showBtnEdit)}}});t.result.then(function(t){angular.extend(e,t)},function(){})}function f(e){return w.statusOrderList.find(function(t){return e.status==t.value})}function v(e){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,r){
t.popTitle="Xóa ",t.message="Bạn muốn xóa đơn hàng này?",t.ok=function(){p["delete"](e).then(function(e){e.success&&(w.queryParams.page=1,n.go(".",w.queryParams).then(function(){n.reload()}),r.close(),o.toastr({type:"success",data:{title:"Thành công!",message:"Xóa đơn hàng thành công!"}}))},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa đơn hàng thất bại!"}})})}}]})}function y(e){w.queryParams.page=1,w.filter.date&&(w.queryParams.date=P(w.filter.date.startDate)+" - "+P(w.filter.date.endDate)),w.queryParams.min_order=w.filter.min_order,w.queryParams.max_order=w.filter.max_order,n.go(".",w.queryParams).then(function(){n.reload()})}function b(){w.queryParams.customer_name=null,w.queryParams.coupon=null,w.queryParams.date=null,w.queryParams.status=null,w.queryParams.type=null,w.queryParams.type=null,w.queryParams.min_order=null,w.queryParams.max_order=null,n.go(".",w.queryParams).then(function(){n.reload()})}function P(e){return e.format("DD/MM/YYYY")}function T(e){var t=[["Mã đơn hàng","Ngày đặt hàng","Tên khách hàng","SĐT","Quận","Địa chỉ","Sản phẩm","Số lượng","Số lượng thực giao","Đơn giá","Giảm giá","Tổng tiền khách đặt","Phí ship","Ngày Giao Hàng","Đợt giao hàng","Đơn vị giao hàng","Ghi chú đơn hàng","Trạng thái đơn hàng"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"};e.forEach(function(e){e.order_detail.forEach(function(n){var r="";if(n.promotion)switch(n.promotion.type){case"MN":r+=n.promotion.value+" Đ";break;case"PC":r+=n.promotion.value+" %";break;default:r+=n.promotion.value+" %"}t.push([e.id_order,moment(e.createdAt).format("D/M/YYYY"),e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.district,e.payment_info.info.address,n.product.name,n.order_quantity,"",n.price,r,n.total,e.shipping_fee?e.shipping_fee.fee:"",moment(e.ship_date).format("D/M/YYYY"),"Đợt 1",e.shiper,e.note,f(e).name])})}),ExcelJs.exportExcel(t,n)}function $(){l.api(i.settings.services.admin+"/configs").get({},function(e){t.promotionForOrderDeleveryOnAffternoon=e.OrderDeleveryOnAffernoon,t.promotionForFirstOrder=e.FirstOrder,t.freeShipUrban=e.FreeShipConfig.Urban,t.freeShipSuburb=e.FreeShipConfig.Suburb}),function(e){}}function T(e){w.btnExportExcel=!0;var t=[["Mã coupon","Tên coupon"],[w.couponDetail.code,w.couponDetail.name],["STT","Order id","Name","SĐT","Email","Địa chỉ giao hàng","Thời gian order","Phí vận chuyển","Tổng tiền order","Giá trị coupon","Trạng thái order"]],n={type:"xlsx",sheetName:"SheetJS1",fileName:"Order"},r=JSON.parse(JSON.stringify(w.queryParams));r.limit=w.totalItems,r.page=1,p.getAll(r).then(function(e){e.items.forEach(function(e,n){t.push([n+1,e.id_order,e.payment_info.info.full_name,e.payment_info.info.phone,e.payment_info.info.email,e.payment_info.info.address+"- "+e.payment_info.info.district,e.createdAt,e.payment_info.info.shipping_fee+" đ",e.total,e.coupon.value,f(e).name])}),ExcelJs.exportExcel(t,n),w.btnExportExcel=!1})["catch"](function(e){console.log(e),w.btnExportExcel=!1,o.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất Excel thất bại!"}})})}function C(){w.btnExportPDF=!0;var e=[],n={textGreen:{color:"#00a65a",bold:!0},textRed:{color:"#dd4b39"}},r={},a=0,i=[];try{w.list.forEach(function(n,r){if(n.value_checkbox){i.push(n);var o=[],s={table:{widths:["*","auto"],body:[[{text:"Mã hóa đơn: #"+n.id_order+"\nMã đơn hàng: #"+n.id_order+"\nNgày giao hàng: "+moment(n.createdAt).format("DD-MM-YYYY"),fillColor:"#737373",color:"white",margin:[5,5]},{image:w.dataURLImage,width:200,height:45,fillColor:"#737373",margin:[5,5]}]]},layout:"noBorders"};0!=a&&(s.pageBreak="before"),o.push(s),a++;var u="";n.payment_info.info.user_id&&(u+=n.payment_info.info.user_id.name,u+="\nSố điện thoại: ",u+=n.payment_info.info.user_id.phone?n.payment_info.info.user_id.phone:"",u+="\nEmail: ",u+=n.payment_info.info.user_id.email?n.payment_info.info.user_id.email:"");var c=n.payment_info.info.vocative||"undefined"!=n.payment_info.info.vocative?n.payment_info.info.vocative+" ":"";o.push({table:{widths:[248,248],headerRows:1,body:[[{text:"Thông tin mua hàng",fillColor:"#edebeb"},{text:"Thông tin nhận hàng",fillColor:"#edebeb"}],[{text:u,border:[!0,!1,!1,!0]},{text:c+n.payment_info.info.full_name+"\nSố điện thoại: "+n.payment_info.info.phone+"\nĐịa chỉ: "+n.payment_info.info.address+", "+n.payment_info.info.district,border:[!1,!0,!0,!0]}]]}}),o.push({text:"",margin:[0,0,0,20]}),o.push({table:{widths:[248,248],headerRows:1,body:[[{text:"Phương thức thanh toán",fillColor:"#edebeb"},{text:"Phương thức vận chuyển",fillColor:"#edebeb"}],[{text:"COD"==n.payment_method?"Thanh toán khi giao hàng (COD)":"Chuyển khoản",border:[!0,!1,!1,!0]},{text:[{text:0==n.payment_info.info.shipping_fee?"Miễn phí\n":""},{text:"(Phí vận chuyển "+p.formatCurrency(n.payment_info.info.shipping_fee)+" ₫)"}],border:[!1,!0,!0,!0]}]]}}),o.push({text:"",margin:[0,0,0,20]});var l=[[{text:"Sản phẩm",fillColor:"#edebeb",border:[!0,!0,!1,!0]},{text:"TL/ĐVT",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Số lượng",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Giá",fillColor:"#edebeb",border:[!1,!0,!1,!0],alignment:"right"},{text:"Tổng tiền",fillColor:"#edebeb",border:[!1,!0,!0,!0],alignment:"right"}]];n.order_detail.forEach(function(e){if(e.product){var t=e.price;e.id_promote&&("PC"==e.id_promote.type&&(t=t*(100-e.id_promote.value)/100),"MN"==e.id_promote.type&&(t-=e.id_promote.value)),l.push([{text:e.product.name,border:[!1,!1,!1,!1],margin:[0,0,0,5]},{text:e.product.view_unit?e.product.view_unit:"",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:e.order_quantity+"",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:p.formatCurrency(t)+" ₫",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]},{text:p.formatCurrency(e.total)+" ₫",border:[!1,!1,!1,!1],alignment:"right",margin:[0,0,0,5]}])}}),o.push({table:{widths:[206,80,60,60,63],headerRows:1,body:l}}),o.push({text:"",margin:[0,0,0,40]});var d=0==n.payment_info.info.shipping_fee?"(Miễn phí)":"",m=n.coupon.value,g=[["","Tổng cộng: ",p.formatCurrency(n.total)+" ₫"],["",{text:["Khuyến mãi: ",{text:n.id_coupon?"("+n.coupon.name+"): ":"",style:"textGreen"}]},{text:[{text:n.coupon.value>0?"-"+p.formatCurrency(n.coupon.value):0}," ₫"]}],["",{text:["Phí vận chuyển ",{text:d,style:"textRed"},":"]},p.formatCurrency(n.payment_info.info.shipping_fee)+" ₫"]];if("CHIEU"==n.delivery_time&&t.promotionForOrderDeleveryOnAffternoon.status){var h="PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*n.total:t.promotionForOrderDeleveryOnAffternoon.value;m+=h,g.push(["",{text:[{text:t.promotionForOrderDeleveryOnAffternoon.description,style:"textGreen"},": "]},"-"+p.formatCurrency(h)+" ₫"])}if(n.is_first_order){var h="MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*n.total;m+=h,g.push(["",{text:[{text:t.promotionForFirstOrder.description,style:"textGreen"},": "]},"-"+p.formatCurrency(h)+" ₫"])}n.shipping_fee&&("1"==n.shipping_fee.type&&n.total-m>t.freeShipUrban.value&&g.push([{text:[{text:t.freeShipUrban.description,style:"textGreen"}],colSpan:3}]),"2"==n.shipping_fee.type&&n.total-m>t.freeShipSuburb.value&&g.push([{text:[{text:t.freeShipSuburb.description,style:"textGreen"}],colSpan:3}])),g.push(["","Tổng tiền: ",p.formatCurrency(n.total_pay)+" ₫"]),o.push({table:{widths:[56,340,100],headerRows:1,body:g},alignment:"right",layout:"noBorders"}),o.push({text:n.note?"Ghi chú: "+n.note:""}),e.push(o)}});var s={content:e,styles:n,defaultStyle:r};0==a?o.toastr({type:"error",data:{title:"Chưa chọn hóa dơn!",message:"Vui lòng chọn hóa đơn bạn muốn xuất!"}}):1==a?pdfMake.createPdf(s).download(i[0].id_order+".pdf"):pdfMake.createPdf(s).download(moment(i[0].createdAt).format("DDMMYY")+".pdf"),w.btnExportPDF=!1}catch(u){w.btnExportPDF=!1,console.log(u),o.toastr({type:"error",data:{title:"Lỗi!",message:"Xuất PDF thất bại!"}})}}var w=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order","view")||n.go("error403"),w.showBtnAdd=c.hasPermission("order","add"),w.showBtnEdit=c.hasPermission("order",["add","edit"]),w.showBtnDelete=c.hasPermission("order","delete"),w.loading=!0,w.queryParams=r,w.statusOrderList=d,w.checkbox=[],w.detailOrderPop=h,w.getStatusOrder=f,w.deleteOrder=v,w.filterForm=y,w.clearFilter=b,w.exportExcel=T,w.selectAll=m,w.exportPDF=C,g(),$(),u.onPagesChanged(function(){e.vmOrL.queryParams.page=w.table.page(),n.go(".",e.vmOrL.queryParams)},e,w.table)}e.$inject=["$scope","$rootScope","$state","$stateParams","$bzPopup","$uibModal","$window","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","statusOrderList","orderSvc"],angular.module("bzOrder").controller("orderListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g,h,f,v){function y(){p.edit(M.queryParams.id).then(function(e){M.listCoupon=e.listCoupon;var t=[];M.listCoupon.forEach(function(e){if("single"==e.type&&t.push(e),"group"==e.type){var n=JSON.parse(JSON.stringify(e));e.code_group.forEach(function(e){angular.extend(n,e);var r=JSON.parse(JSON.stringify(n));t.push(r)})}}),M.listCoupon=t,M.listProduct=e.listProduct,M.listShippingFee=e.listShippingFee,M.listUser=e.listUser,M.order=e.order,M.order||n.go("error404"),M.loading=!1,b(),M.disabledOrder="CANCEL"==e.order.status,M.shippingTmp={fee:M.order.payment_info.info.shipping_fee?M.order.payment_info.info.shipping_fee:0},M.orderDetailTmp=M.listProduct.map(function(e){var t=M.order.order_detail.find(function(t){return t.product?t.product._id==e._id:null}),n=null;n=t?t.id_promote:e.promotion?{id:e.promotion._id,name:e.promotion.name,value:e.promotion.value,type:e.promotion.type}:null;var r=t?t.order_quantity:0;return{product_obj:e,product:e._id,order_quantity:t?t.order_quantity:1,price:t?t.price:e.price,total:t?t.total:0,id_promote:n,max_product:r+e.qty_in_stock}}),M.orderTmp={user:M.order.payment_info.info.user_id,shippingAddress:M.order.payment_info.info.id_shipping_address,coupon:M.listCoupon.find(function(e){return M.order.id_coupon==e._id}),orderDetailProduct:M.order.order_detail.map(function(e){return e.product?e.product._id:null}),status:e.order.status},M.dateTimePickerOpt={defaultDate:moment(M.order.ship_date).format("DD/MM/YYYY")},P(),M.order.payment_info.info.user_id&&M.userTmp&&(M.customerSignIn="true")})["catch"](function(e){console.log("error",e)})}function b(){M.order.payment_info.info.user_id&&(d.api(i.settings.services.admin+"/order/"+M.order.payment_info.info.user_id+"-"+M.order._id).get({},function(e){null==M.order.old_id&&(M.isFirstOder=e.success)}),function(e){console.log("checkFirstOrder",e)})}function P(e){var t=M.orderTmp.user;M.userTmp=M.listUser.find(function(e){return e._id==t}),M.userTmp&&(M.order.payment_info.info.user_id=M.userTmp._id,M.order.payment_info.info.email=M.userTmp.email,""!=M.order.payment_info.info.vocative&&M.order.payment_info.info.vocative||(M.order.payment_info.info.vocative=M.userTmp.vocative)),e&&(M.order.payment_info.info.district=null,M.orderTmp.shippingAddress=null),w()}function T(e){if(void 0==e&&(e=!1),M.order.id_coupon){var t={};M.listCoupon.forEach(function(e){M.order.id_coupon==e._id&&(t=e)}),p.checkCoupon(M.order,t.code).then(function(n){n.success?(M.order.id_coupon=t._id,M.order.coupon.value=n.money_coupon,M.order.coupon.code=t.code,M.order.coupon.name=t.name,e&&o.toastr({type:"success",data:{title:"Thành công",message:"Đơn hàng đang được giảm "+M.order.coupon.value+" đ"}})):(M.order.id_coupon=null,M.order.coupon.value=0,M.order.coupon.code="",M.order.coupon.name="",o.toastr({type:"error",data:{title:"Mã giảm giá",message:n.err.message}}))})["catch"](function(e){console.error(resp),o.toastr({type:"error",data:{title:"Mã giảm giá",message:resp.err.message}})})}else M.order.id_coupon=null,M.order.coupon.value=0,M.order.coupon.code="",M.order.coupon.name=""}function C(){if(M.userTmp){var e=M.order.payment_info.info.id_shipping_address,t=M.userTmp.customer.shipping_address.find(function(t){return e==t._id});t&&(M.order.shipping_fee=t.id_shipping_fee||null,angular.extend(M.order.payment_info.info,{id_shipping_address:t._id,full_name:t.name,phone:t.phone,address:t.address_detail,district:t.id_shipping_fee.district,shipping_fee:t.id_shipping_fee.fee}),M.order.id_shipping_fee=t.id_shipping_fee._id)}$(".fix-select-2-district").each(function(){var e=$(this);angular.element(document).injector().invoke(function(t){var n=angular.element(e).scope();t(e)(n)})}),w()}function w(){M.shippingTmp=M.listShippingFee.find(function(e){return e._id==M.order.id_shipping_fee}),"undefined"==typeof M.shippingTmp&&(M.shippingTmp={fee:M.order.payment_info.info.shipping_fee?M.order.payment_info.info.shipping_fee:0}),M.order.payment_info.info.shipping_fee=M.shippingTmp.fee,M.order.payment_info.info.district=M.shippingTmp.district,M.order.id_shipping_fee!=M.shippingTmp._id&&(M.order.payment_info.info.shipping_fee=M.shippingTmp.fee),M.order.id_shipping_fee=M.shippingTmp?M.shippingTmp._id:null;var e=M.totalNotOnSale()-M.order.coupon.value-("CHIEU"==M.order.delivery_time&&null==M.order.old_id?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*M.caculatingOnSaleAffternoon():t.promotionForOrderDeleveryOnAffternoon.value:0)-(M.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*M.totalNotOnSale():0);M.freeShip="NOT","CN"==M.order.delivery_type&&null==M.order.old_id&&("1"==M.shippingTmp.type&&e>t.freeShipUrban.value&&(M.freeShip="Urban",M.order.payment_info.info.shipping_fee=0),"2"==M.shippingTmp.type&&e>t.freeShipSuburb.value&&(M.order.payment_info.info.shipping_fee=0,M.freeShip="Suburb"))}function S(){M.order.order_detail=[],M.orderTmp.orderDetailProduct&&(M.order.order_detail=M.orderTmp.orderDetailProduct.map(function(e){var t=M.orderDetailTmp.find(function(t){return t.product===e});return t}))}function _(e){M.order.total=M.order.order_detail.reduce(function(e,t){t.id_promote?t.total=H(t.price,t.id_promote,t.order_quantity):t.total=H(t.price,0,t.order_quantity);var n=isNaN(t.total)?0:t.total;return e+n},0),T()}function H(e,t,n){return t?"PC"==t.type?e*(100-t.value)/100*n:"MN"==t.type?(e-t.value)*n:void 0:e*n}function A(e){if(M.submitted=!0,!e.$valid)return void o.toastr({type:"error",data:{title:"Cập nhật đơn hàng",message:"Dữ liệu chưa hợp lệ"}});if(M.order.total_pay=M.totalNotOnSale()+M.order.payment_info.info.shipping_fee-M.order.coupon.value-("CHIEU"==M.order.delivery_time?"PC"==t.promotionForOrderDeleveryOnAffternoon.type?t.promotionForOrderDeleveryOnAffternoon.value/100*M.caculatingOnSaleAffternoon():t.promotionForOrderDeleveryOnAffternoon.value:0)-(M.isFirstOder?"MN"==t.promotionForFirstOrder.type?t.promotionForFirstOrder.value:t.promotionForFirstOrder.value/100*M.totalNotOnSale():0),""!=M.order.id_coupon&&M.order.id_coupon){var n={};M.listCoupon.forEach(function(e){M.order.id_coupon==e._id&&(n=e)}),p.checkCoupon(M.order,n.code).then(function(e){e.success?D():(M.order.id_coupon=null,M.order.coupon.value=0,M.order.coupon.code="",M.order.coupon.name="",o.toastr({type:"error",data:{title:"Mã giảm giá",message:e.err.message}}))})["catch"](function(e){console.log(111,e)})}else D()}function D(){p.update({order:M.order,coupon:M.orderTmp.coupon},M.order._id).then(function(e){M.submitted=!1,e.success?(o.toastr({type:"success",data:{title:"Thành công!",message:"Cập nhật đơn hàng thành công!"}}),n.go("order-list")):(M.submitted=!1,o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}}))},function(e){console.log(e),o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}}),M.submitted=!1})}function k(e){e&&(M.submitted=!1)}function z(){"CT"==M.order.delivery_type?M.order.payment_info.info.shipping_fee=0:w()}function L(e){if(M.order.payment_info.info.user_id&&e.$valid){var t=M.order.payment_info.info,n={id_shipping_fee:M.order.id_shipping_fee,name:t.full_name,phone:t.phone,vocative:t.vocative,address_detail:t.address};d.api(i.settings.services.apiUrl+"/user/:id",{id:"@id"}).get({id:M.order.payment_info.info.user_id},function(e){var r=e;delete r.__v,delete r.password_token,delete r.created,delete r.provider,delete r.activeToken,r.cfpassword=r.password,r.dob||(r.dob=""),r.customer.shipping_address.forEach(function(a,i){if(a._id==M.order.payment_info.info.id_shipping_address){var s=r.customer.shipping_address[i];angular.extend(r.customer.shipping_address[i],n),angular.equals(r.customer.shipping_address[i],s)&&m.update(r,r._id).then(function(e){M.userTmp.customer.shipping_address.forEach(function(e,r){t.id_shipping_address==e._id&&angular.extend(M.userTmp.customer.shipping_address[r],n)})})["catch"](function(t){o.toastr({type:"error",data:{title:"Cập nhật địa chỉ giao hàng!",message:e.data.message}})})}})},function(e){o.toastr({type:"error",data:{title:"Cập nhật địa chỉ giao hàng!",message:"Không thể thấy tài khoản"}})})}}function q(){d.api(i.settings.services.admin+"/configs").get({},function(e){t.promotionForOrderDeleveryOnAffternoon=e.OrderDeleveryOnAffernoon,M.listIdCateOnsaleAffternoon=t.promotionForOrderDeleveryOnAffternoon.listCateApply,M.listCateException=t.promotionForOrderDeleveryOnAffternoon.listCateException,t.promotionForFirstOrder=e.FirstOrder,t.freeShipUrban=e.FreeShipConfig.Urban,t.freeShipSuburb=e.FreeShipConfig.Suburb}),function(e){}}function E(e,t){var n;return t.length>e.length&&(n=t,t=e,e=n),e.filter(function(e){return t.indexOf(e)>-1})}function R(){var e=0;return M.order.order_detail.forEach(function(t,n){var r=null;"object"===_typeof(t.product)&&(r=t.product.category.map(function(e){return""+e})),"object"===_typeof(t.product_obj)&&(r=t.product_obj.category.map(function(e){return""+e})),r&&E(r,M.listIdCateOnsaleAffternoon).length>0&&("object"===_typeof(t.id_promote)&&t.id_promote&&null==t.id_promote.id||"object"===_typeof(t.product_obj)&&null==t.product_obj.id_promotion)&&0==E(r,M.listCateException).length&&(e+=t.total)}),e}function F(){var e=0;return M.order.order_detail.forEach(function(t,n){t.id_promote&&null==t.id_promote.id&&(e+=t.total)}),e}function x(){if("CANCEL"==M.orderTmp.status){var e=a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,t){e.popTitle="Hủy",e.message="Bạn muốn hủy đơn hàng này?",e.ok=function(){M.order.status=M.orderTmp.status,D(),t.close()}}]});e.result.then(function(e){},function(){M.orderTmp.status=M.order.status})}else M.order.status=M.orderTmp.status}var M=this;l.isSuperAdmin()||l.isAdmin()&&l.hasPermission("order",["add","edit"])||n.go("error403"),M.loading=!0,M.queryParams=r,M.statusOrderList=g,M.urlImg=settingJs.configs.uploadDirectory.thumb_product,M.shipperList=h,M.freeShip="NOT",M.listVocative=v,M.isFirstOder=!1,M.customerSignIn="false",M.listIdCateOnsaleAffternoon=[],M.listCateException=[],M.getDataShippingFee=w,M.getOrderDetail=S,M.checkCoupon=T,M.setPaymentInfo=C,M.getDataUser=P,M.editOrder=A,M.setTotalProduct=_,M.enableForm=k,M.checkImgOld=f.checkImgOld,M.onChangeDeleveryType=z,M.onChangeDeleveryType=z,M.updateUserShippingAdress=L,M.checkStatus=x,M.caculatingOnSaleAffternoon=R,M.totalNotOnSale=F,q(),y()}e.$inject=["$scope","$rootScope","$state","$stateParams","$bzPopup","$uibModal","$window","$timeout","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","orderSvc","userSvc","statusOrderList","shipperList","productSvc","listVocative"],angular.module("bzOrder").controller("orderEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),orderAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g,h){function f(){d.add().then(function(e){_.listCoupon=e.listCoupon;var t=[];_.listCoupon.forEach(function(e){if("single"==e.type&&t.push(e),"group"==e.type){var n=JSON.parse(JSON.stringify(e));e.code_group.forEach(function(e){angular.extend(n,e);var r=JSON.parse(JSON.stringify(n));t.push(r)})}}),_.listCoupon=t,_.listProduct=e.listProduct,_.listShippingFee=e.listShippingFee,_.listUser=e.listUser,_.configNT=e.configNT,_.configNGT=e.configNGT,_.configBC=e.configBC,_.configDT=e.configDT,_.orderAddTmp={},_.shippingTmp={fee:0},_.isFirstOder=!1,_.orderDetailTmp=_.listProduct.map(function(e){return{product_obj:e,product:e._id,order_quantity:0,price:e.price,total:0,id_promote:e.promotion?{id:e.promotion._id,name:e.promotion.name,value:e.promotion.value,type:e.promotion.type}:null}}),_.orderAdd={delivery_type:"CN",delivery_time:"SANG",payment_method:"COD",type:"BT",payment_info:{info:{shipping_fee:0}},order_detail:[],total:0,status:_.statusOrderList[0].value,id_coupon:null,shiper:_.shipperList[0].value,coupon:{value:0,code:"",name:""}},_.loading=!1})}function v(e){if(void 0==e&&(e=!1),_.orderAdd&&""!=_.orderAdd.id_coupon){var t={};_.listCoupon.forEach(function(e){_.orderAdd.id_coupon==e._id&&(t=e)}),d.checkCoupon(_.orderAdd,t.code).then(function(n){n.success?(_.orderAdd.id_coupon=t._id,_.orderAdd.coupon.value=n.money_coupon,_.orderAdd.coupon.code=t.code,_.orderAdd.coupon.name=t.name,e&&r.toastr({type:"success",data:{title:"Thành công",message:"Đơn hàng đang được giảm "+_.orderAdd.coupon.value+" đ"}})):(_.orderAdd.id_coupon=null,_.orderAdd.coupon.value=0,_.orderAdd.coupon.code="",_.orderAdd.coupon.name="",r.toastr({type:"error",data:{title:"Mã giảm giá",message:n.err.message}}))})["catch"](function(e){console.log(111,e)})}_.orderAdd&&(_.orderAddTmp.coupon=_.listCoupon.find(function(e){return _.orderAdd.id_coupon==e._id}),_.orderAdd.coupon=null,_.orderAddTmp.coupon&&(_.orderAdd.coupon={code:_.orderAddTmp.coupon.code,name:_.orderAddTmp.coupon.name,value:_.orderAddTmp.coupon.sale.is_money?_.orderAddTmp.coupon.sale.money_value:_.orderAddTmp.coupon.sale.percent_value,type:_.orderAddTmp.coupon.sale.is_money?"MN":"PC"}))}function y(){_.orderAdd.order_detail=[],_.orderAddTmp.orderDetailProduct&&(_.orderAdd.order_detail=_.orderAddTmp.orderDetailProduct.map(function(e){var t=_.orderDetailTmp.find(function(t){return t.product===e});return t}))}function b(){var e=_.orderAddTmp.shippingAddress,t=_.orderAddTmp.user.customer.shipping_address.find(function(t){return e==t._id});angular.extend(_.orderAdd.payment_info.info,{id_shipping_address:t._id,full_name:t.name,phone:t.phone,address:t.address_detail,district:t.id_shipping_fee.district,shipping_fee:t.id_shipping_fee.fee}),P()}function P(){var e=_.orderAdd.payment_info.info.district;_.shippingTmp=_.listShippingFee.find(function(t){return t.district==e}),_.orderAdd.id_shipping_fee=_.shippingTmp?_.shippingTmp._id:null}function T(e){var t=_.orderAddTmp.user;d.isFirstOrder(t._id).then(function(e){_.isFirstOder=e.isFirstOrder}),_.orderAdd.payment_info.info={user_id:t._id,email:t.email,vocative:t.vocative,shipping_fee:0},e&&(_.orderAdd.payment_info.info.district=null,_.orderAddTmp.shippingAddress=null,P())}function $(){_.orderAdd.total=_.orderAdd.order_detail.reduce(function(e,t){t.total=C(t.price,t.id_promote)*t.order_quantity;var n=isNaN(t.total)?0:t.total;return e+n},0),_.orderAdd.total_pay=_.orderAdd.total+_.orderAdd.payment_info.info.shipping_fee-_.orderAdd.coupon.value-("CHIEU"==_.orderAdd.delivery_time?"PC"==_.configBC.type?_.configBC.value/100*_.orderAdd.total:_.configBC.value:0)-(_.isFirstOder?"MN"==_.configDT.type?_.configDT.value:_.configDT.value/100*_.orderAdd.total:0)}function C(e,t){if(t){if("PC"==t.type)return e*(100-t.value)/100;if("MN"==t.type)return e-t.value}return e}function w(e){return e.$valid?_.orderAddTmp.shippingAddress?void d.create({data:_.orderAdd,coupon:_.orderAddTmp.coupon}).then(function(n){n.success?(e.$submitted=!1,console.log(n),r.toastr({type:"success",data:{title:"Thành công!",message:"Order thành công!"}}),t.go("order-list")):(e.$submitted=!1,console.log(n),r.toastr({type:"error",data:{title:"Lỗi!",message:"Order thất bại!"}}))},function(t){console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Order thất bại!"}}),e.$submitted=!1}):void r.toastr({type:"error",data:{title:"Thông tin địa chỉ giao hàng chưa hợp lệ",message:"Hãy thử lại"}}):void r.toastr({type:"error",data:{title:"Thông tin đơn hàng chưa hợp lệ",message:"Hãy thử lại"}})}function S(e){e&&(e.$submitted=!1)}var _=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("order","add")||t.go("error403"),_.loading=!0,_.queryParams=n,_.statusOrderList=p,_.shipperList=m,_.urlImg=settingJs.configs.uploadDirectory.thumb_product,_.dateTimePickerOpt={},_.customerSignIn="true",_.listVocative=h,_.getDataShippingFee=P,_.getOrderDetail=y,_.getCoupon=v,_.setPaymentInfo=b,_.setDataUser=T,_.addOrder=w,_.setTotalProduct=$,_.enableForm=S,_.checkImgOld=g.checkImgOld,f(),v()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$timeout","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","orderSvc","statusOrderList","shipperList","productSvc","listVocative"],angular.module("bzOrder").controller("orderAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),auditLogCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){p.getUsers({}).then(function(e){b.listUsers=e.data,b.listUsers.unshift({name:"Guest",_id:"guest"}),h()})["catch"](function(e){console.log(e)})}function g(e){b.detail=e;o.open({animation:!0,templateUrl:"modules/admin-log/view/client/popup/detail-log/view.html",controller:"popupLogCtrl",resolve:{detailLog:function(){return angular.copy(e)}}})}function h(){var e={singleDatePicker:!1};if(b.queryParams.date){var t=b.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(b.queryParams.date)}b.dateTimePickerOpt=e,p.getLog(b.queryParams).then(function(e){b.queryParams.pageCount=e.totalPage,b.list=e.items,b.table=new s({count:b.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),b.list}}),b.table.page(b.queryParams.page),b.loading=!1})}function f(e){b.queryParams.page=1,b.filter.date&&(b.queryParams.date=y(b.filter.date.startDate)+" - "+y(b.filter.date.endDate)),void 0!=b.filter.action&&(b.queryParams.action=b.filter.action),void 0!=b.filter.actor&&(b.queryParams.actor=b.filter.actor),b.filter.label&&(b.queryParams.label=b.filter.label),t.go(".",b.queryParams).then(function(){t.reload()})}function v(){b.queryParams.action="",b.queryParams.label="",b.queryParams.date=null,b.queryParams.actor=null,t.go(".",b.queryParams).then(function(){t.reload()})}function y(e){return e.format("DD/MM/YYYY")}var b=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("log",["view"])||t.go("error403"),b.loading=!0,b.queryParams=n,b.showPopupDetailLog=g,b.filter={action:b.queryParams.action?b.queryParams.action:null,actor:b.queryParams.actor?b.queryParams.actor:null,label:b.queryParams.label?b.queryParams.label:null},b.listResource=d,b.filterForm=f,b.clearFilter=v,b.getUsers=m,m(),u.onPagesChanged(function(){e.vmLog.queryParams.page=b.table.page(),t.go(".",e.vmLog.queryParams)},e,b.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$filter","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","listResource","auditLogSvc"],angular.module("bzAuditLog").controller("auditLogCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),importProductListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){var e={singleDatePicker:!1};if(v.queryParams.date){var t=v.queryParams.date.split(" - ");angular.extend(e,{startDate:t[0],endDate:t[1]}),angular.element("#datetime-picker").val(v.queryParams.date)}v.dateTimePickerOpt=e,d.getAll(v.queryParams).then(function(e){v.filter={},v.queryParams.pageCount=e.totalPage,v.list=e.items,v.params=e.params,v.queryParams.slug&&(v.filter.product=v.params.product.name),v.queryParams.product&&(v.filter.product=v.queryParams.product),v.table=new s({count:v.queryParams.limit},{counts:[],getData:function(t){return t.total(e.totalItems),v.list}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(e){v.queryParams.page=1,v.filter.date&&(v.queryParams.date=h(v.filter.date.startDate)+" - "+h(v.filter.date.endDate)),(v.filter.product||""===v.filter.product)&&(v.queryParams.product=v.filter.product),v.queryParams.slug&&(v.queryParams.slug=null),t.go(".",v.queryParams).then(function(){t.reload()})}function g(){v.queryParams.product=null,v.queryParams.slug=null,v.queryParams.date=null,t.go(".",v.queryParams).then(function(){t.reload()})}function h(e){return e.format("DD/MM/YYYY")}function f(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="",n.message="Bạn có chắc xoá lịch sử nhập hàng này?",n.ok=function(){e.qty_before>e.product.qty_in_stock?(o.close(),r.toastr({type:"error",data:{title:"Thất bại!",message:"Số lượng sản phẩm trong kho nhỏ hơn số lượng nhập hàng."}})):d.del(e._id).then(function(e){t.go(".",v.queryParams).then(function(){t.reload()}),o.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa lịch sử thành công!"}})})["catch"](function(e){o.close(),console.log(e),r.toastr({type:"err",data:{title:"Lỗi!",message:"Xóa lịch sử thành công!"}})})}}]})}var v=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("import_product","view")||t.go("error403"),v.showBtnAdd=c.hasPermission("import_product","add"),v.showBtnDelete=c.hasPermission("import_product","delete"),v.loading=!0,v.queryParams=n,v.filterForm=m,v.clearFilter=g,v.remove=f,p(),u.onPagesChanged(function(){e.vmIPr.queryParams.page=v.table.page(),t.go(".",e.vmIPr.queryParams)},e,v.table)}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","$filter","NgTableParams","ngTableEventsChannel","authSvc","bzResourceSvc","importProductSvc"],angular.module("bzImportProduct").controller("importProductListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),importProductEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u){function c(){u.edit(f.queryParams.id).then(function(e){f.productList=e.productList,f.supplierList=e.supplierList,f.importProduct=e.data,f.productDetail=e.data.product,f.minQty=f.productDetail.qty_in_stock<f.importProduct.qty_before?f.importProduct.qty_before-f.productDetail.qty_in_stock:0,f.tmpQty={},p()})["catch"](function(e){console.log(e)})}function l(e){f.showEditPrice=!f.showEditPrice}function d(){var e=f.importProduct.id_product;f.productList.forEach(function(t,n){if(t._id===e)return f.productDetail=t,f.importProduct.price_new=t.price,void(f.showEditPrice=!1)})}function p(){var e=f.importProduct.qty_before,t=f.importProduct.qty_after;isNaN(e)||isNaN(t)||(f.tmpQty.qty_number_after=Math.round(100*(e-t))/100,f.tmpQty.qty_percent_after=(f.tmpQty.qty_number_after/e*100).toFixed(2))}function m(e){f.importProduct.total_money_after=e*f.importProduct.price_new}function g(e){e&&(e.$submitted=!1)}function h(e){return e.$valid?(f.importProduct.price_old=f.productDetail.price,void u.update({data:f.importProduct,product:f.productDetail},f.queryParams.id).then(function(n){e.$submitted=!1,console.log(n),t.go("import-product"),r.toastr({type:"success",data:{title:"Thành công!",message:"Import product thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Import product thất bại!!"}})})):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin."}})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("import_product","add")||t.go("error403"),f.queryParams=n,f.editPrice=l,f.getDetailProduct=d,f.calcuteLost=p,f.calcuteTotalMoney=m,f.submitForm=h,f.enableForm=g,c()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","NgTableParams","ngTableEventsChannel","authSvc","importProductSvc"],angular.module("bzImportProduct").controller("importProductEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t
}}(),importProductCtrl=function(){function e(e,t,n,r,o,a,i,s,u){function c(){u.getDataImport().then(function(e){f.productList=e.productList,f.supplierList=e.supplierList,f.importProduct={id_supplier:f.supplierList[0]._id},f.productDetail={},f.tmpQty={}})["catch"](function(e){console.log(e)})}function l(e){f.showEditPrice=!f.showEditPrice}function d(){var e=f.importProduct.id_product;f.productList.forEach(function(t,n){if(t._id===e)return f.productDetail=t,f.importProduct.price_new=t.price,void(f.showEditPrice=!1)})}function p(){var e=f.importProduct.qty_before,t=f.importProduct.qty_after;isNaN(e)||isNaN(t)||(f.tmpQty.qty_number_after=Math.round(100*(e-t))/100,f.tmpQty.qty_percent_after=(f.tmpQty.qty_number_after/e*100).toFixed(2))}function m(e){f.importProduct.total_money_after=e*f.importProduct.price_new}function g(e){e&&(e.$submitted=!1)}function h(e){return e.$valid?(f.importProduct.price_old=f.productDetail.price,void u.importProduct({data:f.importProduct,product:f.productDetail}).then(function(n){e.$submitted=!1,t.go("import-product"),r.toastr({type:"success",data:{title:"Thành công!",message:"Import product thành công!"}})})["catch"](function(t){console.log(t),e.$submitted=!1,r.toastr({type:"error",data:{title:"Lỗi!",message:"Import product thất bại!!"}})})):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin."}})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("import_product","add")||t.go("error403"),f.queryParams=n,f.editPrice=l,f.getDetailProduct=d,f.calcuteLost=p,f.calcuteTotalMoney=m,f.submitForm=h,f.enableForm=g,c()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","NgTableParams","ngTableEventsChannel","authSvc","importProductSvc"],angular.module("bzImportProduct").controller("importProductCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),dashboardCtrl=function(){function e(e,t,n,r,o){var a=this;r.isSuperAdmin()||r.isAdmin()&&r.hasPermission("dashboard","view")||n.go("error403"),o.api(t.settings.services.admin+"/dashboard").get({},function(e){a.info=e})}e.$inject=["$scope","$window","$state","authSvc","bzResourceSvc"],angular.module("bzDashboard").controller("dashboardCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){d.getAll(v.queryParams,"single").then(function(e){v.queryParams.pageCount=e.totalPage,v.coupons=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.coupons}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự phiếu mua hàng thành công!"}})}function f(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/coupon/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa phiếu mua hàng thành công!"}}),n.reload(),a.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("coupon","add"),v.showBtnEdit=s.hasPermission("coupon",["add","edit"]),v.showBtnDelete=s.hasPermission("coupon","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=r,v.keyword=r.keyword,v.userRoles=i,v.coupons=[],v.filter=m,v.filterReset=g,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmCoupons.queryParams.page=v.table.page(),n.go(".",e.vmCoupons.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc"],angular.module("bzCoupon").controller("couponCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponGroupCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){d.getAll(P.queryParams,"group").then(function(e){P.queryParams.pageCount=e.totalPage,P.totalItems=e.totalItems,P.coupons=e.items,P.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),P.coupons}}),P.table.page(P.queryParams.page),P.loading=!1})}function m(e){n.go(".",{keyword:e,page:P.queryParams.page}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:P.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự phiếu mua hàng thành công!"}})}function f(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/coupon/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa phiếu mua hàng thành công!"}}),n.reload(),a.close()})}}]})}function v(){P.btnExport=!0;var e=[["Mã Coupon Group","Mã coupon"]],t={type:"xlsx",sheetName:"SheetJS1",fileName:"Coupon Group"},n=JSON.parse(JSON.stringify(P.queryParams));n.limit=P.totalItems,n.page=1,P.coupons.forEach(function(t){t.value_checkbox&&t.code_group.forEach(function(n){e.push([t.code,n.code])})}),1==e.length?o.toastr({type:"error",data:{title:"Chưa chọn mã giảm giá!",message:"Vui lòng chọn mã giảm giá bạn muốn xuất!"}}):ExcelJs.exportExcel(e,t),P.btnExport=!1}function y(){P.coupons.forEach(function(e){e.value_checkbox=P.checkbox.selectAll})}function b(e){var t=0;return e.order_group.forEach(function(e){Array.isArray(e)?t+=e.length:t++}),t}var P=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon","view")||n.go("error403"),P.showBtnAdd=s.hasPermission("coupon","add"),P.showBtnEdit=s.hasPermission("coupon",["add","edit"]),P.showBtnDelete=s.hasPermission("coupon","delete"),P.loading=!0,P.selectedItems=[],P.queryParams=r,P.keyword=r.keyword,P.userRoles=i,P.coupons=[],P.filter=m,P.filterReset=g,P.sort=h,P.remove=f,P.exportExcel=v,P.selectAll=y,P.sumOrder=b,p(),c.onPagesChanged(function(){e.vmCPG.queryParams.page=P.table.page(),n.go(".",e.vmCPG.queryParams)},e,P.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc"],angular.module("bzCoupon").controller("couponGroupCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m){function g(){var e=r.id;d.get(e).then(function(e){$.formData=e,$.tmp_count=e.count===!0?"1":"0",$.tmp_sale=e.sale.is_money===!0?"money":"percent","group"==$.formData.type&&($.tmp_code_group=$.formData.code_group.reduce(function(e,t){return e+","+t.code},""),$.tmp_code_group=$.tmp_code_group.substring(1))})["catch"](function(e){console.error("err",e),o.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:"Lỗi server"}})})}function h(){p.getAllNoPaging().then(function(e){$.district=e.items})["catch"](function(e){o.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:"Lỗi server"}})})}function f(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){$.listCategory=e.items})}function v(){m.add().then(function(e){$.listProduct=e.productList})}function y(){$.formData.code=$.formData.code.toUpperCase()}function b(e){if($.submitted=!0,$.lockForm=!0,e){var t=$.formData.code.split(",").concat($.tmp_code_group.split(","));d.checkIsset({data:t},$.params.id).then(function(e){e.isset?(o.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:"Đã tồn tại mã "+e.code}}),$.lockForm=!1):d.update($.formData,$.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Sửa phiếu mua hàng",message:"Thành công"}}),"group"==$.formData.type?n.go("coupon-group"):n.go("coupon-list")})["catch"](function(e){$.lockForm=!1,console.err("error",e),o.toastr({type:"error",data:{title:"Sửa phiếu mua hàng",message:e.data.message}})})})["catch"](function(e){console.error("Err",e),o.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm coupon bị lỗi"}}),$.lockForm=!1})}else $.submitted=!0,$.lockForm=!1}function P(){for(var e=5,t="123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",r=e;r>0;--r)n+=t[Math.round(Math.random()*(t.length-1))];$.formData.code=n}function T(){"money"===$.tmp_sale?($.formData.sale.is_money=!0,$.formData.sale.is_percent=!1,$.formData.sale.percent_value=""):($.formData.sale.is_money=!1,$.formData.sale.is_percent=!0,$.formData.sale.money_value="")}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon",["add","edit"])||n.go("error403"),$.lockFOrm=!1,$.submitted=!1,$.params=r,$.tmp_code_group="",$.optionTimePicker={timePicker:!0,timePickerIncrement:30,locale:{format:"h:mm DD/MM/YYYY"}},$.upCase=y,$.save=b,$.vmEditCoupons=g,$.randomString=P,$.checkSale=T,g(),h(),f(),v()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc","shippingfeeSvc","productSvc"],angular.module("bzCoupon").controller("couponEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),couponAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g){function h(){p.getAllNoPaging().then(function(e){C.district=e.items})["catch"](function(e){o.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:"Lỗi server"}})})}function f(){l.api(t.settings.services.admin+"/category").get({limit:100,page:1,parrent_id:"*"},function(e){C.listCategory=e.items})}function v(){g.add().then(function(e){C.listProduct=e.productList})}function y(){C.formData.code&&(C.formData.code=C.formData.code.toUpperCase())}function b(e){if(C.submitted=!0,C.lockForm=!0,C.formData.count="1"==C.tmp_count,console.log(C.formData),e){var t=C.formData.code.split(",").concat(C.tmp_code_group.split(","));"group"==C.formData.type&&(C.formData.code_group=C.tmp_code_group.split(",").map(function(e){return{code:e,user_times:C.formData.user_times,times:C.formData.times}})),d.checkIsset({data:t}).then(function(e){e.isset?(o.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:"Đã tồn tại mã "+e.code}}),C.lockForm=!1):d.create(C.formData).then(function(e){o.toastr({type:"success",data:{title:"Thành công",message:e.message}}),"group"==C.params.type?n.go("coupon-group"):n.go("coupon-list")})["catch"](function(e){console.err("Err",e),C.lockForm=!1,o.toastr({type:"error",data:{title:"Thêm phiếu mua hàng",message:e.data.message}})})})["catch"](function(e){console.error("Err",e),o.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm coupon bị lỗi"}}),C.lockForm=!1})}else C.submitted=!0,C.lockForm=!1}function P(){for(var e=5,t="123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",r=e;r>0;--r)n+=t[Math.round(Math.random()*(t.length-1))];C.formData.code=n}function T(){"money"===C.tmp_sale?(C.formData.sale.is_money=!0,C.formData.sale.is_percent=!1,C.formData.sale.percent_value=""):(C.formData.sale.is_money=!1,C.formData.sale.is_percent=!0,C.formData.sale.money_value="")}function $(){var e=a.open({animation:!0,templateUrl:"modules/admin-coupon/view/client/popup/add-many-coupon/add-many-coupon.html",controller:"popupGenaratorCodeCtrl",resolve:{data:function(){return angular.copy({})}}});e.result.then(function(e){C.formData.code=e.code,C.tmp_code_group=e.code_group},function(){})}var C=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("coupon","add")||n.go("error403"),C.lockForm=!1,C.submitted=!1,C.tmp_count="0",C.tmp_sale="money",C.optionTimePicker={timePicker:!0,timePickerIncrement:30,locale:{format:"h:mm DD/MM/YYYY"}},C.params=r,C.formData={status:"active",sale:{is_money:!0,is_percent:!1,percent_value:"",money_value:""},times:1,user_times:1,type:C.params.type?C.params.type:"single"},C.tmp_code_group="",C.upCase=y,C.save=b,C.randomString=P,C.checkSale=T,C.addManyCoupon=$,h(),f(),v()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","couponSvc","shippingfeeSvc","categorySvc","productSvc"],angular.module("bzCoupon").controller("couponAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/config").get(f.queryParams,function(e){f.queryParams.pageCount=e.totalPage,f.listSupplier=e.items,f.table=new u({count:parseInt(f.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),f.listSupplier}}),f.table.page(f.queryParams.page),f.loading=!1})}function m(e){n.go(".",{keyword:e,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:f.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/config/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Config",message:"Deleted!"}}),n.reload(),a.close()})}}]})}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["view"])||n.go("error403"),f.loading=!0,f.selectedItems=[],f.keyword=r.keyword,f.queryParams=r,f.userRoles=i,f.listSupplier=[],f.filter=m,f.filterReset=g,f.remove=h,p(),c.onPagesChanged(function(){e.vmListConfig.queryParams.page=f.table.page(),n.go(".",e.vmListConfig.queryParams)},e,f.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc"],angular.module("bzConfig").controller("configListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){var e=r.id;d.get(e).then(function(e){h.formData=e,h.formData.type||(h.formData.type="")})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data}})})}function g(e){h.submitted=!0,h.lockForm=!0,e?d.update(h.formData,h.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Config",message:"Cập nhật thành công"}}),n.go("configs")})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật config",message:e.data.message}})}):h.submitted=!0}var h=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["edit"])||n.go("error403"),h.lockFOrm=!1,h.save=g,h.vmEditConfig=m,h.submitted=!1,m()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc","bzUtilsSvc"],angular.module("bzConfig").controller("configEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),configAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(e){g.submitted=!0,g.lockForm=!0,e?d.create(g.formData).then(function(e){o.toastr({type:"success",data:{title:"Đơn vị",message:"Thêm thành công"}}),n.go("configs")})["catch"](function(e){o.toastr({type:"error",data:{title:"Config",message:e.data}})}):g.submitted=!0}var g=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("config",["add"])||n.go("error403"),g.formData={name:"",value:0,description:"",status:!0,type:""},g.lockFOrm=!1,g.save=m,g.submitted=!1}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","configSvc","bzUtilsSvc"],angular.module("bzConfig").controller("configAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/certificate").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.certificates=e.items,v.table=new u({count:20},{counts:[],getData:function(t){return t.total(e.totalItems),v.certificates}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(e){n.go(".",{keyword:e,page:v.queryParams.page}).then(function(){n.reload()})}function g(){n.go(".",{keyword:null,page:v.queryParams.page},{notify:!1}).then(function(){n.reload()})}function h(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự chứng chỉ thành công!"}})}function f(e){var r={ids:[e]};console.log("asd",e);a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/certificate/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa chứng chỉ thành công!"}}),n.reload(),a.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","view")||n.go("error403"),v.showBtnAdd=s.hasPermission("certificate","add"),v.showBtnEdit=s.hasPermission("certificate",["add","edit"]),v.showBtnDelete=s.hasPermission("certificate","delete"),v.loading=!0,v.selectedItems=[],v.queryParams=r,v.keyword=r.keyword,v.userRoles=i,v.certificates=[],v.imagesDerectory=settingJs.configs.uploadDirectory.certificate,v.filter=m,v.filterReset=g,v.sort=h,v.remove=f,p(),c.onPagesChanged(function(){e.vmCertificates.queryParams.page=v.table.page(),n.go(".",e.vmCertificates.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc"],angular.module("bzCertificate").controller("certificateCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(){var e=r.id;d.get(e).then(function(e){v.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function g(e){v.submitted=!0,v.lockForm=!0,e?d.update(v.formData,v.formData._id).then(function(e){o.toastr({type:"success",data:{title:"Chứng chỉ",message:"Sửa thành công"}}),n.go("certificate-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Cập nhật chứng chỉ",message:e.data.message}})}):v.submitted=!0}function h(e){v.formData.images.splice(e,1)}function f(n){if(n.length>0){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"certificate_image",prefix:"certificate_image"}}).then(function(t){v.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate",["add","edit"])||n.go("error403"),v.lockFOrm=!1,v.save=g,v.vmEditCertificates=m,v.submitted=!1,v.uploadImage=f,v.removeImage=h,v.imagesDirectory=settingJs.configs.uploadDirectory.certificate,m()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","Upload"],angular.module("bzCertificate").controller("certificateEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p){function m(e){f.submitted=!0,f.lockForm=!0,console.log(f.formData),e?d.create(f.formData).then(function(e){o.toastr({type:"success",data:{title:"Chứng chỉ ",message:"Thêm thành công"}}),n.go("certificate-list")})["catch"](function(e){o.toastr({type:"error",data:{title:"Thêm chứng chỉ ",message:e.data.message}})}):f.submitted=!0}function g(e){f.formData.images.splice(e,1)}function h(n){if(n.length>0){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"certificate_image",prefix:"certificate_image"}}).then(function(t){f.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var f=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","add")||n.go("error403"),f.formData={},f.lockFOrm=!1,f.save=m,f.submitted=!1,f.imagesDirectory=settingJs.configs.uploadDirectory.certificate,f.formData={name:"",description:"",images:[]},f.removeImage=g,f.uploadImage=h}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","Upload"],angular.module("bzCertificate").controller("certificateAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),certificateProductCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m){function g(){var e=r.id;l.api(t.settings.services.admin+"/certificate-product/:id").get(T.queryParams,{id:e},function(e){T.queryParams.pageCount=e.totalPage,T.listProductOfCer=e["in"],T.listProduct=e.nin,T.table=new u({count:T.queryParams.limit||10},{counts:[],getData:function(t){return t.total(e.totalItems),T.listProductOfCer}}),T.table.page(T.queryParams.page),T.loading=!1})}function h(){var e=r.id;d.get(e).then(function(e){T.certificate=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Getting",message:e.data.message}})})}function f(e){n.go(".",angular.extend(e,saleContact.queryParams),{notify:!1}).then(function(){n.reload()})}function v(){n.go(".",{publish:null,cateid:null,keyword:null,limit:settingJs.admin.itemPerPage},{notify:!1}).then(function(){n.reload()})}function y(e,t){o.toastr({type:"success",data:{title:"Cập nhật",message:"Cập nhật thứ tự chứng chỉ thành công!"}})}function b(e){if(T.submitted=!0,T.lockForm=!0,e)for(var t=function(){var e=T.productID[r];p.getProductById(e).then(function(t){var r=t;r.certificates.push(T.cerID),m.updateProduct({data:r},e).then(function(e){o.toastr({type:"success",data:{title:"Sản phẩm",message:"thêm vào nhãn thành công"}}),n.reload()})["catch"](function(e){o.toastr({type:"error",data:{title:"aaa",message:e.data.message}})})})},r=0;r<T.productID.length;r++)t();else T.submitted=!0,T.lockForm=!1}function P(e){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,r){t.popTitle="Xóa",t.message="Bạn chắc chắn sẽ xóa dữ liệu này?",t.ok=function(){p.getProductById(e).then(function(t){var a=t,i=0;a.certificates.find(function(e,t){return i=t,e==T.cerID});a.certificates.splice(i,1),m.updateProduct({data:a},e).then(function(e){o.toastr({type:"success",data:{title:"Sản phẩm",message:"Xóa sản phẩm thành công"}}),n.reload(),r.close()})["catch"](function(e){o.toastr({type:"error",data:{title:"Xóa sản phẩm thất bại",message:e.data.message}})})})}}]})}var T=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("certificate","view")||n.go("error403"),T.loading=!0,T.submitted=!1,T.lockForm=!1,T.queryParams=r,T.cerID=r.id,T.userRoles=i,T.certificates=[],T.imagesDerectory=settingJs.configs.uploadDirectory.product,T.filter=f,T.filterReset=v,T.sort=y,T.addCertificateProduct=b,T.delCertificateProduct=P,h(),g(),c.onPagesChanged(function(){e.vmCertificateProduct.queryParams.page=T.table.page(),n.go(".",e.vmCertificateProduct.queryParams)},e,T.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","certificateSvc","tagSvc","productSvc"],angular.module("bzCertificate").controller("certificateProductCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(e){null!=e.parrent_id?d.getById(e.parrent_id).then(function(e){b.listCategoriesParrent.push(e),p(e)})["catch"](function(e){o.toastr({type:"error",data:{title:"Danh mục sản phẩm cha",message:e.data.message}})}):(b.listCategoriesParrent.reverse(),g(b.query.parrentId))}function m(e){d.get(e).then(function(e){b.query.parrentId=e.category._id,b.categoriesParrent=e.category,p(e.category)})["catch"](function(e){o.toastr({type:"error",data:{title:"Danh mục sản phẩm cha",message:e.data.message}})})}function g(e){b.viewChild?l.api(t.settings.services.admin+"/category_child/"+e).get(b.queryParams,function(e){b.queryParams.pageCount=e.totalPage,b.listCategory=e.items,b.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),b.listCategory}}),b.table.page(b.queryParams.page),b.loading=!1}):l.api(t.settings.services.admin+"/category").get(b.queryParams,function(e){b.queryParams.pageCount=e.totalPage,b.listCategory=e.items,b.table=new u({count:10},{counts:[],getData:function(t){return t.total(e.totalItems),b.listCategory}}),b.table.page(b.queryParams.page),b.loading=!1})}function h(e){var t=d.getChild(b.queryParams,e);return t}function f(e){h(e).then(function(r){if(r.totalItems>0){a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(t,r){t.popTitle="Không thể xóa",t.message="Bạn không thể xóa danh mục cha. Vui lòng xóa các danh mục con trước",t.ok=function(){n.go("categories",{parrentId:e}),r.close()},t.cancel=function(){n.go("categories",{parrentId:null}),r.close()}}]})}else{var i={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,r){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/category/:id",{id:"@id"})["delete"]({id:i.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa danh mục thành công!"}}),n.reload(),r.close()})}}]})}})["catch"](function(e){o.toastr({type:"error",data:{title:"Có lỗi xảy ra trong khi xóa",message:e.data.message}})})}function v(e){n.go(".",{keyword:e,page:b.queryParams.page},{notify:!1}).then(function(){n.reload()})}function y(){n.go(".",{keyword:null,page:b.queryParams.page},{notify:!1}).then(function(){n.reload()})}var b=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["view"])||n.go("error403"),b.query={parrentId:null},b.viewChild=!1,b.loading=!0,b.selectedItems=[],b.queryParams=r,b.userRoles=i,b.listCategory=[],b.keyword=r.keyword,b.imagesDerectory=settingJs.configs.uploadDirectory.category,b.listCategoriesParrent=[],b.categoriesParrent=null,b.search=v,b.filterReset=y,b.remove=f,""!==r.parrentSlug?(b.viewChild=!0,m(r.parrentSlug)):g(),c.onPagesChanged(function(){e.vmListCategory.queryParams.page=b.table.page(),n.go(".",e.vmListCategory.queryParams)},e,b.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc"],angular.module("bzCategory").controller("categoryListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m){function g(e){$.formData.slug=m.textToSlug(e)}function h(e){var t=d.getChild({},e);t.then(function(e){$.listChildCategory=e.items})["catch"](function(e){})}function f(e){$.formData.images.splice(e,1)}function v(n){if($.formData.images.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&$.formData.images.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"category_image",prefix:"category_image"}}).then(function(t){$.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function y(){d.get(r.slug).then(function(e){$.formData=e.category,$.id=e.category._id,$.listProduct=e.productList,$.tmpProduct=$.formData.products.map(function(e){return e._id}),h($.id),vmListCategory.loading=!0})["catch"](function(e){o.toastr({type:"error",data:{title:"Danh mục",message:e.data.message}})})}function b(e){return d.get(e)}function P(e){$.submitted=!0,$.lockForm=!0,e?$.formData.slug!=r.slug?b($.formData.slug).then(function(e){e.status?o.toastr({type:"error",data:{title:"Không thể cập nhật",message:"Bạn đã nhập slug đang được sử dụng bởi danh mục khác!"}}):T()})["catch"](function(e){o.toastr({type:"error",data:{title:"Không thể cập nhật",message:e.data.message}})}):T():$.submitted=!0}function T(){""==$.formData.parrent_id&&($.formData.parrent_id=null),$.formData.products_new=$.tmpProduct,d.update($.formData,$.id).then(function(e){o.toastr({type:"success",data:{title:"Danh mục",message:"Cập nhật danh mục thành công"}}),n.go("categories",{parrentSlug:$.parrentCate.slug})})["catch"](function(e){o.toastr({type:"error",data:{title:"Danh mục",message:e.data.message}})})}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["edit"])||n.go("error403"),$.lockFOrm=!1,$.save=P,$.submitted=!1,$.id=null,$.slug=r.slug,$.uploadImage=v,$.removeImage=f,$.generatorSlug=g,$.imagesDirectory=settingJs.configs.uploadDirectory.category,$.listChildCategory=[],$.parrentCate={},y()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc","Upload","bzUtilsSvc"],angular.module("bzCategory").controller("categoryEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),categoryAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m){function g(){d.add().then(function(e){$.categoryList=e.categoryList,$.productsList=e.productsList,$.formData={name:"",slug:"",description:"",images:[],parrent_id:r.parrentId,top:[],status:!0},$.formData.parrent_id&&h()})}function h(){d.getById($.formData.parrent_id).then(function(e){$.parrentCate=e})["catch"](function(e){console.log(e)})}function f(e){$.formData.slug=m.textToSlug(e)}function v(e){return d.get(e)}function y(){""==$.formData.parrent_id&&($.formData.parrent_id=null),$.formData.products=$.tmpProduct,d.create($.formData).then(function(e){o.toastr({type:"success",data:{title:"Danh mục",message:"Thêm danh mục thành công"}}),$.submitted=!1,$.lockForm=!1})["catch"](function(e){o.toastr({type:"error",data:{title:"Danh mục",message:"Tên danh mục đã tồn tại"}})})}function b(e){$.submitted=!0,$.lockForm=!0,e?v($.formData.slug).then(function(e){e.status?o.toastr({type:"error",data:{title:"Không thể thêm",message:"Bạn dã nhập slug đang được sử dụng bởi danh mục khác!"}}):y()})["catch"](function(e){o.toastr({type:"error",data:{title:"Không thể thêm",message:e.data.message}})}):$.submitted=!0}function P(e){$.formData.images.splice(e,1)}function T(n){if($.formData.images.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),
!1;if(n.length>0&&$.formData.images.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"category_image",prefix:"category_image"}}).then(function(t){$.formData.images.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}var $=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("category",["add"])||n.go("error403"),$.lockFOrm=!1,$.save=b,$.submitted=!1,$.uploadImage=T,$.removeImage=P,$.generatorSlug=f,$.parrentCate={},$.imagesDirectory=settingJs.configs.uploadDirectory.category,$.listChildCategory=[[],[],[],[]],$.showChildCategory=[!1,!1,!1,!1],g()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","categorySvc","Upload","bzUtilsSvc"],angular.module("bzCategory").controller("categoryAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.api(t.settings.services.admin+"/blog").get(v.queryParams,function(e){v.queryParams.pageCount=e.totalPage,v.listBlog=e.items,v.table=new u({count:parseInt(v.queryParams.limit)||10},{counts:[],getData:function(t){return t.total(e.totalItems),v.listBlog}}),v.table.page(v.queryParams.page),v.loading=!1})}function m(){d.getTagsBlog().then(function(e){e.success&&(v.listTag=e.data)})}function g(e){n.go(".",{keyword:v.queryParams.keyword,page:v.queryParams.page,tag:v.queryParams.tag},{notify:!1}).then(function(){n.reload()})}function h(){n.go(".",{keyword:null,page:v.queryParams.page,tag:null},{notify:!1}).then(function(){n.reload()})}function f(e){var r={ids:[e]};a.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(e,a){e.popTitle="Xóa",e.message="Bạn chắc chắn sẽ xóa dữ liệu này?",e.ok=function(){l.api(t.settings.services.admin+"/blog/:id",{id:"@id"})["delete"]({id:r.ids},function(e){o.toastr({type:"success",data:{title:"Xóa",message:"Xóa vài viết thành công"}}),n.reload(),a.close()})}}]})}var v=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["view"])||n.go("error403"),v.loading=!0,v.selectedItems=[],v.keyword=r.keyword,v.queryParams=r,v.imagesDirectory=settingJs.configs.uploadDirectory.blog,v.userRoles=i,v.listBlog=[],v.typeBlog=r.type||"GB",v.filter=g,v.filterReset=h,v.remove=f,p(),m(),c.onPagesChanged(function(){e.vmListBlog.queryParams.page=v.table.page(),n.go(".",e.vmListBlog.queryParams)},e,v.table)}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc"],angular.module("bzBlog").controller("blogListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g,h){function f(e){H.formData.slug=m.textToSlug(e)}function v(){d.getTagsBlog().then(function(e){e.success&&(H.listTag=e.data)})}function y(e){return d.get(e)}function b(){l.api(t.settings.services.admin+"/blog").get({limit:100,page:1,parrent_id:"*"},function(e){H.listBlog=e.items},function(e){o.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function P(){var e=r.slug;d.get(e).then(function(e){H.formData=e})["catch"](function(e){o.toastr({type:"error",data:{title:"Không thể tải bài viết",message:e.data}})})}function T(){H.formData.listImgDelete=H.listImgDelete,d.update(H.formData,H.slug).then(function(e){o.toastr({type:"success",data:{title:"Bài viết",message:"Cập nhật viết thành công"}}),"CS"==e.type&&n.go("blogsPolicy"),"GB"==e.type&&n.go("blogsPost"),"MV"==e.type&&n.go("blogsTip"),"TT"==e.type?n.go("blogsNews"):n.go("blogsBanner")})["catch"](function(e){o.toastr({type:"error",data:{title:"Bài viết",message:e.message}})})}function $(e){H.submitted=!0,H.lockForm=!0,e?H.formData.slug!=r.slug?y(H.formData.slug).then(function(e){e.status?o.toastr({type:"error",data:{title:"Không thể cập nhật",message:"Bạn đã nhập slug đang được sử dụng bởi bài viết khác!"}}):T()})["catch"](function(e){o.toastr({type:"error",data:{title:"Không thể cập nhật",message:e.message}})}):T():H.submitted=!0}function C(e,t){H.formData.featured_image.splice(e,1),H.listImgDelete.push({url:H.imagesDirectory,fileName:t})}function w(n){if(H.formData.featured_image.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&H.formData.featured_image.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"blog_image",prefix:"blog_image"}}).then(function(t){H.formData.featured_image.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}})},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function S(e,t){a.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popupScope={image:H.imagesDirectory+t,event:"crop:image",ratio:407/305,width:407,height:305},n.$on("crop:image",function(n,a){h.uploadBase64({directory:"blog_image",image:a.image}).then(function(n){H.listImgDelete.push({url:H.imagesDirectory,fileName:t}),H.formData.featured_image[e].url=n.name,o.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),r.close()})["catch"](function(e){console.log("er",e)})})}]})}function _(){"CS"==H.formData.type&&n.go("blogsPolicy"),"GB"==H.formData.type&&n.go("blogsPost"),"MV"==H.formData.type&&n.go("blogsTip"),"TT"==H.formData.type?n.go("blogsNews"):n.go("blogsBanner")}var H=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["edit"])||n.go("error403"),H.lockFOrm=!1,H.save=$,H.submitted=!1,H.uploadImage=w,H.removeImage=C,H.listImgDelete=[],H.generatorSlug=f,H.imagesDirectory=settingJs.configs.uploadDirectory.blog,H.ckeOpt=g,H.userCurrently=s.getProfile(),H.slug=r.slug,H.cropImage=S,H.cancel=_,b(),v(),P()}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc","Upload","bzUtilsSvc","CKEditorOptBlog","bzUpload"],angular.module("bzBlog").controller("blogEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),blogAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d,p,m,g,h){function f(e){_.formData.slug=m.textToSlug(e)}function v(){d.getTagsBlog(r.type).then(function(e){e.success&&(_.listTag=e.data)})}function y(e){return d.get(e)}function b(){l.api(t.settings.services.admin+"/blog").get({limit:100,page:1,parrent_id:"*"},function(e){_.listBlog=e.items},function(e){o.toastr({type:"error",data:{title:"Lấy danh mục hiện có",message:e}})})}function P(){_.formData.listImgDelete=_.listImgDelete,d.create(_.formData).then(function(e){o.toastr({type:"success",data:{title:"Bài viết",message:"Thêm bài viết thành công"}}),"CS"==e.type&&n.go("blogsPolicy"),"GB"==e.type&&n.go("blogsPost"),"MV"==e.type&&n.go("blogsTip"),"TT"==e.type?n.go("blogsNews"):n.go("blogsBanner")})["catch"](function(e){o.toastr({type:"error",data:{title:"Không thể thêm",message:e.data.message}})})}function T(e){_.submitted=!0,_.lockForm=!0,e?y(_.formData.slug).then(function(e){e.slug==_.formData.slug?o.toastr({type:"error",data:{title:"Không thể thêm",message:"Bạn dã nhập slug đang được sử dụng bởi danh mục khác!"}}):P()})["catch"](function(e){P()}):_.submitted=!0}function $(e,t){_.formData.featured_image.splice(e,1),_.listImgDelete.push({url:_.imagesDirectory,fileName:t})}function C(n){if(_.formData.featured_image.length>=5)return alert("Không thể thêm! Số ảnh tối đa là 5!"),!1;if(n.length>0&&_.formData.featured_image.length<5){if("image/png"!=n[0].type&&"image/jpeg"!=n[0].type&&"image/gif"!=n[0].type)return void alert("Hỉnh ảnh phải có định dạng là jpg, png hoặc gif!");p.upload({url:t.settings.services.uploadApi+"/upload/file",data:{file:n[0],type:"blog_image",prefix:"blog_image"}}).then(function(t){_.formData.featured_image.push({url:t.data.filename}),e.progressPercentage=!1,o.toastr({type:"success",data:{title:"Thành công!",message:"Upload file thành công!"}}),w(_.formData.featured_image.length-1,_.formData.featured_image[_.formData.featured_image.length-1].url)},function(e){o.toastr({type:"error",data:{title:"Lỗi!",message:e.message}})},function(t){e.progressPercentage=parseInt(100*t.loaded/t.total)})}}function w(e,t){a.open({animation:!0,templateUrl:"assets/global/cropper/view.html",controller:["$scope","$uibModalInstance",function(n,r){n.popupScope={image:_.imagesDirectory+t,event:"crop:image",ratio:407/305,width:407,height:305},n.$on("crop:image",function(n,a){h.uploadBase64({directory:"blog_image",image:a.image}).then(function(n){_.listImgDelete.push({url:_.imagesDirectory,fileName:t}),_.formData.featured_image[e].url=n.name,o.toastr({type:"success",data:{title:"Thành công!",message:"Crop ảnh thành công"}}),r.close()})["catch"](function(e){console.log("er",e)})})}]})}function S(){"CS"==r.type&&n.go("blogsPolicy"),"GB"==r.type&&n.go("blogsPost"),"MV"==r.type&&n.go("blogsTip"),"TT"==r.type?n.go("blogsNews"):n.go("blogsBanner")}var _=this;s.isSuperAdmin()||s.isAdmin()&&s.hasPermission("blog",["add"])||n.go("error403"),_.lockFOrm=!1,_.save=T,_.submitted=!1,_.uploadImage=C,_.removeImage=$,_.listImgDelete=[],_.listTag=[],_.generatorSlug=f,_.imagesDirectory=settingJs.configs.uploadDirectory.blog,_.ckeOpt=g,_.userCurrently=s.getProfile(),_.cropImage=w,_.cancel=S,b(),v(),_.formData={name:"",slug:"",type:r.type,meta_title:"",meta_keywords:"",meta_description:"",short_description:"",content:"",auth_id:_.userCurrently.uid,featured_image:[],tags:[],status:!0}}e.$inject=["$scope","$window","$state","$stateParams","$bzPopup","$uibModal","userRoles","authSvc","NgTableParams","ngTableEventsChannel","bzResourceSvc","blogSvc","Upload","bzUtilsSvc","CKEditorOptBlog","bzUpload"],angular.module("bzBlog").controller("blogAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),bannerListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){l.getAll({}).then(function(e){m.data=e.data,m.table=new s({},{counts:[],dataset:m.data}),m.loading=!1})}function p(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="Xóa ",n.message="Bạn muốn xóa banner này?",n.ok=function(){l.del(e).then(function(e){e.success&&t.go(".",m.queryParams).then(function(){t.reload(),o.close(),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa banner thành công!"}})})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa banner thất bại!"}})})}}]})}var m=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("banner",["view"])||t.go("error403"),m.showBtnAdd=c.hasPermission("banner","add"),m.showBtnEdit=c.hasPermission("banner",["add","edit"]),m.showBtnDelete=c.hasPermission("banner","delete"),m.loading=!0,m.urlImg=settingJs.configs.uploadDirectory.banner,m.deleteBanner=p,d()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","bannerSvc"],angular.module("bzBanner").controller("bannerListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),bannerHomeTopCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.getAll({page:"home",position:"top",type:"slide"}).then(function(e){P.banSliderList=e.data,P.banSliderAdd=m("slide","banSliderAdd"),P.loading=!1}),l.getAll({page:"home",position:"top",type:"item"}).then(function(e){P.banProList=e.data,P.banProAdd=m("item","banProAdd"),P.loading=!1})}function m(e,t){var n={show_add:!1,name:t,data:{page:"home",position:"top",type:e,order:1,status:!0,style:"1"}};return n}function g(e){e.$submitted=!1}function h(e){e.show_add=!e.show_add}function f(e,t,n,o){if(e.length>0){if("image/png"!=e[0].type&&"image/jpeg"!=e[0].type)return void r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});d.upload({url:a.settings.services.uploadApi+"/upload/file",data:{file:e[0],type:"banner_image",prefix:"banner_image"}}).then(function(e){t.imgsDel||(t.imgsDel=[]),t.image&&t.imgsDel.push(t.image),t.image=e.data.filename,n.$submitted=!1,o?y(n,t,t._id):r.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh Lỗi!"}})})}}function v(e,t,n,o){return t.data.image?e.$valid?void l.create({data:t.data}).then(function(a){n.push(a.data),P[t.name]=m(o,t.name),e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng upload hình ảnh!"}})}function y(e,t,n){return e.$valid?void l.update({data:t},n).then(function(t){e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function b(e,t,n){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(o,a){o.popTitle="Xóa ",o.message="Bạn muốn xóa banner này?",o.ok=function(){l.del(t).then(function(t){t.success&&(a.close(),n.splice(e,1),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa banner thành công!"}}))})["catch"](function(e){form.$submitted=!1,console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa banner thất bại. Hãy thử lại!"}})})}}]})}var P=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("banner",["add","edit"])||t.go("error403"),P.loading=!0,P.urlImg=settingJs.configs.uploadDirectory.banner,P.imgsDel=[],P.uploadImage=f,P.enableForm=g,P.showAddFrm=h,P.del=b,P.create=v,P.update=y,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","bannerSvc","Upload"],angular.module("bzBanner").controller("bannerHomeTopCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),bannerHomeBottomCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.getAll({page:"home",position:"bottom",type:"item"}).then(function(e){P.banList=e.data,P.banAdd=m("item","banAdd"),P.loading=!1})}function m(e,t){var n={show_add:!1,name:t,data:{page:"home",position:"bottom",type:e,order:1,status:!0,style:"1"}};return n}function g(e){e.$submitted=!1}function h(e){e.show_add=!e.show_add}function f(e,t,n,o){if(e.length>0){if("image/png"!=e[0].type&&"image/jpeg"!=e[0].type)return void r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});d.upload({url:a.settings.services.uploadApi+"/upload/file",data:{file:e[0],type:"banner_image",prefix:"banner_image"}}).then(function(e){t.imgsDel||(t.imgsDel=[]),t.image&&t.imgsDel.push(t.image),t.image=e.data.filename,n.$submitted=!1,o?y(n,t,t._id):r.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh Lỗi!"}})})}}function v(e,t,n,o){return t.data.image?e.$valid?void l.create({data:t.data}).then(function(a){n.push(a.data),P[t.name]=m(o,t.name),e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng upload hình ảnh!"}})}function y(e,t,n){return e.$valid?void l.update({data:t},n).then(function(t){e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}function b(e,t,n){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(o,a){o.popTitle="Xóa ",o.message="Bạn muốn xóa banner này?",o.ok=function(){l.del(t).then(function(t){t.success&&(a.close(),n.splice(e,1),r.toastr({type:"success",data:{title:"Thành công!",message:"Xóa banner thành công!"}}))})["catch"](function(e){form.$submitted=!1,console.log(e),r.toastr({type:"error",data:{title:"Lỗi!",message:"Xóa banner thất bại. Hãy thử lại!"}})})}}]})}var P=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("banner",["add","edit"])||t.go("error403"),P.loading=!0,P.urlImg=settingJs.configs.uploadDirectory.banner,P.uploadImage=f,P.enableForm=g,P.showAddFrm=h,P.del=b,P.create=v,P.update=y,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","bannerSvc","Upload"],angular.module("bzBanner").controller("bannerHomeBottomCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),bannerCategoryTopCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){l.getAll({page:"category",position:"top",type:"item"}).then(function(e){b.listCategory=e.catgegory,b.banner=e.data,b.banList=m("item","banAdd"),b.loading=!1})}function m(e,t){var n=b.listCategory.map(function(n){var r=b.banner.find(function(e){return e.category==n.slug});return{banner:{name:t,data:r?r:{category:n.slug,page:"category",position:"top",type:e,order:1,status:!0,style:"1"}},category:n}});return n}function g(e){e.$submitted=!1}function h(e){e.show_add=!e.show_add}function f(e,t,n,o){if(e.length>0){if("image/png"!=e[0].type&&"image/jpeg"!=e[0].type)return void r.toastr({type:"error",data:{title:"Lỗi!",message:"Hình ảnh phải có định dạng png hoặc jpg!"}});d.upload({url:a.settings.services.uploadApi+"/upload/file",data:{file:e[0],type:"banner_image",prefix:"banner_image"}}).then(function(e){t.imgsDel||(t.imgsDel=[]),t.image&&t.imgsDel.push(t.image),t.image=e.data.filename,n.$submitted=!1,o?y(n,{data:t},t._id):r.toastr({type:"success",data:{title:"Thành công!",message:"Upload ảnh thành công!"}})},function(e){r.toastr({type:"error",data:{title:"Lỗi!",message:"Upload ảnh Lỗi!"}})})}}function v(e,t,n,o){return t.data.image?e.$valid?void l.create({data:t.data}).then(function(n){t.data=n.data,e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Thêm banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Thêm banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng upload hình ảnh!"}})}function y(e,t,n){return e.$valid?void l.update({data:t.data},n).then(function(t){e.$submitted=!1,r.toastr({type:"success",data:{title:"Thành công!",message:"Sửa banner thành công!"}})["catch"](function(t){e.$submitted=!1,console.log(t),r.toastr({type:"error",data:{title:"Lỗi!",message:"Sửa banner thất bại. Hãy thử lại!"}})})}):void r.toastr({type:"error",data:{title:"Lỗi!",message:"Vui lòng điền đầy đủ thông tin!"}})}var b=this;c.isSuperAdmin()||c.isAdmin()&&c.hasPermission("banner",["add","edit"])||t.go("error403"),b.loading=!0,b.urlImg=settingJs.configs.uploadDirectory.banner,b.uploadImage=f,b.enableForm=g,b.showAddFrm=h,b.create=v,b.update=y,p()}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","NgTableParams","ngTableEventsChannel","authSvc","bannerSvc","Upload"],angular.module("bzBanner").controller("bannerCategoryTopCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),permissionListCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l){function d(){u.get().then(function(e){e.success&&(g.data=e.data)})["catch"](function(e){console.log(e)})}function p(e,n){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(o,a){o.popTitle="Xóa",o.message="Bạn muốn xóa quyền "+e+" trên "+n+"?",o.ok=function(){u.removeResource(e,n).then(function(o){r.toastr({type:"success",data:{title:"Permission",message:"Deleted "+n+"'s "+e+"!"}}),t.reload(),a.close()})["catch"](function(e){r.toastr({type:"success",data:{title:"Permission",message:e.message}})})}}]})}function m(e){o.open({animation:!0,templateUrl:"assets/global/message/view.html",controller:["$scope","$uibModalInstance",function(n,o){n.popTitle="Xóa",n.message="Bạn muốn xóa "+e+"?",n.ok=function(){u.removeRole(e).then(function(n){r.toastr({type:"success",data:{title:"Permission",message:"Deleted "+e+"!"}}),t.reload(),o.close()})["catch"](function(e){r.toastr({type:"success",data:{title:"Permission",message:e.message}})})}}]})}var g=this;s.isSuperAdmin()||t.go("error403"),d(),g.listAction=c,g.listResource=l,g.getData=d,g.data=[],g.removeRole=m,g.removeResource=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource"],angular.module("bzPermission").controller("permissionListCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),permissionEditCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){u.getResoureRole(n.role).then(function(e){"add-resource"==f.modEdit?e.data.forEach(function(e,t){l.indexOf(e.resource)!=-1&&l.splice(l.indexOf(e.resource),1)}):(f.formData.resource=[f.resource],e.data.forEach(function(e,t){e.resource==f.resource&&(f.formData.permission=e.permissions)}),f.formData.permission.indexOf("*")!=-1&&(f.fullPermission=!0)),f.listPermission=c,f.listResource=l})["catch"](function(e){})}function m(){f.fullPermission&&(f.formData.permission=Array.of("*"))}function g(){f.formData.role=d.textToSlug(f.formData.role)}function h(e){f.submitted=!0,f.lockForm=!0,e?(f.formData.permission.indexOf("*")!==-1&&(f.formData.permission="*"),"add-resource"==f.modEdit&&u.addResource(f.formData,f.formData.role).then(function(e){r.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){r.toastr({type:"error",data:{title:"Phân quyền",message:e.data.message}})}),"edit-permission"==f.modEdit&&u.update(f.formData,f.formData.role,f.formData.resource).then(function(e){r.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){r.toastr({type:"error",data:{title:"Phân quyền",message:e.data.message}})})):f.submitted=!0}var f=this;s.isSuperAdmin()||t.go("error403"),f.type=n.type,f.resource=n.resource,f.modEdit=n.mod,f.formData={role:n.role,resource:[]},f.save=h,f.checkName=g,f.onChangePermission=m,f.getResource=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource","bzUtilsSvc"],angular.module("bzPermission").controller("permissionEditCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}(),permissionAddCtrl=function(){function e(e,t,n,r,o,a,i,s,u,c,l,d){function p(){f.fullPermission&&(f.formData.permission=Array.of("*"))}function m(){f.formData.role=d.textToSlug(f.formData.role)}function g(e,t){var n=!1;u.get().then(function(r){r.success&&r.data.forEach(function(t,r){t.role==e&&(n=!0)}),t(n)})["catch"](function(e){t(n)})}function h(e){f.submitted=!0,f.lockForm=!0,e?(f.formData.permission.indexOf("*")!==-1&&(f.formData.permission=["*"]),g(f.formData.role,function(e){e?r.toastr({type:"error",data:{title:"Phân quyền",message:"Tên quyền đã tồn tại!"}}):u.create(f.formData).then(function(e){r.toastr({type:"success",data:{title:"Phân quyền",message:e.message}}),t.go("permission")})["catch"](function(e){r.toastr({type:"error",data:{title:"Phân quyền",message:e.message}})})})):f.submitted=!0}var f=this;s.isSuperAdmin()||t.go("error403"),f.formData={role:"",resource:[],permission:[]},f.fullPermission=!1,f.listPermission=c,f.listResource=l,f.save=h,f.checkName=m,f.onChangePermission=p}e.$inject=["$scope","$state","$stateParams","$bzPopup","$uibModal","$window","bzResourceSvc","authSvc","permissionSvc","listAction","listResource","bzUtilsSvc"],angular.module("bzPermission").controller("permissionAddCtrl",e);var t={preload:["bzPreloadSvc",function(e){return e.load([])}]};return{resolve:t}}();!function(){function e(e,t,n,r,o,a){function i(){l.lockForm=!1,l.submitted=!1,l.formData={phone:"",password:""}}function s(e){l.submitted=!0,!l.lockForm&&e&&(l.lockForm=!0,t.pageMethods.authSvc.siteLogin(l.formData,function(e){r.location.href=settingJs.configs.adminUrl,l.lockForm=!1},function(e){o.toastr({type:"error",data:{title:"Login",message:e.data.message}}),l.lockForm=!1}))}function u(){a.getFacebook().then(function(e){e.error?(o.toastr({type:"error",data:{title:"Login",message:""+e.error}}),l.lockForm=!1):(c("facebook",e),l.lockForm=!0,t.pageMethods.authSvc.facebookLogin(e,function(e){r.location.href="/",l.lockForm=!1},function(e){o.toastr({type:"error",data:{title:"Login",message:e.data.message}}),l.lockForm=!1}))})}function c(e,n){t.social={type:e,id:n.id,name:n.name,email:n.email,profile_picture:n.picture+"?sz=200"},"facebook"==e&&(t.social.profile_picture="https://graph.facebook.com/v2.5/"+n.id+"/picture?width=200&height=200")}var l=this;l.siteLogin=s,l.loginFacebook=u,i()}e.$inject=["$rootScope","$scope","$state","$window","$bzPopup","authSvc"],angular.module("bzAuth").controller("authCtrl",e)}(),function(){Application.registerRouter({state:"user-shipping",config:{url:"/user-shipping/{id}",data:{title:"UserShipping",menuType:"user-shipping"},templateUrl:"modules/admin-user/view/client/user-shipping/view.html",controller:"userShippingCtrl",controllerAs:"vmUserShipping",resolve:userShippingCtrl.resolve}})}(),function(){Application.registerRouter({state:"users",config:{url:"/users?page&limit&sort&role&id&keyword&status&deletedAt",data:{title:"Users",menuType:"user"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-user/view/client/list-user/view.html",controller:"usersCtrl",controllerAs:"vmUsers",resolve:usersCtrl.resolve}}),Application.registerRouter({state:"usersDeleted",config:{url:"/users-deleted?page&limit&sort&role&id&keyword&status&deletedAt",data:{title:"Users deleted",menuType:"user-deleted"},params:{page:"1",sort:"-createdAt",limit:"10",deletedAt:"true"},templateUrl:"modules/admin-user/view/client/list-user/view.html",controller:"usersCtrl",controllerAs:"vmUsers",resolve:usersCtrl.resolve}})}(),function(){Application.registerRouter({state:"user-edit",config:{url:"/user-edit?module&page&filter&limit&cateid&sortfield&sortdir&publish&id&keyword",data:{title:"Bài viết",menuType:"user"},params:{page:"1",sortfield:"createdAt",sortdir:"desc",limit:"10"},templateUrl:"modules/admin-user/view/client/edit/view.html",controller:"userEditCtrl",controllerAs:"userEdit",resolve:userEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"units",config:{url:"/units?page&limit&sort&role&id&keyword",data:{title:"Unit",menuType:"unit"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-unit/view/client/list-unit/view.html",controller:"unitsCtrl",controllerAs:"vmUnits"}})}(),function(){Application.registerRouter({state:"editUnit",config:{url:"/units/edit/{id}",data:{title:"Edit Unit",menuType:"unit"},params:{},templateUrl:"modules/admin-unit/view/client/edit-unit/view.html",controller:"unitEditCtrl",controllerAs:"vmEditUnits"}})}(),function(){Application.registerRouter({state:"createUnit",config:{url:"/units/add",data:{title:"Create new Unit",menuType:"unit"},params:{},templateUrl:"modules/admin-unit/view/client/add-unit/view.html",controller:"unitAddCtrl",controllerAs:"vmAddUnits"}})}(),function(){Application.registerRouter({state:"test-resize-img",config:{url:"/test/resize-img",data:{title:"test resize",menuType:"test-resize"},templateUrl:"modules/admin-test/view/client/test-resize/view.html",controller:"testResizeCtrl",controllerAs:"vmTestResize",resolve:testResizeCtrl.resolve}})}(),function(){Application.registerRouter({state:"suppliers",config:{url:"/suppliers?page&limit&sort&role&id&keyword",data:{title:"Suppliers",menuType:"supplier"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-supplier/view/client/list-supplier/view-list.html",controller:"supplierListCtrl",controllerAs:"vmListSupplier",resolve:supplierListCtrl.resolve}})}(),function(){Application.registerRouter({state:"importProductHistory",config:{url:"/suppliers/history-import-product/{id}?page&limit",data:{title:"Import Product History",menuType:"supplier"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-supplier/view/client/import-product-history/view.html",controller:"supplierImportProductHistoryCtrl",controllerAs:"vmSupplierImportProductHistory"}})}(),function(){Application.registerRouter({state:"editSupplier",config:{url:"/suppliers/edit/{id}",data:{title:"Update info Supplier",menuType:"supplier"},params:{},templateUrl:"modules/admin-supplier/view/client/edit-supplier/view-edit.html",controller:"supplierEditCtrl",controllerAs:"vmsupplierEdit"}})}(),function(){Application.registerRouter({state:"createSupplier",config:{url:"/suppliers/add",data:{title:"Create new Supplier",menuType:"supplier"},params:{},templateUrl:"modules/admin-supplier/view/client/add-supplier/view-add.html",controller:"supplierAddCtrl",controllerAs:"vmsupplierAdd"}})}(),function(){Application.registerRouter({state:"tag-product",config:{url:"/tag-product?type&tag&expire",data:{title:"Tag",menuType:"tag-product"},params:{type:"SP"},templateUrl:"modules/admin-tag/view/client/tag-product/view.html",controller:"tagProductCtrl",controllerAs:"vmTagProduct"}})}(),function(){Application.registerRouter({state:"tag-processing",config:{url:"/tag-processing?type",data:{title:"Tag",menuType:"tag-processing"},params:{type:"CN"},templateUrl:"modules/admin-tag/view/client/tag-processing/view.html",controller:"tagProcesssingCtrl",controllerAs:"vmTagProcessing"}})}(),function(){Application.registerRouter({state:"tag-list",config:{url:"/tag-list?page&limit&sort&role&id&keyword&type",data:{title:"Tag",menuType:"tag"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-tag/view/client/list-tag/view.html",controller:"tagCtrl",controllerAs:"vmTags"}})}(),function(){Application.registerRouter({state:"tag-edit",config:{url:"/tag-edit/{id}",data:{title:"Tag",menuType:"tag"},templateUrl:"modules/admin-tag/view/client/edit-tag/view.html",controller:"tagEditCtrl",controllerAs:"vmEditTags"}})}(),function(){Application.registerRouter({state:"tag-create",config:{url:"/tag-create",data:{title:"Tag",menuType:"tag"
},templateUrl:"modules/admin-tag/view/client/create-tag/view.html",controller:"tagAddCtrl",controllerAs:"vmAddTags"}})}(),function(){Application.registerRouter({state:"shippingfee-list",config:{url:"/shippingfee-list?page&limit&sort&role&id&keyword",data:{title:"ShippingFee",menuType:"shippingfee"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-shippingfee/view/client/list-shippingfee/view.html",controller:"shippingfeeCtrl",controllerAs:"vmShippingFees"}})}(),function(){Application.registerRouter({state:"shippingfee-edit",config:{url:"/shippingfee-edit/{id}",data:{title:"ShippingFee",menuType:"shippingfee"},templateUrl:"modules/admin-shippingfee/view/client/edit-shippingfee/view.html",controller:"shippingfeeEditCtrl",controllerAs:"vmEditShippingFees"}})}(),function(){Application.registerRouter({state:"shippingfee-create",config:{url:"/shippingfee-create",data:{title:"ShippingFee",menuType:"shippingfee"},templateUrl:"modules/admin-shippingfee/view/client/create-shippingfee/view.html",controller:"shippingfeeAddCtrl",controllerAs:"vmAddShippingFees"}})}(),function(){Application.registerRouter({state:"search-list",config:{url:"/search?page&limit",data:{title:"Search",menuType:"search"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-search/view/client/list-search/view.html",controller:"searchListCtrl",controllerAs:"vmSeL",resolve:searchListCtrl.resolve}})}(),function(){Application.registerRouter({state:"search-edit",config:{url:"/search-edit/{id}",data:{title:"Search",menuType:"search"},templateUrl:"modules/admin-search/view/client/edit-search/view.html",controller:"searchEditCtrl",controllerAs:"vmSeE",resolve:searchEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"search-add",config:{url:"/search-add",data:{title:"Search",menuType:"search"},templateUrl:"modules/admin-search/view/client/add-search/view.html",controller:"searchAddCtrl",controllerAs:"vmSeA",resolve:searchAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"report-product-order",config:{url:"/report-product-order?page&limit&name&status&active&category&tag&dueDate&date&qty_in_stock&total_order",data:{title:"Report Product Order",menuType:"report-product-order"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-report/view/client/list-report-product-order/view.html",controller:"reportProductOrderCtrl",controllerAs:"vmRPO",resolve:reportProductOrderCtrl.resolve}})}(),function(){Application.registerRouter({state:"report-product-a-day",config:{url:"/report-product-a-day?page&limit&name&status&active&category&tag&dueDate",data:{title:"Report Product A Day",menuType:"report-product-a-day"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-report/view/client/list-report-product-a-day/view.html",controller:"reportProductADayCtrl",controllerAs:"vmRPA",resolve:reportProductADayCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-list",config:{url:"/promotion?page&limit",data:{title:"Promotion",menuType:"promotion"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-promotion/view/client/list-promotion/view.html",controller:"promotionListCtrl",controllerAs:"vmPoL",resolve:promotionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-edit",config:{url:"/promotion-edit/{id}",data:{title:"promotion",menuType:"promotion"},templateUrl:"modules/admin-promotion/view/client/edit-promotion/view.html",controller:"promotionEditCtrl",controllerAs:"vmPoE",resolve:promotionEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"promotion-add",config:{url:"/promotion-add",data:{title:"promotion",menuType:"promotion"},templateUrl:"modules/admin-promotion/view/client/add-promotion/view.html",controller:"promotionAddCtrl",controllerAs:"vmPoA",resolve:promotionAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"product",config:{url:"/product?page&limit&name&status&active&category&tag&dueDate",data:{title:"Product",menuType:"product"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-product/view/client/list-product/view.html",controller:"productListCtrl",controllerAs:"vmPrL",resolve:productListCtrl.resolve}})}(),function(){Application.registerRouter({state:"product-edit",config:{url:"/product-edit/{id}",data:{title:"Product",menuType:"product"},templateUrl:"modules/admin-product/view/client/edit-product/view.html",controller:"productEditCtrl",controllerAs:"vmPrE",resolve:productEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"product-add",config:{url:"/product-add",data:{title:"Product",menuType:"product"},templateUrl:"modules/admin-product/view/client/add-product/view.html",controller:"productAddCtrl",controllerAs:"vmPrA",resolve:productAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-report",config:{url:"/order-report?page&limit&customer_name&coupon&date&status&type&user&user_id&min_order&max_order",data:{title:"Report order",menuType:"order-report"},params:{page:"1",limit:"50"},templateUrl:"modules/admin-order/view/client/report-order/view.html",controller:"orderReportCtrl",controllerAs:"vmOrR",resolve:orderReportCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-list",config:{url:"/order?page&limit&customer_name&coupon&date&status&type&user&user_id&min_order&max_order&export&coupon_order",data:{title:"Order list",menuType:"order"},params:{page:"1",limit:"50"},templateUrl:"modules/admin-order/view/client/list-order/view.html",controller:"orderListCtrl",controllerAs:"vmOrL",resolve:orderListCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-edit",config:{url:"/order/{id}",data:{title:"Order edit",menuType:"order"},templateUrl:"modules/admin-order/view/client/edit-order/view.html",controller:"orderEditCtrl",controllerAs:"vmOrE",resolve:orderEditCtrl.resolve}})}(),function(){Application.registerRouter({state:"order-add",config:{url:"/order-add",data:{title:"Order add",menuType:"order"},params:{page:"1",limit:"10"},templateUrl:"modules/admin-order/view/client/add-order/view.html",controller:"orderAddCtrl",controllerAs:"vmOrA",resolve:orderAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"logs",config:{url:"/log?page&limit&action&label&actor&date",data:{title:"System log",menuType:"log"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-log/view/client/list/log-list.html",controller:"auditLogCtrl",controllerAs:"vmLog",resolve:auditLogCtrl.resolve}})}(),function(){Application.registerRouter({state:"import-product",config:{url:"/import-product?page&limit&slug&product&date",data:{title:"Import Product",menuType:"import-product"},params:{page:"1",limit:"20"},templateUrl:"modules/admin-import-product/view/client/list-import-product/view.html",controller:"importProductListCtrl",controllerAs:"vmIPr",resolve:importProductListCtrl.resolve}})}(),function(){Application.registerRouter({state:"import-product-add",config:{url:"/import-product-add",data:{title:"Import Product",menuType:"import-product"},templateUrl:"modules/admin-import-product/view/client/add-import-product/view.html",controller:"importProductCtrl",controllerAs:"vmIPr",resolve:importProductCtrl.resolve}})}(),function(){Application.registerRouter({state:"coupon-list",config:{url:"/coupon-list?page&limit&sort&role&id&keyword",data:{title:"Coupon",menuType:"coupon"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-coupon/view/client/list-coupon/view.html",controller:"couponCtrl",controllerAs:"vmCoupons"}})}(),function(){Application.registerRouter({state:"coupon-group",config:{url:"/coupon-group?page&limit&sort&role&id&keyword",data:{title:"Coupon",menuType:"coupon-group"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-coupon/view/client/group-list-coupon/view.html",controller:"couponGroupCtrl",controllerAs:"vmCPG"}})}(),function(){Application.registerRouter({state:"coupon-edit",config:{url:"/coupon-edit/{id}",data:{title:"Coupon",menuType:"coupon"},templateUrl:"modules/admin-coupon/view/client/edit-coupon/view.html",controller:"couponEditCtrl",controllerAs:"vmEditCoupons"}})}(),function(){Application.registerRouter({state:"coupon-create",config:{url:"/coupon-create?type",data:{title:"Coupon",menuType:"coupon"},templateUrl:"modules/admin-coupon/view/client/create-coupon/view.html",controller:"couponAddCtrl",controllerAs:"vmAddCoupons"}})}(),function(){Application.registerRouter({state:"configs",config:{url:"/configs?page&limit&sort&role&id&keyword",data:{title:"Configs",menuType:"config"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-config/view/client/list/view.html",controller:"configListCtrl",controllerAs:"vmListConfig",resolve:configListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editConfig",config:{url:"/config/edit/{id}",data:{title:"Edit Config",menuType:"config"},params:{},templateUrl:"modules/admin-config/view/client/edit/view.html",controller:"configEditCtrl",controllerAs:"vmEditConfig"}})}(),function(){Application.registerRouter({state:"createConfig",config:{url:"/configs/add",data:{title:"Create new Config",menuType:"config"},params:{},templateUrl:"modules/admin-config/view/client/add/view.html",controller:"configAddCtrl",controllerAs:"vmAddConfigs"}})}(),function(){Application.registerRouter({state:"certificate-list",config:{url:"/certificate-list?page&limit&sort&role&id&keyword",data:{title:"Certificate",menuType:"certificate"},params:{page:"1",sort:"-createdAt",limit:"20"},templateUrl:"modules/admin-certificate/view/client/list-certificate/view.html",controller:"certificateCtrl",controllerAs:"vmCertificates"}})}(),function(){Application.registerRouter({state:"certificate-edit",config:{url:"/certificate-edit/{id}",data:{title:"Certificate",menuType:"certificate"},templateUrl:"modules/admin-certificate/view/client/edit-certificate/view.html",controller:"certificateEditCtrl",controllerAs:"vmEditCertificates"}})}(),function(){Application.registerRouter({state:"certificate-create",config:{url:"/certificate-create",data:{title:"Certificate",menuType:"certificate"},templateUrl:"modules/admin-certificate/view/client/create-certificate/view.html",controller:"certificateAddCtrl",controllerAs:"vmAddCertificates"}})}(),function(){Application.registerRouter({state:"certificate-product",config:{url:"/certificate-product/{id}?page&limit&sort&role&keyword",data:{title:"Certificate",menuType:"certificate"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-certificate/view/client/certificate-product/view.html",controller:"certificateProductCtrl",controllerAs:"vmCertificateProduct"}})}(),function(){Application.registerRouter({state:"categories",config:{url:"/categories/{parrentSlug}?page&limit&sort&role&id&keyword",data:{title:"Categories",menuType:"category"},params:{page:"1",sort:"-createdAt",limit:"10"},templateUrl:"modules/admin-category/view/client/list-category/view-list.html",controller:"categoryListCtrl",controllerAs:"vmListCategory"}})}(),function(){Application.registerRouter({state:"editCategory",config:{url:"/category/edit/{slug}",data:{title:"Edit new Category",menuType:"category"},params:{},templateUrl:"modules/admin-category/view/client/edit-category/view-edit.html",controller:"categoryEditCtrl",controllerAs:"vmcategoryEdit"}})}(),function(){Application.registerRouter({state:"createCategory",config:{url:"/category/add/{parrentId}",data:{title:"Create new Category",menuType:"category"},params:{},templateUrl:"modules/admin-category/view/client/add-category/view-add.html",controller:"categoryAddCtrl",controllerAs:"vmcategoryAdd",resolve:categoryAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"blogsPost",config:{url:"/blog-post?page&limit&sort&role&id&keyword&type&tag",data:{title:"Blogs Post",menuType:"blog-post"},params:{page:"1",sort:"-createdAt",limit:"10",type:"GB"},templateUrl:"modules/admin-blog/view/client/list/view-post.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsPolicy",config:{url:"/blogs-policy?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Policy",menuType:"blog-policy"},params:{page:"1",sort:"-createdAt",limit:"10",type:"CS"},templateUrl:"modules/admin-blog/view/client/list/view-policy.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsBanner",config:{url:"/blogs-banner?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Banner",menuType:"blog-banner"},params:{page:"1",sort:"-createdAt",limit:"10",type:"BN"},templateUrl:"modules/admin-blog/view/client/list/view-banner.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsTip",config:{url:"/blogs-tip?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Tips",menuType:"blog-tip"},params:{page:"1",sort:"-createdAt",limit:"10",type:"MV"},templateUrl:"modules/admin-blog/view/client/list/view-tip.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}}),Application.registerRouter({state:"blogsNews",config:{url:"/blogs-new?page&limit&sort&role&id&keyword&type",data:{title:"Blogs Tips",menuType:"blog-tip"},params:{page:"1",sort:"-createdAt",limit:"10",type:"TT"},templateUrl:"modules/admin-blog/view/client/list/view-news.html",controller:"blogListCtrl",controllerAs:"vmListBlog",resolve:blogListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editPost",config:{url:"/blog/edit/{slug}",data:{title:"Edit Post",menuType:"blog-post"},params:{},templateUrl:"modules/admin-blog/view/client/edit/view.html",controller:"blogEditCtrl",controllerAs:"vmEditBlog"}})}(),function(){Application.registerRouter({state:"createPost",config:{url:"/blog/add?type",data:{title:"Create new Post",menuType:"blog-post"},params:{type:"GB"},templateUrl:"modules/admin-blog/view/client/add/view.html",controller:"blogAddCtrl",controllerAs:"vmBlogAdd"}})}(),function(){Application.registerRouter({state:"banner-list",config:{url:"/banner",data:{title:"banner",menuType:"banner"},params:{},templateUrl:"modules/admin-banner/view/client/list-banner/view.html",controller:"bannerListCtrl",controllerAs:"vmBaL",resolve:bannerListCtrl.resolve}})}(),function(){Application.registerRouter({state:"banner-home-top",config:{url:"/banner-home-top",data:{title:"banner",menuType:"banner"},params:{},templateUrl:"modules/admin-banner/view/client/home-top-banner/view.html",controller:"bannerHomeTopCtrl",controllerAs:"vmBaHT",resolve:bannerHomeTopCtrl.resolve}})}(),function(){Application.registerRouter({state:"banner-home-bottom",config:{url:"/banner-home-bottom",data:{title:"banner",menuType:"banner"},params:{},templateUrl:"modules/admin-banner/view/client/home-bottom-banner/view.html",controller:"bannerHomeBottomCtrl",controllerAs:"vmBaHB",resolve:bannerHomeBottomCtrl.resolve}})}(),function(){Application.registerRouter({state:"banner-category-top",config:{url:"/banner-category-top",data:{title:"banner",menuType:"banner"},params:{},templateUrl:"modules/admin-banner/view/client/category-top-banner/view.html",controller:"bannerCategoryTopCtrl",controllerAs:"vmBaCT",resolve:bannerCategoryTopCtrl.resolve}})}(),function(){Application.registerRouter({state:"permission",config:{url:"/permission",data:{title:"Permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/list/view.html",controller:"permissionListCtrl",controllerAs:"vmPermission",resolve:permissionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"editPermission",config:{url:"/permission/edit/{mod}/{role}/{resource}",data:{title:"Edit Permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/edit/view.html",controller:"permissionEditCtrl",controllerAs:"vmEditPermission",resolve:permissionListCtrl.resolve}})}(),function(){Application.registerRouter({state:"add-permission",config:{url:"/permission/add",data:{title:"Add permission",menuType:"permission"},params:{},templateUrl:"modules/admin-acl/view/client/add/view.html",controller:"permissionAddCtrl",controllerAs:"vmAddPermission",resolve:permissionAddCtrl.resolve}})}(),function(){Application.registerRouter({state:"dashboard",config:{url:"/",data:{title:"Dashboard",menuType:"dashboard"},params:{},templateUrl:"modules/admin-dashboard/view/client/view.html",controller:"dashboardCtrl",controllerAs:"vmDashboard",resolve:dashboardCtrl.resolve}})}(),function(){Application.registerRouter({state:"error404",config:{url:"/error404",data:{title:"Error 404",menuType:"error404"},templateUrl:"modules/admin-core/view/client/error/404.html"}}),Application.registerRouter({state:"error403",config:{url:"/error403",data:{title:"Error 403",menuType:"error403"},templateUrl:"modules/admin-core/view/client/error/403.html"}})}();